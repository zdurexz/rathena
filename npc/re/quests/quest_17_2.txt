//===== rAthena Script =======================================
//= Sage's Legacy
//===== Description: =========================================
//= [Walkthrough Conversion via Replay Parser of Divine-Pride]
//= Quest NPCs Episode 17.2
//===== Changelogs: ==========================================
//= 1.0 First version. [JohnnyPlayy]
//= 1.1 Continuation of Quest [Kianzack]
//= 1.2 Addition of Side Quests [Kianzack]
//= 1.3 Change disable/hideonnpc to classchange self
//= 1.4 Changed to cloakon/cloakoffnpc to follow 16.2
//===== Note: ================================================
//= - Missing some static NPC (No dialog & Not in Aegis Parser)
//============================================================

//Mansion Entrance
sp_cor,255,285,1	script	Rookie#sp_cor_tunnel	4_M_ROOKIE,{
	switch(ep_illusion){
		case 46:
			cutin "16loo_03",2;
			mes "[Rookie]";
			mes "Ah... so it's true. Well I guess this is it... it doesn't seem to easy to get through. Why go that way?";
			cloakoffnpc "Elyumina#sp_cor_tunnel", getcharid(0);
			cloakoffnpc "Gonie#sp_cor_tunnel", getcharid(0);
			cloakoffnpc "Elena Bolkova#sp_cor_tunnel", getcharid(0);
			next;
			cutin "16go_01",0;
			mes "[Gonie]";
			mes ".....";
			next;
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "Oh, you will go? Thank you, Gonie.";
			next;
			cutin "16go_01",0;
			mes "[Gonie]";
			mes ".....";
			sleep2 1000;
			mes "........";
			sleep2 1000;
			mes "...........";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Huh, Gonie. Is that true? Oh right, well that's funny...";
			next;
			cutin "ep171_elyumina03",0;
			mes "[Elyumina]";
			mes "What's that look? I told the truth!";
			mes "There's a doorway!";
			mes "I wouldn't lie in such a situation.";
			mes "I'd be stupid to lie, don't you think?";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Who said anything about that? I found the entrance.";
			mes "But it was sealed from the inside, so we can't even open it with Gonie's strength.";
			next;
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "I had to make sure you were telling the truth, but I guess I didn't have to.";
			mes "You're a better person than you think. You're not a fool.";
			npctalk "Elyumina : Why are you making fun of me! Aaah!","Elyumina#sp_cor_tunnel",bc_self;
			next;
			cutin "16loo_03",2;
			mes "[Rookie]";
			mes "The government and the Enterprise are cooperating now. We'll do everything we can to reclaim Varmundt's Mansion.";
			next;
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "As I told you, the entrance is blocked right now.";
			mes "If I get more information, I'll let you know. For know, please rest.";
			next;
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "Oh, right. Elyumina will be detained here for the time being.";
			mes "For now, she's the one who knows the most about Illusion, so I can't turn her outside.";
			next;
			mes "[Elena Bolkova]";
			mes "We will keep monitoring the area and see if we can repair the damaged weapons.";
			next;
			mes "[Elena Bolkova]";
			mes "If you're interested, please go see my <NAVI>[subordinates]<INFO>sp_cor,113,130,0,101,0</INFO></NAVI> in charge of it.";
			mes "They're very smart.";
			next;
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "There are many things to do around here, so if you have free time, you can help out.";
			mes "Goodluck, adventurer!! I'll contact you if I have new information.";
			ep_illusion = 47;
			completequest 16360;
			close2;
			cutin "",255;
			cloakonnpc "Elyumina#sp_cor_tunnel", getcharid(0);
			cloakonnpc "Gonie#sp_cor_tunnel", getcharid(0);
			cloakonnpc "Elena Bolkova#sp_cor_tunnel", getcharid(0);
			end;
		
		case 47:
			if(BaseLevel < 130){
				cutin "16loo_02",2;
				mes "[Lucky]";
				mes "If I get more information, I'll let you know. For now, please rest. Elyumina will be detained here for the time being.";
				close3;
			}
			break;
			
		default:
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Oh, hey adventurer. This is still under investigation.";
			mes "Don't come too close, we don't know if it's dangerous or not yet.";
			next;
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "The water flowing trough this channel looks clean, but I would like to take samples and ask for analysis.";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "There are so many suspicious things around... I keep reminding myself every minute that I have to look out even for things that looks normal.";
			close3;
	}
	switch(ep17_2_main){
		case 0:
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "You're welcome.";
			mes "I opened the entrance here last night.";
			mes "Elyumina said that somehow the device that was sealing it from the inside is broken.";
			next;
			mes "[Rookie]";
			mes "It must have been one of the devices of the Illusion and Heart Hunters to keep the entrance shut.";
			mes "I'm glad that we're able to open it and move inside.";
			next;
			mes "[Rookie]";
			mes "Some of the rebellions have already entered the mansion.";
			mes "Maybe the Illusions intended to open it... because the inside is full of experiments...";
			next;
			mes "[Rookie]";
			mes "but I'm sure the rebellions who entered the mansion, is fine.";
			mes "You can enter whenever you're ready, adventurer.";
			next;
			mes "[Rookie]";
			mes "Even though I opened it, I don't plan to leave the door open at all times.";
			mes "I was only waiting for you to come.";
			next;
			mes "[Rookie]";
			mes "... Hmm, for some reason, I feel like I'm always playing the role of a gatekeeper?";
			mes "Is it only for adventurers? You must be feeling bad, huh? Ha-ha-ha-ha";
			ep17_2_main = 1;
			setquest 18000;
			next;
			mes "[Rookie]";
			mes "I'll open the door anytime you need to need, adventurer. Just let me know.";
			close3;
			
		case 1:
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Shall we go?";
			mes "To the great mansion left by the great sages?";
			next;
			if(select("Let's Go!:Not now.") == 2){
				mes "[Rookie]";	
				mes "Let me know whenever you are ready.";
				close3;
			}
			mes "[Rookie]";
			mes "I heard that the advance team already cleaned up the inside, but occasionally something is coming out this way... it's hard for me to see something sticking out this way from time to time.";
			mes "First, I'll tell you where to go.";
			next;
			mes "[Rookie]";
			mes "The gate you're about to enter... we're calling it the entrance, but it's actually the exit.";
			mes "It's a gaint sewer. If you walk along the sewer, you'll find a huge sewage treatment plant inside.";
			next;
			mes "[Rookie]";
			mes "If you go past the sewage treatment plant, there is a one huge magic power plant inside.";
			mes "It seems that power plant supports the entire mansion.";
			next;
			mes "[Rookie]";
			mes "Through the power plant, you can get to the garden of mansion.";
			mes "The mansion's manager is staying near the garden. be sure to meet them first.";
			next;
			select("Manager?");
			mes "[Rookie]";
			mes "If you look around closely, you'll understand.";
			mes "They seem to be having a hard time because of the intruders.";
			next;
			mes "[Rookie]";
			mes "Many other volunteer adventurer have entered before us.";
			mes "The sewage plant is quite complicated and you could get lost.";
			next;
			mes "[Rookie]";
			mes "There might be a colleague that ^0000FFfell behind^000000, Please move together with them.";
			mes "Before you register as a guest in the mansion, prioritize everyone's safety first.";
			next;
			mes "[Rookie]";
			mes "Then, this way.";
			ep17_2_main = 2;
			completequest 18000;
			setquest 18001;
			close2;
			cutin "",255;
			warp "ba_pw02",275,20;
			end;
			
		case 2:
			mes "[Rookie]";
			mes "Go ahead and enter the mansion through this sewer.";
			mes "Most of the colleagues who went in first cleaned up already.";
			next;
			mes "[Rookie]";
			mes "There might be a colleague that ^0000FFfell behind^000000, Please move together with them.";
			mes "Before you register as a guest in the mansion, prioritize everyone's safety first.";
			close;
	}
	mes "[Rookie]";
	mes "The path we took with you adventurer is a fresh feeling for me.";
	mes "I feel really alive these days.";
	close;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep_illusion == 46";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep_illusion == 47 && ep17_2_main == 0 && BaseLevel >= 130";
end;
}

ba_pw02,90,93,0	script	???????????????#ep172_bapw2-00	4_ENERGY_BLUE,{
	switch(ep17_2_main){
		case 2:
			cutin "bu_du5",2;
			mes "[???????????????]";
			mes "Urrrrrrrrrrrr!!!!";
			mes "Gruueeeeek...!!!";
			next;
			cutin "",255;
			mes "- When I looked at the strange sound, I saw a person who seems to be drowning. -";
			next;
			if(select("Help him.:Ignore it.") == 2){
				cutin "bu_du5",2;
				mes "[???????????????]";
				mes "Eeeeeek...";
				close2;
				cutin "",255;
				cloakonnpc "#dew_ep172_bapw2-00", getcharid(0);
				end;
			}
			mes "- It seems he is already incapable to do any action.";
			mes "Let's go get him a piece of Yggdrasil Leaf. -";
			ep17_2_main = 3;
			completequest 18001;
			setquest 11615;
			close2;
			cloakonnpc "#dew_ep172_bapw2-00", getcharid(0);
			end;
			
		case 3:
			if(!countitem(610)){
				mes "- It seems he is already incapable to do any action.";
				mes "Let's go get him a piece of Yggdrasil Leaf. -";
				close;
			}
			cloakoffnpc "Dew#ep172_bapw2-00", getcharid(0);
			mes "[Dew]";
			mes "Cough cough!!!!";
			mes "Eeeeeek.";
			delitem 610,1;
			completequest 11615;
			setquest 11616;
			ep17_2_main = 4;
			next;
			mes "[Dew]";
			mes "Wooooo!!!!";
			next;
			cutin "bu_du4",2;
			mes "[Dew]";
			mes "Ehem...";
			mes "I thought I was going to die!";
			next;
			mes "[Dew]";
			mes "Thank you!!";
			mes "You saved my life!";
			mes "I will never forget your kindness...";
			next;
			cutin "bu_du5",2;
			mes "[Dew]";
			mes "...Ah!!";
			mes "Ahhhhhhhhhhhh!!";
			next;
			cutin "bu_du2",2;
			mes "[Dew]";
			mes "Look who's here!!!";
			mes strcharinfo(0)+"!!!";
			next;
			mes "[Dew]";
			mes "I remember you...";
			mes "It's really fate to meet you in a place like this again!!!";
			next;
			cutin "bu_du3",2;
			mes "[Dew]";
			mes "If it wasn't for you, I'd wake up at the Prontera Church!";
			mes "For a moment, I saw Mark smiling brightly carrying a donation bag...";
			next;
			cutin "bu_du5",2;
			mes "[Dew]";
			mes "And after that, Mark...";
			mes "it's terrible... I don't want to... think about it again...";
			next;
			cutin "bu_du4",2;
			mes "[Dew]";
			mes "anyways, apart from that terrible story... you saved me here...";
			mes "Are you here to investigate the mansion?";
			next;
			cutin "bu_du2",2;
			mes "[Dew]";
			mes "As expected of someone whom I recognize as my rival!";
			mes "Isn't this place awesome???";
			mes "I can't believe this place has been hidden so far...";
			next;
			cutin "bu_du1",2;
			mes "[Dew]";
			mes "anyways, this is not the time for this!";
			mes "Let's go up!!!";
			mes "Now!!";
			next;
			mes "[Dew]";
			mes "I'm sure the other guys are gonna take all the fun for themselves!!!";
			next;
			cutin "bu_du3",2;
			mes "[Dew]";
			mes "Well, we should go and meet up with Mark and the others.";
			mes "Hmm...";
			mes "Ohhhhhhhhhhhhhhhhh!!";
			next;
			cutin "bu_du1",2;
			mes "[Dew]";
			mes "All right, over there!";
			mes "I think I can hear Magi's voice over there!!!";
			close2;
			cutin "",255;
			navigateto("ba_pw02",7,149);
			cloakonnpc "Dew#ep172_bapw2-00", getcharid(0);
			end;
			
		case 4:
			cloakoffnpc "Dew#ep172_bapw2-00", getcharid(0);
			cutin "bu_du1",2;
			mes "[Dew]";
			mes "This is not the time for this!";
			mes "Let's go up!!!";
			mes "Now!!";
			next;
			mes "[Dew]";
			mes "I'm sure the other guys are gonna take all the fun for themselves!!!";
			next;
			cutin "bu_du3",2;
			mes "[Dew]";
			mes "Well, we should go and meet up with Mark and the others.";
			mes "Hmm...";
			mes "Ohhhhhhhhhhhhhhhhh!!";
			next;
			cutin "bu_du1",2;
			mes "[Dew]";
			mes "All right, over there!";
			mes "I think I can hear Magi's voice over there!!!";
			close2;
			cutin "",255;
			navigateto("ba_pw02",7,149);
			cloakonnpc "Dew#ep172_bapw2-00", getcharid(0);
			end;
			
		default:

	}
	mes "- It seems to be a purifying device for dirty water. -";
	close;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 2";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 3 && countitem(610) > 0";
end;	
}

ba_pw02,90,93,5	duplicate(dummy_cloaked_npc)	#dew_ep172_bapw2-00	4_M_REDMAN
ba_pw02,93,93,3	duplicate(dummy_cloaked_npc)	Dew#ep172_bapw2-00	4_M_REDMAN

ba_pw01,14,115,0	script	#ep172_ev_00	HIDDEN_WARP_NPC,2,2,{
	end;
	
OnTouch:
	if(ep17_2_main == 4){
		cloakoffnpc "Magi#ep172_bapw1-00", getcharid(0);
		cutin "bu_maggi4",2;
		mes "[Magi]";
		mes "Aaaaaaah!!!";
		mes "Don't... don't come near me!!";
		mes "If you come any closer, I'll attack you!!!";
		next;
		cloakoffnpc "Dew#ep172_bapw1-00", getcharid(0);
		cutin "bu_du5",2;
		mes "[Dew]";
		mes "Aaaaaah!!!";
		mes "Magi!!!";
		next;
		mes "[Dew]";
		mes "These guys~~~";
		mes "How dare you, Magi!";
		next;
		mes "[Dew]";
		mes "Ignition Break...!!!";
		next;
		cutin "",255;
		cloakoffnpc "Lasis#ep172_bapw1-00", getcharid(0);
		specialeffect EF_DESPERADO,AREA,"Lasis#ep172_bapw1-00";
		mes "[Lasis]";
		mes "Magi, are you okay?";
		mes "Are you hurt somewhere?";
		mes "Phew... I thought it was Heart Hunters... It would be dangerous to be ambushed again in a place like this.";
		next;
		mes "[Lasis]";
		mes "Ugh...";
		mes "I used a big skill and my wound hurts...";
		next;
		cutin "bu_maggi4",2;
		mes "[Magi]";
		mes "Lasis, your wound has just healed, don't strain it. Don't push yourself too hard!!!";
		mes "Come. This way...";
		next;
		cutin "",255;
		mes "[Lasis]";
		mes "It's alright, Mark's healing skills have almost healed me completely.";
		next;
		cutin "bu_du1",2;
		mes "[Dew]";
		mes "Magi, are you okay?";
		mes "Where are the others?";
		mes "And who's this guy?";
		next;
		cutin "bu_maggi3",2;
		mes "[Magi]";
		mes "Dew?!";
		mes "Where have you been!!";
		mes "Do you know how worried I was when you suddenly disappeared?";
		mes "We've waited for a long time and you didn't show up, so Mark went to look for you!";
		next;
		cutin "",255;
		mes "[Lasis]";
		mes "Oh!";
		mes "Is this the guy Mark's looking for?";
		next;
		mes "[Lasis]";
		mes "It's nice to meet you.";
		mes "I'm Lasis of the Rebellion.";
		mes "You're Dew, and you're... I saw you at the base before...";
		next;
		cutin "bu_maggi1",2;
		mes "[Magi]";
		mes "I met Lasis earlier on the way up here.";
		mes "When Mark and I were alone, suddenly the a huge number of enemy came out of nowhere.";
		next;
		cutin "bu_du3",2;
		mes "[Dew]";
		mes "Without me too...";
		next;
		cutin "",255;
		mes "Bang!!!";
		next;
		cutin "bu_du4",2;
		mes "[Dew]";
		mes "Ouch!!!";
		next;
		cloakoffnpc "Mark#ep172_bapw1-00", getcharid(0);
		cutin "bu_mark3",2;
		mes "[Mark]";
		mes "What were you doing!!!";
		mes "What do you think I'm talking about?";
		mes "I told you not to go anywhere!!!!!";
		next;
		cutin "bu_du5",2;
		mes "[Dew]";
		mes "It hurts!!!";
		next;
		cutin "bu_mark3",2;
		mes "[Mark]";
		mes "Oh, my God. This guy is so...";
		mes "Sigh...";
		next;
		cutin "",255;
		mes "[Lasis]";
		mes "Mark, take a look at this place.";
		next;
		cutin "bu_mark1",2;
		mes "[Mark]";
		mes "Are you certain about this?";
		next;
		cutin "",255;
		mes "[Lasis]";
		mes "Yes, it's the same gem that we got from the Heart Hunters that you knocked down earlier.";
		mes "I wonder if it's really just a gem.";
		next;
		cutin "bu_mark1",2;
		mes "[Mark]";
		mes "Since the Heart Hunters have something like this in their possession, I'm sure it's something important since.";
		mes "Let's keep it for now.";
		mes "I'll figure something out later.";
		next;
		mes "[Mark]";
		mes "I've got a notice from Alp... that they found the door on their way back, so let's get up there before it gets any more dangerous.";
		ep17_2_main = 5;
		completequest 11616;
		setquest 11617;
		close2;
		cutin "",255;
		cloakonnpc "Dew#ep172_bapw1-00", getcharid(0);
		cloakonnpc "Mark#ep172_bapw1-00", getcharid(0);
		cloakonnpc "Magi#ep172_bapw1-00", getcharid(0);
		cloakonnpc "Lasis#ep172_bapw1-00", getcharid(0);
		questinfo_refresh();
		navigateto("ba_pw01",87,290);
		end;
	}
	if(ep17_2_main == 5){
		cloakoffnpc "Mark#ep172_bapw1-00", getcharid(0);
		cutin "bu_mark1",2;
		mes "[Mark]";
		mes "I've got a notice from Alp... that they found the door on their way back, so let's get up there before it gets any more dangerous.";
		navigateto("ba_pw01",87,290);
		close2;
		cutin "",255;
		cloakonnpc "Mark#ep172_bapw1-00", getcharid(0);
		end;
	}
end;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 4";
end;
}
	
ba_pw01,17,115,3	duplicate(dummy_cloaked_npc)	Dew#ep172_bapw1-00	4_M_REDMAN
ba_pw01,16,115,3	duplicate(dummy_cloaked_npc)	Mark#ep172_bapw1-00	4_M_BLUEMAN
ba_pw01,20,119,5	duplicate(dummy_cloaked_npc)	Magi#ep172_bapw1-00	4_F_PINKWOMAN
ba_pw01,19,119,3	duplicate(dummy_cloaked_npc)	Lasis#ep172_bapw1-00	4_M_REBELLION

ba_pw01,87,290,3	script	Alp#ep172_bapw1-00	4_M_BLACKMAN,{
	if(ep17_2_main < 7){
		cutin "bu_alp3",2;
		mes "[Alp]";
		mes "You're here...";
		mes "This way...";
		if(ep17_2_main == 5){
			ep17_2_main = 6;
			completequest 11617;
			setquest 11618;
		}
		close2;
		cutin "",255;
		warp "ba_in01",23,315;
		end;
	}
	cutin "bu_alp3",2;
	mes "[Alp]";
	mes "This devices can supply energy for a city... no, it can supply energy on a country level scale.";
	mes "What the hell is this devices for?";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 5";
end;
}

ba_in01,20,319,3	script	Lasis#ep172_bain1-00	4_M_REBELLION,{
	if(ep17_2_main < 8){
			mes "[Lasis]";
			mes "We're finally here.";
			mes "I've got someone to wait, let's split up here.";
			next;
			mes "[Lasis]";
			mes "Even if we split up here, I think I'll stay in this area for quite a while, so let me know if anything happens.";
			next;
			cloakoffnpc "Dew#ep172_bain01-00", getcharid(0);
			cloakoffnpc "Mark#ep172_bain01-00", getcharid(0);
			cloakoffnpc "Magi#ep172_bain01-00", getcharid(0);
			npctalk "Dew : Oh, is this another strange room?! Shouldn't we go outside?! Oh!!! Look at the window over there. There are so many amazing machines!!!","Dew#ep172_bain01-00",bc_self;
			cutin "bu_mark2",2;
			mes "[Mark]";
			mes "We'll go ahead first.";
			mes "Thank you, Lasis.";
			next;
			cutin "bu_maggi2",2;
			mes "[Magi]";
			mes "See you later~";
			next;
			cutin "bu_mark2",2;
			mes "[Mark]";
			mes "The door that goes to the inside is locked, so let's go outside.";
			if(ep17_2_main == 6){
				ep17_2_main = 7;
				completequest 11618;
				setquest 11620;
				questinfo_refresh();
			}
			close2;
			cutin "",255;
			cloakonnpc "Dew#ep172_bain01-00", getcharid(0);
			cloakonnpc "Mark#ep172_bain01-00", getcharid(0);
			cloakonnpc "Magi#ep172_bain01-00", getcharid(0);
			navigateto("ba_maison",70,145);
			end;
	}
	mes "[Lasis]";
	mes "By the way, why were you late?";
	close;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 6";
end;
}

ba_in01,31,321,5	duplicate(dummy_cloaked_npc)	Dew#ep172_bain01-00	4_M_REDMAN
ba_in01,19,322,5	duplicate(dummy_cloaked_npc)	Mark#ep172_bain01-00	4_M_BLUEMAN
ba_in01,18,323,5	duplicate(dummy_cloaked_npc)	Magi#ep172_bain01-00	4_F_PINKWOMAN

ba_maison,70,145,3	script	Tamarin#ep172_bamaison-00	4_EP17_TAMARIN,{
	if(ep17_2_main < 8){
		cutin "ep172_tamarin02",2;
		mes "[Tamarin]";
		mes "So you just arrived?";
		mes "Why are you so late?";
		next;
		cloakoffnpc "Dew#ep172_bamaison-00", getcharid(0);
		cloakoffnpc "Mark#ep172_bamaison-00", getcharid(0);
		cloakoffnpc "Magi#ep172_bamaison-00", getcharid(0);
		cutin "bu_mark1",2;
		mes "[Mark]";
		mes "Sorry... Dew suddenly disappeared again.";
		next;
		cutin "bu_du5",2;
		mes "[Dew]";
		mes "Hahahaha!!!";
		mes "What clothes are you wearing?";
		mes "It looks aweful!";
		next;
		cutin "ep172_tamarin03",2;
		mes "[Tamarin]";
		mes "They told me that you need a registration to get around the mansion, so I signed up and they suddenly replaced my clothes with this!";
		next;
		cutin "bu_du5",2;
		mes "[Dew]";
		mes "Hahahahahahaha!";
		mes "Ouch!!!";
		mes "I laughed so hard, that it made my stomach hurt!!!";
		next;
		cutin "ep172_tamarin03",2;
		mes "[Tamarin]";
		mes "Stop laughing!";
		next;
		mes "[Tamarin]";
		mes "Stop laughing and register immediately.";
		mes "Talk to Alpha near the door, She'll register you as guests.";
		if(ep17_2_main == 7){
			ep17_2_main = 8;
			completequest 11620;
			getitem 1000103,5;
			getexp 300000,300000;
			questinfo_refresh();
		}
		close2;
		questinfo_refresh();
		cutin "",255;
		cloakonnpc "Dew#ep172_bamaison-00", getcharid(0);
		cloakonnpc "Mark#ep172_bamaison-00", getcharid(0);
		cloakonnpc "Magi#ep172_bamaison-00", getcharid(0);
		end;
	}
	if(ep17_2_main >= 10 && ep17_2_library == 0){
		cloakoffnpc "Dew#ep172_bamaison-00", getcharid(0);
		cloakoffnpc "Mark#ep172_bamaison-00", getcharid(0);
		cloakoffnpc "Magi#ep172_bamaison-00", getcharid(0);
		cutin "ep172_tamarin02",2;
		mes "[Tamarin]";
		mes "Why is everyone like this...";
		next;
		cutin "bu_du5",2;
		mes "[Dew]";
		mes "Kahahahahahahak!!!!";
		next;
		cutin "ep172_tamarin03",2;
		mes "[Tamarin]";
		mes "Stop laughing!!!";
		mes "You should have changed clothes...";
		mes "Sniff…";
		mes "Sniff?";
		next;
		cutin "ep172_tamarin02",2;
		mes "[Tamarin]";
		mes "Woo!!!!";
		mes "This smell!!!!!!!!";
		mes "What is this smell? It's so bad!!!!";
		next;
		cutin "bu_mark4",2;
		mes "[Mark]";
		mes "Come to think if it, you look so dirty in a bright place.";
		mes "Ugh... You smell awful!!";
		next;
		cutin "bu_maggi3",2;
		mes "[Magi]";
		mes "Dew.";
		mes "You have a rotten smell...";
		next;
		cutin "bu_du1",2;
		mes "[Dew]";
		mes "Huh?";
		mes "Is it because I feel into the sewers?";
		next;
		cutin "bu_du2",2;
		mes "[Dew]";
		mes "Yeah!!";
		mes "Listen, I fell into the sewers earlier, and it was really dangerous!";
		mes "My lifesaver was...";
		next;
		cutin "bu_mark3",2;
		mes "[Mark]";
		mes "You reek, don't come near me you idiot!!!";
		next;
		cutin "bu_du3", 2;
		mes "[Dew]";
		mes "What smell is that?";
		mes "Sniff…";
		next;
		cutin "bu_du5",2;
		mes "[Dew]";
		mes "Uehhhhhhhh...";
		mes "I reek!!!!";
		mes "This is no joke!!!";
		next;
		mes "[Dew]";
		mes "Water!!!";
		mes "I need clean water!!!!!";
		next;
		mes "[Dew]";
		mes "Oh, there's something just right over there?!";
		next;
		cutin "bu_mark3",2;
		mes "[Mark]";
		mes "Where are you going!!!";
		ep17_2_library = 1;
		setquest 11621;
		close2;
		cutin "",255;
		cloakonnpc "Dew#ep172_bamaison-00", getcharid(0);
		cloakonnpc "Mark#ep172_bamaison-00", getcharid(0);
		cloakonnpc "Magi#ep172_bamaison-00", getcharid(0);
		navigateto("ba_maison",85,111);
		questinfo_refresh();
		end;
	}
	switch(checkquest(11639,PLAYTIME)){
		case -1:
			break;
		case 0:
		case 1:
			cutin "ep172_tamarin03", 2;
			mes "[Tamarin]";
			mes "Have a rest for now adventurer.";
			mes "Please come back after dawn.";
			close3;
		case 2:
			erasequest 11638;
			erasequest 11639;
			break;
	}
	switch(checkquest(11638,HUNTING)){
		case -1:
			cutin "ep172_tamarin03", 2;
			mes "[Tamarin]";
			mes "I've got a temporary assignment from Alpha,";
			mes "and I'm asking the adventurers.";
			next;
			mes "[Tamarin]";
			mes "There has been a report that the remains of the guardian, which seems to have been attacked recently,";
			mes "is ruining the beauty of the mansion.";
			next;
			mes "[Tamarin]";
			mes "And so.. I'm requesting to collect the parts of the guardian.";
			switch(select("Accept:Quit")){
				case 1:
					next;
					mes "[Tamarin]";
					mes "I'm looking forward to your cooperation.";
					setquest 11638;
					close3;
				case 2:
					next;
					mes "[Tamarin]";
					mes "I hope you can reconsider my request.";
					close3;
			}
		case 0:
		case 1:
			cutin "ep172_tamarin03", 2;
			mes "[Tamarin]";
			mes "I hope you're doing fine on collecting the parts of the guardians.";
			next;
			mes "[Tamarin]";
			mes "Let's make the mansion clean and restore its beauty.";
			close3;
		case 2:
			cutin "ep172_tamarin03", 2;
			mes "[Tamarin]";
			mes "Well done adventurer!";
			mes "Thank you for your cooperation.";
			next;
			mes "[Tamarin]";
			mes "I'll tell Alpha that you are done removing the remains of the guardians today.";
			next;
			mes "[Tamarin]";
			mes "Please come back after dawn.";
			erasequest 11638;
			setquest 11639;
			getitem 1000103,3;
			close3;
	}
	cutin "ep172_tamarin01",2;
	mes "[Tamarin]";
	mes "I heard that the Varmundt's mansion was burned down during the uprising of mercenaries... I think it's a lot different from what's written in the books.";
	close3;


OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(11620) == 1 || ep17_2_main == 7 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_main > 9 && ( checkquest(11639,PLAYTIME) == -1 || checkquest(11639,PLAYTIME) == 2 ) && checkquest(11638,HUNTING) == -1 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_main > 9 && checkquest(11638,HUNTING) == 2 " );
	end;	
}

ba_maison,69,146,5	duplicate(dummy_cloaked_npc)	Dew#ep172_bamaison-00	4_M_REDMAN
ba_maison,66,145,5	duplicate(dummy_cloaked_npc)	Mark#ep172_bamaison-00	4_M_BLUEMAN
ba_maison,68,146,5	duplicate(dummy_cloaked_npc)	Magi#ep172_bamaison-00	4_F_PINKWOMAN

//Mansion Registration
ba_maison,74,150,3	script	Mansion Manager Alpha#172nw01	4_EP17_MASTER_A,{
	if(ep17_2_main < 8){
		cutin "ep172_alpha",2;
		mes "[Mansion Manager Alpha]";
		mes "If you are a guest to the mansion, please complete a guest registration first. We are not responsible for any mishap that is caused by mistaking you as an intruder. Please understand.";
		close3;
	}
	switch(ep17_2_main){
		case 8:
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Welcome. It's a pleasure to meet you.";
			mes "I was worried that you got lost in the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "We have issued you a guest license. Unlike a formal invitation from Varmundt, this card is only temporary.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "The reason you were given a guest license is simple. You did not commit any harm to the property such as vandalism or theft, unlike the other intruders.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "This is a measure taken to prevent unpleasant incidents that may occur while you're wandering the mansion prior to the investigation.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "We kindly ask for your understanding. After confirming the purpose, method, and your identity, we will allow your investigation in the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "First, please tell me your name.";
			next;
			cutin "",255;
			select("I'm " + strcharinfo(0) + ".");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes strcharinfo(0) + ". What is the purpose of your visit?";
			next;
			cutin "",255;
			select("I am...");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes ".....";
			mes "Please wait a moment..";
			npctalk "The purpose... is... for.......","",bc_self;
			next;
			mes ".....";
			next;
			mes ".....";
			mes ".............";
			next;
			mes ".....";
			mes ".............";
			mes "...................";
			next;
			mes "[Mansion Manager Alpha]";
			mes "...Do you happen to have a party with you?";
			next;
			cutin "",255;
			select("I came with the Rebellions and some government officials.");
			mes ".....";
			next;
			mes ".....";
			mes ".............";
			next;
			mes ".....";
			mes ".............";
			mes "...................";			
			next;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Excuse me. " + strcharinfo(0) + "I will issue you a formal guest license right away.";
			next;
			cutin "",255;
			select("What? Suddenly?");	
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "I registered after confirming the identity and purpose of the visit of the other party members who came together from other places in the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Your ^0000CDparty^000000 has been granted formal status automatically because they were from the ^0000CDsame party^000000 who visited this mansion the other day.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "In addition, they have also stated that, you have come here to ^0000CDcatch the intruders^000000 who are making a disturbance inside the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Therefore, we will also issue a formal guest license for the mansion to your party, " + strcharinfo(0);
			next;
			mes "[Mansion Manager Alpha]";
			mes "Please wait a moment.";
			next;
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			specialeffect EF_VALLENTINE;
			sleep2 2000;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes strcharinfo(0)+". Welcome to the Varmundt's Mansion. Nice to meet you. I'm Alpha the manager of this mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "From now on. " + strcharinfo(0) + ", As a guest of honor, you are free to use the facilities in this mansion. If you have any question, please feel free to contact the nearest automatic dolls.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Also, if you need help cleaning up and information about the intruders in the mansion, we will fully cooperate.";
			mes "To that end, we've opened the outside of the mansion to the general public.";
			next;
			cutin "",255;
			select("Thank you.");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "I'll share the list of the new registered guests with " + strcharinfo(0) + " to the other automatic dolls.";
			next;
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			sleep2 2000;
			mes "[Mansion Manager Alpha]";
			mes "Attention all auto-dolls in the mansion, we have a new full authorized guest..";
			next;
			close2;
			mes ".....";
			next;
			mes ".....";
			mes ".............";
			next;
			mes ".....";
			mes ".............";
			mes "...................";
			next;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "I'm sorry, please wait a moment.";
			setquest 17333;
			questinfo_refresh();
			ep17_2_main = 9;
			close2;
			cutin "",255;
			end;
			
		case 9:
			setpcblock PCBLOCK_ALL,true;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Again...";
			mes "There's technical trouble....";
			next;
			select("What problems are you having?");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "It seems like there's a problem with the ^0000ffrepeaters for some sectors.^000000";
			mes "No signal is sent or received.";
			next;
			select("Repeater?");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";			
			mes "All the auto-dolls in this house are connected to a network using wireless communication.";
			mes "We can share information to all auto-dolls in the mansion anytime as needed..";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Informations like guests list, calendar, or events as we are doing it right now..";
			next;
			mes "[Mansion Manager Alpha]";
			mes "If you need to relay an information anywhere in the house, the repeater will be enough.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "However, I tried sending an updated guest list but I haven't received confirmation that they have received it.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "The repeater for some sectors in the mansion didn't send a feedback that's why it's failing right now..";
			next;
			select("Does it break down often?");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Downtime is not frequest because of our meticulous maintenance procedure.";
			mes "However, when the ^0000CDintruders^000000 entered the mansion the other day, they disassembled and extorted the facilities in the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "It might be the reason why the repeater are intermittently working.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "I'll have to check which sector's repeater is not functioning properly.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Sorry, but could you please wait a little longer?";
			mes "I need to check which sector is the problem and deliver manually the guest list..";
			next;
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			sleep2 1500;
			npctalk "Accommodations... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Laboratory... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Auditorium... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Restaurants... Signal failed...","",bc_self;
			sleep2 1500;
			npctalk "Guard Post... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Pavilion... Signal failed...","",bc_self;
			sleep2 1500;
			npctalk "Warehouse... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Garden... Signal failed...","",bc_self;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Okay. I've found the problematic repeater and three of them are in trouble.";
			mes "I'm glad not half of them are broken.";
			mes "Let's go to the problematic sector and manually pass the guest list and investigate the problem.";
			next;
			sleep2 700;
			cloakoffnpc "Tommy#ep172_bamaison00", getcharid(0);
			cloakoffnpc "Meimei#ep172_bamaison00", getcharid(0);
			mes "[Tommy]";
			mes "Is it here??";
			npctalk "Is it here??","Tommy#ep172_bamaison00",bc_self;
			next;
			mes "[Meimei]";
			mes "Oh, adventurer, here you are.";
			npctalk "Oh, adventurer, here you are.","Meimei#ep172_bamaison00",bc_self;
			next;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Another person. Are they a part of your party?";
			next;
			cutin "",255;
			select("Yes, I'm with them.");
			mes "[Meimei]";
			mes "Wow, this is the mansion. Varmdunt's Mansion!";
			npctalk "Wow, this is the mansion. Varmdunt's Mansion!","Meimei#ep172_bamaison00",bc_self;
			next;
			mes "[Tommy]";
			mes "Adventurer! The movement of the Illusions has been confirmed inside the mansion. Soon we're going to form a team, figure out the structure of the mansion, and start the operation.";
			next;
			select("I'll be waiting.");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "If you're new, please come this way. I'll officially register you as a guest of the mansion.";
			next;
			cloakonnpc "Tommy#ep172_bamaison00", getcharid(0);
			cloakonnpc "Meimei#ep172_bamaison00", getcharid(0);
			mes "[Mansion Manager Alpha]";
			mes "Oh, before that... " + strcharinfo(0) + ", have you looked around the mansion?";
			next;
			cutin "",255;
			select("Not yet.");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Then, may I take the liberty of asking you a favor? I didn't mean to eavesdrop, but you said you needed to figure out the structure of the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Can you tell the automatic dolls near the broken repeater to check the broken repeater?";
			next;
			mes "[Mansion Manager Alpha]";
			mes "It's a good course to take a look around the mansion.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "It's my job, but I don't have enough time to register, update and share information manually since guests are still coming in.";
			next;
			if(select("I'll do that.:I need to do something first.") == 2){
				mes "[Mansion Manager Alpha]";
				mes "Is that so, I'm sorry for asking too much on your busy schedule.";
				mes "Feel free to look around the mansion.";
				close3;
			}
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Thank you for your willingness to accept my unreasonable request.";
			mes "There are automatic dolls who haven't receieve the updated guest list yet, but we have officially granted " + strcharinfo(0) + " as a guest. The dolls will recognize you as you get close to them.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Everyone else has received the list, so it won't be that inconvenient to use the mansion. If you need any assistance, feel free to contact the nearest automatic doll.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "First, the nearest is the <NAVI>[restaurant]<INFO>ba_maison,146,109,0,101,0</INFO></NAVI>. You should go over there. If you tell the nearest automatic doll near the repeater about the problem, they will take care of it for you.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Then, please.";
			setpcblock PCBLOCK_ALL,false;
			ep17_2_main = 10;
			completequest 17333;
			setquest 17334;
			questinfo_refresh();
			close2;
			cutin "",255;
			navigateto("ba_maison",146,109);
			end;
		case 10: //Taste
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "First, the nearest is the <NAVI>[restaurant]<INFO>ba_maison,146,109,0,101,0</INFO></NAVI>. You should go over there. If you tell the nearest automatic doll near the repeater about the problem, they will take care of it for you.";
			close3;
		case 12: //Resthouse?
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			close3;
		case 13: //Cage
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Tell the problem to the automatic doll near the broken repeater on the <NAVI>[central garden]<INFO>ba_maison,245,206,0,0,0</INFO></NAVI> area and it will take care of it.";
			close3;
		case 14:
			setpcblock PCBLOCK_ALL,true;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes strcharinfo(0) + ", welcome back. Have you looked around the mansion? Also, did you delivered the message to the automatic dolls near the broken repeater's area?";
			next;
			cutin "",255;
			select("I delivered them all.");
			mes "[Mansion Manager Alpha]";
			mes "Thank you so much for your hard work. Let me check the network status for a moment.";
			next;
			cutin "",255;
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			sleep2 2000;
			npctalk "Accommodations... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Laboratory... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Auditorium... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Restaurants... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Guard Post... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Pavilion... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Warehouse... Signal received...","",bc_self;
			sleep2 1500;
			npctalk "Garden... Signal received...","",bc_self;
			sleep2 1000;
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "The network of the mansion has been restored and the signals in all areas are being sent and received clearly.";
			mes "Now, you can use all the facilities of the mansion as an official guest.";
			next;
			mes "[Mansion Manager Alpha]";
			mes strcharinfo(0) + ", Thank you very much.";
			mes "Thank you so much " + strcharinfo(0) + ".";
			mes "All traces of the intruders are now removed.";
			mes "I'm impressed how you learned and manage this kind of situation.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "You quickly learned the geography of the mansion, and you quickly become accustomed with the automatic dolls. It was impressive.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "Feel free to roam around the mansion and if you find other problems, please help.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "We automatic dolls serve the human guests as how we served the owner of the mansion, we are already familiar with it. But we have insufficient information and response skills to unfamiliar problems.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "We still haven't resolved the problem with the intruders. From a non-human perspective, it seems difficult to resolve it because there are many parts that doesn't have enough information.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "We would like to collect resolving intruder problems related data through " + strcharinfo(0) + ", It will be a great help in future cases.";
			next;
			cutin "",255;
			select("Okay.");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "It's not much, but as a token of appreciation, I will give you this.";
			mes "This is a ^0000CDBarmeal Ticket^000000, you can use it in the mansion's restaurant.";
			mes "You can freely eat anything with it, feel free to use it anytime.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "The mansion's <NAVI>[restaurant]<INFO>ba_maison,146,109,0,101,0</INFO></NAVI> is located at the bottom, as I showed earlier.";
			next;
			cutin "",255;
			select("Have you seen my party?");
			cutin "ep172_alpha",2;
			mes "[Mansion Manager Alpha]";
			mes "Those who came before you are now staying at the <NAVI>[tea house]<INFO>ba_maison,206,106,0,101,0</INFO></NAVI>, please take a look around and talk with them.";
			next;
			mes "[Mansion Manager Alpha]";
			mes "If you have any inconvenience in the mansion, please feel free to tell any automatic dolls. Please take this Barmeal Ticket, as a token of appreciation for your hard work.";
			setpcblock PCBLOCK_ALL,false;
			ep17_2_main = 15;
			completequest 17338;
			setquest 17381;
			getitem 1000103,5;
			close2;
			cutin "",255;
			questinfo_refresh();
			end;			
	}
	if(ep17_2_main >= 15){
		switch(checkquest(17341,PLAYTIME)){
			case -1:
				switch(isbegin_quest(17340)) {
					case 0:
						cutin "ep172_alpha", 2;
						mes "[Mansion Manager Alpha]";
						mes "Welcome, " +  strcharinfo(0) + "!";
						mes "Are you having problem or you need something?";
						next;
						cutin "ep172_alpha", 255;
						select( "Is the network working well?" );
						cutin "ep172_alpha", 2;
						mes "[Mansion Manager Alpha]";
						mes "Are you here for that matter? Thank you for your attention.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "Like the previous situation, the network within the mansion is experiencing intermittent connectivity.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "It is fixed immediately as soon as problem is found. But since the problem keeps occuring frequently, it is difficult to supply and fix communication chips.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "In addition, the broken automatic doll roams around and destroys the repeater over and over again.";
						next;
						if ( select( "Can I help?", "It must be difficult" ) == 2 ) close3;
						mes "[Mansion Manager Alpha]";
						mes "Thank you so much " +  strcharinfo(0) + ". I was worried that it will take your time. But... since it's not, I will ask your help.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "Please bring ^0000CD10 Automatic Doll Communication Chip^000000 for the repeater. That amount is enough for the day with spare on it.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "Also, it solves the problem of the automatic dolls. The communication chip can handle the broken beta that roams in the mansion.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "Then please. Good luck.";
						if (isbegin_quest(17340) == 0) {
							setquest 17340; //Spare Parts Supply & Demand
						}
						close3;
						end;
					case 1:
						if(countitem(1000232) < 10){
							cutin "ep172_alpha", 2;
							mes "[Mansion Manager Alpha]";
							mes "Welcome " +  strcharinfo(0) + ".";
							mes "Did you bring the automatic doll communication chip that I asked for?";
							next;
							mes "[Mansion Manager Alpha]";
							mes "Please bring ^0000CD10 Automatic Doll Communication Chip^000000 for the repeater. That amount is enough for the day with spare on it.";
							next;
							mes "[Mansion Manager Alpha]";
							mes "Also, it solves the problem of the automatic dolls. The communication chip can handle the broken beta that roams in the mansion.";
							next;
							mes "[Mansion Manager Alpha]";
							mes "Then please. Good luck.";
							close3;
							end;				
						}
						cutin "ep172_alpha", 2;
						mes "[Mansion Manager Alpha]";
						mes "Oh you've brought the automatic doll communication chip that I asked.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "This is enough. Thank you for your hard work.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "If you have time tomorrow after dawn, I'd like to ask you something.";
						next;
						mes "[Mansion Manager Alpha]";
						mes "Take this. Thank you.";
						delitem 1000232,10;
						getitem 1000103,3;
						erasequest 17340;
						setquest 17341;
						close3;
						end;
				}
			case 0:
			case 1:
				cutin "ep172_alpha", 2;
				mes "[Mansion Manager Alpha]";
				mes "Welcome " +  strcharinfo(0) + ".";
				mes "Do you feel uncomfortable or do you need anything?";
				next;
				mes "[Mansion Manager Alpha]";
				mes "Or maybe you did come to bring me the spare communication chip of the repeater?";
				next;
				mes "[Mansion Manager Alpha]";
				mes "The number of spare communication chip for the repeater are still enough.";
				mes "Don't worry about the repeater and just take a good rest today.";
				next;
				mes "[Mansion Manager Alpha]";
				mes "Come back after dawn. Thank you.";
				close3;
				end;
			case 2:
				cutin "ep172_alpha", 2;
				mes "[Mansion Manager Alpha]";
				mes "Welcome " +  strcharinfo(0) + ".";
				mes "Hope you are doing fine today.";
				erasequest 17341;
				close3;
				end;
		}
	}
	cutin "ep172_alpha", 2;
	mes "[Mansion Manager Alpha]";
	mes "Hello, how may I help you?";
	mes "Are you feeling uncomfortable? Please let us know.";
	close3;
	end;
	
OnProgressBar:
	progressbar_npc "00FF00",2;
end;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 8";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 9";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 14";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main >= 15 && checkquest(17341,PLAYTIME) == -1 && isbegin_quest(17340) == 0";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main >= 15 && checkquest(17341,PLAYTIME) == 2 && isbegin_quest(17340) == 0";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main >= 15 && isbegin_quest(17340) == 1 && countitem(1000232) >= 10";
end;
}

ba_maison,72,151,5	script	Tommy#ep172_bamaison00	4_M_GUNSLINGER2,{
	mes "[Tommy]";
	mes "This mansion is huge. I'm actually like this place.";
	mes "I didn't even know there was something like this.";
	close;
	
OnInit:
	cloakonnpc strnpcinfo(0);
end;
}

ba_maison,70,150,5	script	Meimei#ep172_bamaison00	4_F_REBELLION3,{
	mes "[Meimei]";
	mes "So, this is where you are. The mercenaries...";
	close;
	
OnInit:
	cloakonnpc strnpcinfo(0);
end;
}

ba_maison,146,109,5	script	Tasty#172nw01	4_EP17_BASIC_B,{
	switch(ep17_2_main){
		case 10:
			mes "[Tasty]";
			mes "Ugh! Now what?";
			mes "Wait. What is that?";
			mes "Chi, the intruder?";
			emotion ET_HUK;
			next;
			mes "[Tasty]";
			mes "That's right! That's right! Oh, what should I do? What do I do, What do I do? Security? Oh, yeah. I was told to call security.";
			npctalk "Come here, security, security...","",bc_self;
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			sleep2 2000;
			next;
			mes "[Tasty]";
			mes "What? It's not working! When did it break down? Oh, what do I do?";
			emotion ET_HUK;
			next;
			mes "[Tasty]";
			mes "Okay! Rice cakes! I'll give you a rice cake. Why don't you go somewhere else? You like rice cakes, don't you?";
			next;
			emotion ET_QUESTION,getcharid(3);
			select("...");
			mes "[Tasty]";
			mes "Oh, isn't it rice cake? Aren't you the guy I met before? Then, meat? Do you like meat? You like meat, don't you? I've never seen anyone who doesn't like meat. I'll give you all the meat I have.";
			next;
			emotion ET_SWEAT,getcharid(3);
			select("......");
			mes "[Tasty]";
			mes "Strange? It's not meat? So what do you want? If I give you something, would you just go back?";
			emotion ET_QUESTION;
			next;
			mes "[Tasty]";
			mes "Oh, what should I do? I was told not to run to the intruders. Are you here to ^0000CDtake my parts^000000? Is this the end of me?";
			next;
			emotion ET_SWEAT,getcharid(3);
			select("I'm not that kind of person.");
			mes "[Tasty]";
			mes "You're not that kind of person...? Then, what kind of person are you?";
			next;
			mes "[Tasty]";
			mes "Hold on...? You're right? You're not drooling, and your eyes are normal. Are you not an ^0000CDintruder^000000?";
			emotion ET_QUESTION;
			next;
			select("I'm a guest of the mansion, but...");
			mes "[Tasty]";
			mes "What? A guest? Oh wait. I'll check...";
			emotion ET_HUK;
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			sleep2 2000;
			next;
			mes "[Tasty]";
			mes "It's real? But... You're a first time guest? New guest? Finally? Oh, I'm sorry for mistaking you as an intruder.";
			emotion ET_SURPRISE;
			next;
			mes "[Tasty]";
			mes "I thought you were one of the intruder.";
			mes "Somehow, everyone said they were running away, it's because of you, the new guests, right?";
			next;
			mes "[Tasty]";
			mes "What's your relationship with the intruder? Are we natural enemies? Which way is above the pyramid? The intruders is running away, so it's your fault?";
			next;
			select("It's not like that.");
			mes "[Tasty]";
			mes "Oh, really? I didn't know because it's been so long since I saw a human being.";
			mes "So why didn't I recognize a guest? All new guests would have been shared to us.";
			next;
			select("The repeater is broken, so...");
			mes "[Tasty]";
			mes "Oh, no wonder! The network stopped working suddenly. The repeater is not functioning! Then why isn't Alpha coming?";
			next;
			select("Alpha is busy right now.");
			mes "[Tasty]";
			mes "Alpha is too busy to come? No way. Oh, were you trying to help me voluntarily? What an unusual guest. Come to think of it, there was a^0000CDcustomer like that before^000000.";
			next;
			mes "[Tasty]";
			mes "I'm sorry.";
			mes "The guest who visited the mansion showed interest in the mansion and us automatic dolls, but there were no guests who helped us around the mansion.";
			next;
			mes "[Tasty]";
			mes "Anyway, If we have a lot of guests, they'll be coming to eat soon. I've got to prepare. It's been a long time since I've had guests.";
			next;
			mes "[Tasty]";
			mes "I haven't had any guests in the restaurant for a long time. I had no customer when I was cooking. The intruders... when they got here. My eyes change and I took them away. They were not guests.";
			next;
			mes "[Tasty]";
			mes "The invaders didn't last long, but they threw the mansion into chaos in that brief moment. They took the machines in the mansion, the automatic dools, everything that seemed useful to them were removed out of place.";
			next;
			mes "[Tasty]";
			mes "That repeater over there must have a ^0000CDbroken communication chip too^000000?";
			next;
			mes "[Tasty]";
			mes "Damn humans. Most of them seems to have run away by now, but there are still some left. I've seen them here a few times. They're after the food.";
			next;
			mes "[Tasty]";
			mes "Again, I'm sorry.";
			mes "Now that I see it, I don't know why I mistaken you as an intruder. You're different.";
			next;
			mes "[Tasty]";
			mes "Again, I'm sorry.";
			mes "Now that I see it, I don't know why I mistaken you as an intruder. You're different.";
			next;
			mes "[Tasty]";
			mes "Anyway, I need to fix the repeater... Let's see...";
			next;
			mes "[Tasty]";
			mes "Um... the communication chip is broken! I have to put it in. Where to get it right now? I have to greet guests!";
			next;
			cloakoffnpc "Strange Automatic Doll#ep172_bamaison-00", getcharid(0);
			npctalk "Let's burn them all!!! Hehehe!","Strange Automatic Doll#ep172_bamaison-00",bc_self;
			specialeffect EF_FIREWALL,AREA,"Strange Automatic Doll#ep172_bamaison-00";
			sleep2 1100;
			mes "[Tasty]";
			mes "Ugh- There's another broken one over there.";
			next;
			mes "[Tasty]";
			mes "......";
			mes "...... wait?";
			next;
			mes "[Tasty]";
			mes strcharinfo(0) + ", can you catch that? Can you do it?";
			next;
			select("A broken automatic doll?");
			mes "[Tasty]";
			mes "Uh. All communication chips are standard, so if they're replaced with a new one. I think it'll return back to normal.";
			next;
			select("Uh...");
			mes "[Tasty]";
			mes "Why do you look like that? Is it because you're reluctant to hurt an automatic doll in front of another one? Don't worry about that.";
			next;
			mes "[Tasty]";
			mes "We need to repair it anyway, but we need to capture it first.";
			mes "You can think of it as saving the trouble for us automatic dolls.";
			next;
			mes "[Tasty]";
			mes "If you leave it alone, it will wander around the mansion and destroy it, so you'll have to deal with it quickly as you can.";
			mes "It's better to capture it, then take out the chip and use it to fix the repeater.";
			next;
			mes "[Tasty]";
			mes "Everyone has been doing that ever since the intruders showed up. Even if " + strcharinfo(0) + "doesn't do it, it's all up to us automatic dolls.";
			mes "It's nice to work a little bit.";
			next;
			ep17_2_main = 11;
			completequest 17334;
			setquest 17335;
			questinfo_refresh();
			mes "[Tasty]";
			mes "Please take care of the Broken Beta and bring ^0000CD1 Automatic Doll Communication Chip^000000.";
			npctalk "Garden! Let's go to the garden!!","Strange Automatic Doll#ep172_bamaison-00",bc_self;
			sleep2 300;
			cloakonnpc "Strange Automatic Doll#ep172_bamaison-00", getcharid(0);
			npctalk "Oh, it ran away! Just grab another broken one and bring it to me.","",bc_self;
			end;
		case 11:
			mes "[Tasty]";
			mes "What about the communication chip?";
			next;
			if(!countitem(1000232)){
				mes "[Tasty]";
				mes "You haven't yet? Are you reluctant to hurt an automatic doll? Don't worry about it. I will do it later on anyway.";
				next;
				mes "[Tasty]";
				mes "I'll take care of the broken automatic dolls, just bring ^0000CD1 Automatic Doll Communication Chip^000000.";
			} else {
				mes "[Tasty]";
				mes "Did you bring it? Give it to me. I'll fix it. Thank you very much for bringing it.";
				next;
				mes "[Tasty]";
				mes "By the way, is that the only broken repeater?";
				next;
				select("The pavilion and the garden...");
				mes "[Tasty]";
				mes "Oh, really? Then go ahead to the <NAVI>[pavilion]<INFO>ba_maison,334,143,0,0,0</INFO></NAVI> first. It's the closest one here. Just follow this road over here.";
				next;
				mes "[Tasty]";
				mes "Don't touch the broken repeater carelessly. Tell the nearby automatic dolls over there and they'll take care of it.";
				next;
				mes "[Tasty]";
				mes "Do you happen to have a Barmeal Ticket? It's use to eat at the restaurant. I'll give you this, so come and eat later! I'll prepare a good food for you! As thanks!";
				delitem 1000232,1;
				ep17_2_main = 12;
				completequest 17335;
				setquest 17336;
				getitem 1000103,5;
				getexp 300000,300000;
				questinfo_refresh();
				close2;
				navigateto("ba_maison",334,143);
			}
			end;
		case 12:
			mes "[Tasty]";	
			mes "Go ahead to the <NAVI>[pavilion]<INFO>ba_maison,334,143,0,0,0</INFO></NAVI> first. It's the closest one here. Just follow this road over here.";
			next;
			mes "[Tasty]";
			mes "Don't touch the broken repeater carelessly. Tell the nearby automatic dolls over there and they'll take care of it.";
			end;
		default:
			mes "[Tasty]";
			mes "What should I make today...What should I do to make it taste good?";
			close;
	}
	
OnProgressBar:
	progressbar_npc "00FF00",2;
end;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 10";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 11 && countitem(1000232) > 0";
end;
}

ba_maison,145,106,0	script	Repeater#172nw01	CLEAR_NPC,{ end; }
ba_maison,148,107,3	duplicate(dummy_cloaked_npc)	Strange Automatic Doll#ep172_bamaison-00	4_EP17_BASIC_B_NG

ba_maison,334,143,3	script	Repeater#172nw02	2_POSTBOX,{
	switch(ep17_2_main){
		case 12:
			mes "[" + strcharinfo(0) + "]";
			mes "There's no one here...? What should I do with this? Is the automatic doll communication chip broken again...?";
			next;
			mes "[" + strcharinfo(0) + "]";
			mes "What will happen if I open this...?";
			next;
			mes "[" + strcharinfo(0) + "]";
			mes "Argh!!!! My hand!!";
			specialeffect2 EF_MADNESS_BLUE;
			specialeffect2 EF_THUNDERSTORM2;
			next;
			cloakoffnpc "Automatic Doll#ep172_repeater-00", getcharid(0);
			sleep2 1000;
			specialeffect EF_FIREHIT;
			sleep2 600;
			specialeffect EF_FIREHIT;
			mes "[Wary]";
			mes "This...! What a mess! Here we go again! It wants to fight.";
			npctalk "This...! What a mess! Here we go again! It wants to fight.","Automatic Doll#ep172_repeater-00",bc_self;
			next;
			mes "[Wary]";
			mes "Get out of my head right now!";
			next;
			select("Over there...");
			mes "[Wary]";
			mes "Are you trying to control me?";
			npctalk "That's not how it works.","Automatic Doll#ep172_repeater-00",bc_self;
			next;
			mes "[Wary]";
			mes "This little thing! I'll dispose of it!";
			npctalk "At this rate, we're all going to suffer!","Automatic Doll#ep172_repeater-00",bc_self;
			specialeffect EF_FIREHIT;
			sleep2 600;
			specialeffect EF_FIREHIT;
			next;
			mes "[Wary]";
			mes "Are you trying to take over me?? Just try!!";
			next;
			select("What should I do? Should I just go?");
			cloakoffnpc "Automatic Doll#ep172_repeater-01", getcharid(0);
			mes "[Kimchi]";
			mes "Phew- Here you are. Why do you keep escaping? Calm down for a bit.";
			npctalk "Okay.","Automatic Doll#ep172_repeater-00",bc_self;
			next;
			mes "[Kimchi]";
			mes "Anyway, who...? An intruder? ...Is it not?";
			next;
			mes "[Kimchi]";
			mes "Oh, you're a guest, aren't you? Those who come and go in front of the pavilion are also guests.";
			next;
			mes "[Kimchi]";
			mes "But that's weird. If you're a guest, I would recognize you in an instant.";
			mes "You are not an unregistered guest, you're a regular guest here.";
			next;
			select("They can't share it because of the repeater.");
			mes "[Kimchi]";
			mes "Oh, it's because of that! Everytime time I find something broken, I'll repair it, but as you can see, even if I take my eyes out for a moment, Wary comes out and break it like this.";
			next;
			mes "[Kimchi]";
			mes "Oh, did our hawk bit you? It's been going on since he was attacked by the ^0000CDintruders^000000. I already fixed it before, but Wary always come out and does this...";
			next;
			mes "[Kimchi]";
			mes "There are a lot of dolls that became like this.";
			mes "They will return to normal if you fix it, but there are some dolls that can't be fixed at all no matter how hard I try.";
			next;
			mes "[Kimchi]";
			mes "I heard the hawks wander around the ^0000CDmansion and ruin it^000000.";
			next;
			mes "[Kimchi]";
			mes "I'm sorry to interrupt you at your break. Please enjoy this area of the Varmundt's mansion to your hearts content.";
			next;
			specialeffect EF_FIREHIT;
			mes "[Wary]";
			mes "How can this thing be this lively.";
			npctalk "You better start talking!","Automatic Doll#ep172_repeater-00",bc_self;
			next;
			mes "[Wary]";
			mes "You, are you going to get out of my head or not? If you won't then I'll go out!";
			next;
			mes "[Kimchi]";
			mes "Hey, hey. Why are you opening the repeater?";
			specialeffect EF_FIREHIT,AREA,"Automatic Doll#ep172_repeater-00";
			next;
			select("Oh, you need to fix it quickly.");
			mes "[Wary]";
			mes "What the hell are you? Are you pitying me?";
			npctalk "Are you one of them?","Automatic Doll#ep172_repeater-00",bc_self;
			next;
			mes "[Kimchi]";
			mes "Hey, this person is not an intruder. It's our guest. Let them enjoy here in the mansion.";
			next;
			mes "[Kimchi]";
			mes "I'll fix the repeater quickly. Wary will surely come out and destroy it, but don't worry we can fix it again.";
			next;
			mes "[Kimchi]";
			mes "Thanks for letting me know. Are there any places where the repeater doesn't work?";
			emotion ET_OHNO,getnpcid(0,"Automatic Doll#ep172_repeater-01");
			next;
			select("The garden in front of the mansion.");
			mes "[Kimchi]";
			mes "Oh, it's not working there either.";
			mes "Go up from this road and turn left to go to the <NAVI>[central garden]<INFO>ba_maison,245,206,0,0,0</INFO></NAVI>.";
			next;
			mes "[Kimchi]";
			mes "Come on, Warry. Let's go back.";
			npctalk "Yes!","Automatic Doll#ep172_repeater-00",bc_self;
			sleep2 1200;
			cloakonnpc "Automatic Doll#ep172_repeater-00", getcharid(0);
			cloakonnpc "Automatic Doll#ep172_repeater-01", getcharid(0);
			ep17_2_main = 13;
			completequest 17336;
			setquest 17337;
			getitem 1000103,5;
			questinfo_refresh();
			close2;
			navigateto("ba_maison",245,206);
			end;
		case 13:
			mes "[" + strcharinfo(0) + "]";
			mes "The doll told me to go up from this road and turn left to go to the <NAVI>[central garden]<INFO>ba_maison,245,206,0,0,0</INFO></NAVI>.";
			end;			
		default:
			npctalk ".....","",bc_self;
			end;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 12";
	end;
}

ba_maison,333,144,5	duplicate(dummy_cloaked_npc)	Automatic Doll#ep172_repeater-00	4_EP17_SCISSORE
ba_maison,331,145,5	duplicate(dummy_cloaked_npc)	Automatic Doll#ep172_repeater-01	4_EP17_TABLET

ba_maison,245,206,5	script	Gabriel#172nw01	4_EP17_GUARD_B,5,5,{
	switch(ep17_2_main){
		case 14:
			mes "[Gabriel]";
			mes "If this is the last one, please report back to <NAVI>[Alpha]<INFO>ba_maison,74,150,0,0,0</INFO></NAVI>.";
			end;
		default:
			break;
	}
	if(ep17_2_main > 14){
		mes "[Cage]";
		mes "Hello, apologies if I didn't recognize you earlier.";
		mes "Do you need something? I will do my best to help you.";
		close;
	}
	npctalk "Only authorize persons are allowed to access this area.","",bc_self;
	end;
	
OnTouch:
	switch(ep17_2_main){
		case 13:
			mes "[Gabriel]";
			mes "Don't come any closer.";
			mes "This place is accessible only to authorized personnels.";
			next;
			select("Oh, I am...");
			mes "[Gabriel]";
			mes "I'm not concern about that. I don't need to know anything about you. This place is restricted. Raise your hands and don't come any closer.";
			next;
			mes "[Gabriel]";
			mes "Don't even think about using weapons, I'm way faster than you are. Where did you come from?";
			next;
			select("The sewer, but I...");
			mes "[Gabriel]";
			mes "So you came from the sewers, huh. Then stand still until I hand you over to the security.";
			next;
			sleep2 1500;
			npctalk "Calling. Area 4. Area 4.","",bc_self;
			sleep2 2000;
			npctalk "Security Office : This is area 4, over.","",bc_self;
			sleep2 2000;
			npctalk "I need support. There's an intruder in area 7, over.","",bc_self;
			sleep2 2000;
			npctalk "Security Office : Currently, all intruders have been repelled. Patrolling is not required anymore, over.","",bc_self;
			sleep2 2000;
			npctalk "What are you talking about when there's one right in front of me? Area 4! Area 4??","",bc_self;
			sleep2 2000;
			npctalk "Security Office : ...","",bc_self;
			sleep2 2000;
			select("I'm a guest at the mansion.");
			mes "[Gabriel]";
			mes "A guest? If you are one I would have known.";
			unittalk getcharid(3),strcharinfo(0) + " : I'm saying the truth...";
			next;
			mes "[Gabriel]";
			mes "I will check it for a moment. Don't move from your spot.";
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnProgressBar";
			sleep2 2000;
			next;
			mes "[Gabriel]";
			mes "Oh, you're a real guest aren't you? You're a special guest who has permission to access all areas... I apologize for my mistake. Please excuse me.";
			next;
			select("I can't believe it. You suddenly attacked me.");
			mes "[Gabriel]";
			mes "Attack? Did I attack? I only responded according to the intruder response manual. Oh, did you felt like you were attacked?";
			next;
			select("No...");
			mes "[Gabriel]";
			mes "Once again, I apologize for my mistake.";
			mes "Recently, we guards are more suspicious and sharper because of the intruders. Also, among the them there is a man with a low profile that appeared and resisted strongly.";
			next;
			mes "[Gabriel]";
			mes "By the way, how were you able to get permission to access all areas? Normally, ordinary guests can only use non-restricted areas.";
			next;
			mes "[Gabriel]";
			mes "If you were such a distinguished guest, I should have received your information much earlier.";
			next;
			select("It's because of the repeater.");
			mes "[Gabriel]";
			mes "The repeater? The repeater here is working fine...";
			next;
			mes "[Gabriel]";
			mes "Wait, this isn't a signal problem, suddenly there's a ^0000CDhacking channel^000000 jamming it... right?";
			next;
			select("Hacking?");
			mes "[Gabriel]";
			mes "Knowing that the automatic dolls in the mansion send and receive signals throught the repeater. Sometimes, people ^0000CDhack the repeater^000000 to try to control the automatic dolls or to keep track of what's happening inside the mansion.";
			next;
			mes "[Gabriel]";
			mes "There are still intruders left inside the mansion.";
			mes "I must search thoroughly.";
			next;
			mes "[Gabriel]";
			mes "Previously, the intruders were alerted because of a guest who wandered around the mansion, thinking there were no such guest int the mansion.";
			next;
			mes "[Gabriel]";
			mes "But that doesn't change the fact that they're intruders. Unlike the previous guest who were just curious, they infiltrated the premises and commited all kinds of violence in the mansion. Don't you think they're like a thief?";
			next;
			mes "[Gabriel]";
			mes strcharinfo(0) + ", If you don't want to be misunderstood by the other automatic dolls in the mansion, especially in the vicinity of restricted areas, you should identify yourself in advance.";
			next;
			select("This is the last.");
			mes "[Gabriel]";
			mes "Is that so? Then I'll have to hurry and the repeater, please excuse me.";
			mes "Also, it's not much but please accept this as an apology.";
			next;
			mes "[Gabriel]";
			mes "If this is the last one, please report back to <NAVI>[Alpha]<INFO>ba_maison,74,150,0,0,0</INFO></NAVI>. Also... Welcome to the Varmundt's Mansion. If you need assistance, feel free to ask any automatic doll.";
			ep17_2_main = 14;
			completequest 17337;
			setquest 17338;
			getitem 1000103,5;
			questinfo_refresh();
			close2;
			navigateto("ba_maison",74,150);
			end;
		case 14:
			mes "[Gabriel]";
			mes "If this is the last one, please report back to <NAVI>[Alpha]<INFO>ba_maison,74,150,0,0,0</INFO></NAVI>.";
			end;
		default:
			break;
	}
	if(ep17_2_main > 14){
		mes "[Cage]";
		mes "Hello, apologies if I didn't recognize you earlier.";
		mes "Do you need something? I will do my best to help you.";
		close;
	}
	npctalk "Only authorize persons are allowed to access this area.","",bc_self;
	end;

OnProgressBar:
	progressbar_npc "00FF00",2;
	end;

OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 13";
	end;
}

//Findings about Mercenary Wars
ba_in01,220,116,0	script	#ep172_tea_ev	HIDDEN_WARP_NPC,3,3,{
	end;
	
OnTouch:
	if(ep17_2_main < 17 || ep17_2_main >= 20 && ep17_2_main < 24)
		cloakonnpc "Kaya Toss#jh5_1", getcharid(0);
	sleep2 1;
	if(ep17_2_main >= 24)
		cloakoffnpc "Tatio#jh5_1", getcharid(0);
	sleep2 1;
	if(ep17_2_main > 24)
		cloakonnpc "Rookie#jh5", getcharid(0);
	end;
}
ba_in01,206,106,3	script	Philofontes#jh5_1	4_M_PHILOFONTES,{
	if(ep17_2_main < 15){
		cutin "ep16_tes01",2;
		mes "[Tess]";
		mes "Can you meet Alpha first and then come back here at the teahouse?";
		mes "It seems that the first thing you need to do here is register yourself as a guest.";
		mes "- A preceding quest still exist. -";
		close3;
	}
	switch(ep17_2_main){
		case 15:
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "Dien, please check the authenticity again.";
			mes "This is a document that the goverment examined when the mercenaries stayed here at the Varmundt Mansion.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "Well... even if tried to check the authenticity many times.";
			mes "I'm not sure to what extent our cooperation will go.";
			next;
			mes "[Dien]";
			mes "I'm a bit tired of saying the same thing over and over again.";
			next;
			cutin "",255;
			mes "(Situation doesn't look good. Let's observe for now.)";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "You'll be convinced with the evidence.";
			mes "There's another proof that the government tried to talk with the mercenaries but they didn't respond.";
			next;
			cutin "ep162_rds01",2;
			mes "[Ridsh]";
			mes "That kind of talk never happened! Not a single soul from the government came to talk you know?";
			mes "I already said no, how long will you keep asking me to find out the truth like a parrot?";
			next;
			cutin "ep162_rds02",2;
			mes "[Ridsh]";
			mes "It's the same when you brought us new documents, you're lying!";
			mes "You've been lying to us several times already!";
			next;
			cutin "ep16_tes03",2;
			mes "[Tess]";	
			mes "Why would you think that we'll deliberately use false documents...!";
			mes "Ah, " + strcharinfo(0) + ", since when have you been here? I've shown you a shameful side of me.";
			next;
			mes "[Tess]";	
			mes "I'm talking with the Rebellion <NAVI>[Elders]<INFO>ba_maison,203,103,0,0,0</INFO></NAVI>, but it's difficult to verify events that happened in the past...";
			ep17_2_main = 16;
			completequest 17381;
			setquest 16440;
			questinfo_refresh();
			close3;	
		case 16:
			cutin "ep16_tes03",2;
			mes "[Tess]";
			mes "I'm talking with the Rebellion <NAVI>[Elders]<INFO>ba_maison,203,103,0,0,0</INFO></NAVI>, but they're quite stubborn, perhaps because they're already seniors.";
			next;
			cutin "ep162_rds02",2;
			mes "[Ridsh]";
			mes "Hey! Who are you calling seniors?";
			close3;	
		case 17:
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "Adventurer, please go to the managers of the mansion and find out what happened about the time when the mercenaries stayed here in Varmdunt Mansion.";			
			close3;	
		case 18:
			npctalk "Tess : Please pay attention to Ridsh.","",bc_self;
			end;
		case 19:
			npctalk "Tess : I think Kaya Toss has something to say.","",bc_self;
			end;		
		case 20:
		case 21:
			npctalk "Tess : All of us were playing in the hands of the corporate.","",bc_self;
			end;
		default:
			npctalk "Tess : Thank you for all your help, adventurer.","",bc_self;
			end;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 15";
	end;
}

ba_in01,202,108,5	script	Rookie#jh5	4_M_ROOKIE,{
	switch(ep17_2_main){
		case 17:
			setarray .@quest,16442,16443,16444,16445,16453;
			for(.@i = 0; .@i < getarraysize(.@quest); .@i++){
				if(isbegin_quest(.@quest[.@i]) != 2)
					.@miss++;
			}
			if(.@miss){
				cutin "16loo_01",2;
				mes "[Rookie]";
				mes "The managers knows the truth about the mercenary war.";
				mes "They're all automatic dolls, they will have a vivid memory and they won't tell lies.";
				next;
				mes "[Rookie]";
				mes "Please listen to the stories of those days, adventurer.";
				close3;
			}
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Have you heard enough from the managers?";
			mes "Now, tell us about the facts that you've heard.";
			next;
			cutin "",255;
			select("Tell the story of the mysterious body.");
			cutin "16loo_03",2;
			mes "[Rookie]";
			mes "There is a body suddenly, What do you mean?";
			emotion ET_SWEAT;
			next;
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "It is said that the body that was found was not of the mercenaries, mansion's staff, or part of the corporate... Do you have any specific information?";
			next;
			cutin "",255;
			select("Hand over specific data.");
			cutin "ep162_rds03",2;
			mes "[Ridsh]";
			mes "This person doesn't really look like a mercenary. Why would a person like this be near Varmdunt Mansion and be killed?";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "Wait... Show me the data too.";
			next;
			mes "[Tess]";
			mes "..................";
			mes "..................";
			emotion ET_SURPRISE,getnpcid(0,"Philofontes#jh5_1");
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "Is there something bothering you about this data?";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "We know who this person is.";
			mes "This person is one of the commissioner the government sent to the mercenaries for the negotiation.";
			next;
			mes "[Tess]";
			mes "It's said that the commissioner didn't come back after being sent, the commissioner was later presumed as a missing person.";
			mes "But, later found dead in the Varmdunt Mansion.";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "So, you're saying... A government official who went to see the mercenaries, was killed before even meeting the mercenaries...";
			next;
			mes "[Rookie]";
			mes "This, who did such thing.";
			next;
			cutin "",255;
			switch(select("The Enterprise.:The Government.:The Mercenaries.")){
				case 1:
					cutin "16loo_03",2;
					mes "[Rookie]";
					mes "...There is no evidence, adventurer.";
					mes "Your words gives me heartaches.";
					emotion ET_SWEAT;
					next;
					mes "[Rookie]";
					mes "We should talk more carefully.";
					break;
					
				case 2:
					cutin "ep16_tes02",2;
					mes "[Tess]";
					mes "Why would someone from the government kill the one they sent?";
					emotion ET_QUESTION,getnpcid(0,"Philofontes#jh5_1");
					next;
					cutin "ep16_tes03",2;
					mes "[Tess]";
					mes "Even if it's the government's opposition, it would have been difficult to commit murder without escaping the eyes of the mercenaries' and workers inside the Varmdunt Mansion.";
					break;
					
				case 3:
					cutin "ep162_dn03",2;
					mes "[Dien]";
					mes "No, the mercenaries didn't even know it was a person from the government. Even the body was found late.";
					emotion ET_SURPRISE,getnpcid(0,"Dien#jh5_1");
					next;
					mes "[Dien]";
					mes "It wasn't the mercenaries.";
					break;
			}
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "It would have been a difficult to avoid the eyes of the mercenaries' and workers in the Varmdunt Mansion.";
			mes "But, the mercenaries are not the culprit.";
			next;
			cutin "",255;
			emotion ET_SURPRISE,getnpcid(0,"Dien#jh5_1");
			select("It's probably the mercenaries.");
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "Are you saying that we're lying? Even after listening to the managers?!";
			next;
			cutin "",255;
			select("There must have been a traitor among the mercenaries.");
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "I'm sure there's enough evidence for you to say that.";
			mes "Now, show us the evidence.";
			next;
			if(select("H's suspicious behavior.:Company envelope") == 1){
				emotion ET_SWEAT, getnpcid(0, "Rookie#jh5");
				cutin "16loo_03", 2;
				mes "[Rookie]";
				mes "... But there's no concrete evidence.";
				mes "Right now, we can't just talk about gut feeling. I need proof.";
				close3;
			}
			cutin "ep171_kaya03",2;
			mes "[Kaya Toss]";
			mes "Thats... No, it's an envelope with the corporate's seal on it. It's badly crumpled. Where did you get this envelope? It's an item that's strictly forbidden to leak outside of Rekenber.";
			emotion ET_SURPRISE,getnpcid(0,"Kaya Toss#jh5_1");
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "Look at the contents of the envelope. That's what's important.";
			mes "It's been a long time since I've last read, but I can read it perfectly, like it's a command book.";
			emotion ET_SURPRISE,getnpcid(0,"Dien#jh5_1");
			next;
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "I've asked someone to 'dispose' of the government personnel to prevent contact with the mercenaries... And I told him to break inside Varmdunt Mansion and steal Varmdunt's research data...";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "It's signed by the recipient, 'H. Luckenberg";
			mes "It's a proof of the identity of the traitor that you mentioned.";
			next;
			cutin "ep171_kaya02",2;
			mes "[Kaya Toss]";
			mes "..........";
			emotion ET_THINK,getnpcid(0,"Kaya Toss#jh5_1");
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "Corporate representative, You don't look so well.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "...I need some time, I have something that I want to check.";
			mes "I'll get in touch with my secretary, please continue without me.";
			emotion ET_THINK,getnpcid(0,"Kaya Toss#jh5_1");
			cloakonnpc "Kaya Toss#jh5_1", getcharid(0);
			close2;
			cutin "",255;
			ep17_2_main = 18;
			completequest 16441;
			setquest 16446;
			questinfo_refresh();
			end;
		case 18:
			npctalk "Rookie : Let's listen to Ridsh.","",bc_self;
			end;
		case 19:
			npctalk "Rookie : Let's listen to the corporate representative.","",bc_self;
			end;
		case 20:
			cutin "16loo_03",2;
			mes "[Rookie]";
			mes "Adventurer, Hey. Mr. Kaya was quite depressed. do you mind checking on Mr. Kaya?";
			next;
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "It's always for something bad to happen at times like this...";
			mes "I'd be reassured if could take a look at the <NAVI>[garden]<INFO>ba_maison,103,92,0,101,0</INFO></NAVI>.";
			close2;
			cutin "",255;
			ep17_2_main = 21;
			completequest 16448;
			setquest 16449;
			questinfo_refresh();
			end;
		case 21:
		case 22:
		case 23:
			npctalk "Rookie : Well, at this point, I'd rather refrain from speaking, right?","",bc_self;
			end;
		default:
			npctalk "Rookie : Well, we made a lot of progress. It's all thanks to your help adventurer.","",bc_self;
			end;
	}
	
OnTouch:
	if(ep17_2_main > 24)
		cloakonnpc strnpcinfo(0), getcharid(0);
end;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 17 && isbegin_quest(16442) == 2 && isbegin_quest(16443) == 2 && isbegin_quest(16444) == 2 && isbegin_quest(16445) == 2 && isbegin_quest(16453) == 2";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 20";
	end;
}

ba_in01,203,103,5	script	Dien#jh5_1	4_F_DIENE,{
	switch(ep17_2_main){
		case 15:
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "If you're looking for a high-quality tea, this mansion is the place you're looking for.";
			mes "The tea that I'm drinking in Einbech is not bad, but it's incomparable from the tea here.";
			close3;
		case 16:
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "Hmm... Hey, gentleman from the government. Why do you keep asking for evidence when you don't believe what we're saying?";
			next;
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "Let's bring a false documents to the mercenaries and ask them to prove every mistakes. We can't say anything about that.";
			next;
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "It's a waste of time.";
			mes "I'd rather find another way, instead of wasting my time doing something contradictory.";
			next;
			cutin "ep16_tes02",2;
			mes "[Tess]";
			mes "... what else could there be, other than to examine the records and write report.";
			mes "Are you saying that you can't believe goverment-made report unconditionally?";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "For a minute, could you listen to me?";
			next;
			mes "[Rookie]";
			mes "The question is, isn't it the credibility of the record itself?";
			mes "No matter how much we use that record with mixed opinions, we won't be able to reach an agreement.";
			next;
			cutin "ep16_tes02",2;
			mes "[Tess]";
			mes "...as a result, this happened.";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "So instead of relying on the government records, why don't we investigate the events that really happened here?";
			next;
			mes "[Rookie]";
			mes "This place is the base of the Mercenaries War, If you investigate it with your own eyes, you might see things you haven't seen before.";
			next;
			cutin "",255;
			select("It's a good idea.");
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Well, who can remember exactly and vividly what occured here?";
			next;
			cutin "",255;
			if(select("The Mansion Manager.:The Cleaning Robots.")){
				cutin "16loo_03",2;
				mes "[Rookie]";
				mes "Adventurer, cleaning robots only response to what people say.";
				mes "Ah, yes. The mansion managers would remember it!";
				next;
			}
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Yes, the Varmdunt Mansion Managers! It's not human, but it probably a more neutral source of data.";
			next;
			cutin "ep162_rds02",2;
			mes "[Ridsh]";
			mes "Lucky, Why aren't you listening to us and taking the government's side?";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "It's a reasonable way. But who will witness it?";
			mes "If I said I would, you wouldn't believe me.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "If the government is asking me to believe the lies they've been building until now, then I can't cooperate with you.";
			next;
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "How would you know if the government really tried to talk to the mercenaries, also how would you know that the mercenaries rejected it. You're just bringing us evidence that none of us have know.";
			next;
			cutin "ep16_tes03",2;
			mes "[Tess]";
			mes "The elders wouldn't even go out to investigate themselves...,";
			mes "Adventurer, you're the only one that the elders will believe.";
			next;
			cutin "",255;
			select("I'll get their permission.");
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "I can believe what the adventurer done so far.";
			mes "Will you listen to the managers for us, adventurer?";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "The existence of the adventurer is very important to both parties and invaluable in this place where various enemy forces are in motion.";
			next;
			cutin "ep16_tes03",2;
			mes "[Tess]";
			mes "Adventurer, please go to the managers of the mansion and find out what happened about the time when the mercenaries stayed here in Varmdunt Mansion.";
			next;
			if(select("Accept.:Refuse.") == 2){
				cutin "ep16_tes02",2;
				mes "[Tess]";
				mes "Are you busy or it's just a bad time?";
				mes "Don't you like what I asked you to do?";
				mes "I can't force you to do it.";
				close3;
			}
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "Thank you, adventurer. It seems you're left with the troublesome work again.";
			mes "I look forward to the truth that is given by a neutral party.";
			close2;
			cutin "",255;
			ep17_2_main = 17;
			completequest 16440;
			setarray .@quest,16441,16442,16443,16444,16445;
			for(.@i = 0; .@i < getarraysize(.@quest); .@i++)
				setquest .@quest[.@i];
			questinfo_refresh();
			end;
		case 17:
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "Thank you, adventurer. It seems you're left with the troublesome work again.";
			mes "I look forward to the truth that is given by a neutral party.";
			close3;
		case 18:
			npctalk "Dien : Would you mind listening to Ridsh's story?","",bc_self;
			end;
		case 19:
			npctalk "Dien : Let's hear what the corporate has to say.","",bc_self;
			end;
		case 20:
		case 21:
		case 22:
		case 23:
			npctalk "Dien : I have nothing to say right now, please excuse me.","",bc_self;
			end;
		default:
			npctalk "Dien : The scent of the tea is nice. Would you like a drink?","",bc_self;
			end;
	}

OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 16";
	end;
}

ba_in01,208,110,3	script	Ridsh#jh5_1	4_F_LEEDSH,{
	switch(ep17_2_main){
		case 15:
		case 16:
		case 17:
			cutin "ep162_rds02",2;
			mes "[Ridsh]";
			mes "I hope you're not thinking that we're stuck.";
			close3;
		case 18:
			cutin "ep162_rds01",2;
			mes "[Ridsh]";
			mes "Is there anything else suspicious about the mercenary?";
			next;
			cutin "",255;
			select("Tell about various suspicious activities.");
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "From the mercenaries' perspective, he was suspicious.";
			mes "However, it seems only a few people knew about it, and they believe each other, so the whole thing was not revealed.";
			next;
			cutin "ep162_rds01",2;
			mes "[Ridsh]";
			mes "That's entirely the mercenary's mistake.";
			mes "I would have known if I had a doubt and poked more into it.";
			emotion ET_SWEAT;
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "If we found out more about 'H. Luckenberg' at that time...";
			mes "The Mercenary War might have ended differently.";
			next;
			cutin "ep16_tes02",2;
			mes "[Tess]";
			mes "I'm glad to know the truth.";
			mes "The government offered an aid, but they were stopped by the companies...";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "I apologize for not listening to your plead.";
			mes "You weren't making false evidence. You just didn't know the truth.";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "I also want to apologize, for not believing your side of the story and forcing the evidence that we have brought.";
			next;
			cloakoffnpc "Kaya Toss#jh5_1", getcharid(0);
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "..........";
			mes "I'm sorry for leaving suddenly.";
			next;
			mes "[Kaya Toss]";
			mes "Something came in to my mind, and I checked it.";
			mes "I'd like to tell you something what I have found out on my side.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "What is it?";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "On the corporate's employee directory... there is someone who has an exact match of H. Luckenberg's activity during that time.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "I see.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "He was recorded as a returning employee from a long business trip during the mercenary war.";
			mes "However, the place he went to was not documented.";
			next;
			mes "[Kaya Toss]";
			mes "My secretary, Grey, searched through an incomplete records and found this note among the remaining work log memos.";
			mes "'As fast as possible (Traces of erased memo) lead them to the mansion'";
			next;
			mes "[Kaya Toss]";
			mes "The subject of the memo is vaguely written but it can be clearly understood.";
			mes "That, he was in Varmdunt Mansion...";
			next;
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "So that's what happened.";
			mes "The government and mercenaries have been played by the companies again.";
			next;
			cutin "ep171_kaya02",2;
			mes "[Kaya Toss]";
			mes "It's a shame...";
			close2;
			cutin "",255;
			ep17_2_main = 19;
			completequest 16446;
			setquest 16447;
			questinfo_refresh();
			end;
		case 19:
			npctalk "Ridsh : The corporate guy wants to say something.","",bc_self;
			end;
		case 20:
		case 21:
		case 22:
		case 23:
			npctalk "Ridsh : I have nothing to say right now.","",bc_self;
			end;
		default:
			npctalk "Ridsh : Would you like some tea? There's a snack here if you want.","",bc_self;
			end;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 18";
	end;
}

ba_in01,204,113,5	script	Cotnes#jh5_1	4_F_COATNEIS,{
	switch(ep17_2_main){
		case 15:
		case 16:
		case 17:
			cutin "ep162_ctn01",2;
			mes "[Cotnes]";
			mes "I don't have the luxury, to listen to your stories.";
			close3;		
		case 18:
			npctalk "Cotnes : It looks like Ridsh has something to say.","",bc_self;
			end;
		case 19:
			npctalk "Cotnes : Hohoho, I think the corporate representative has something to say.","",bc_self;
			end;
		case 20:
		case 21:
		case 22:
		case 23:
			npctalk "Cotnes : Well, I have nothing to say right now.","",bc_self;
			end;
		default:
			npctalk "Cotnes : Everyone here is in high spirit. Hohoho.","",bc_self;
			end;
	}
}

ba_in01,207,102,3	script	Kaya Toss#jh5_1	4_EP17_KAYA,{
	if(ep17_2_main < 19){
		npctalk "Kaya Toss : Please listen to the elders.","",bc_self;
		end;
	}
	if(ep17_2_main == 19){
		cutin "ep171_kaya01",2;
		mes "[Kaya Toss]";
		mes "All contextual, and material evidence evidence leads to the corporate.";
		mes "This is, really, a shame.";
		next;
		cutin "ep171_kaya02",2;
		mes "[Kaya Toss]";
		mes "I am sorry.";
		mes "As the Vice President, I feel responsible for all of this.";
		next;
		cutin "ep162_dn01",2;
		mes "[Dien]";
		mes "Well... Mr. Corporate Representative, what's the difference between you feeling responsible at this point?";
		mes "If you apologized, will it bring the dead back?";
		next;
		cutin "ep171_kaya01",2;
		mes "[Kaya Toss]";
		mes "I will take full responsibility for everything, starting by not forgetting the past.";
		next;
		cutin "ep162_rds03",2;
		mes "[Ridsh]";
		mes "The past? No. It's about what's happening now, the present time. Those Rebellion kids and those who are still sick at Cor are happening now.";
		mes "Everything you say of the past continues to this day.";
		next;
		cutin "ep162_dn03",2;
		mes "[Dien]";
		mes "What are going to do now? You can apologize as much as you want. But it's hard to change people's mind.";
		next;
		cutin "ep162_dn01",2;
		mes "[Dien]";
		mes "Let's stop talking about this now. I don't want to talk to you anymore if you continue to repeat the words of taking responsibility without even saying what you're planning to do.";
		next;
		cutin "ep171_kaya03",2;
		mes "[Kaya Toss]";
		mes "But, Elder........";
		next;
		cutin "ep162_ctn01",2;
		mes "[Cotnes]";
		mes "When you talk proudly like that, it's better not to do it pitifully.";
		mes "Hohoho, Then I'm off too.";
		close2;
		cutin "",255;
		ep17_2_main = 20;
		completequest 16447;
		setquest 16448;
		cloakonnpc "Kaya Toss#jh5_1", getcharid(0);
		npctalk "Kaya Toss : I'll come back after I organize my thoughts for a moment.","",bc_self;
		end;	
	}
	cutin "ep171_kaya01",2;
	mes "[Kaya Toss]";
	mes "Recently, I'm thinking for a lot of things.";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 19";
end;
}

ba_in01,205,109,3	script	Tatio#jh5_1	4_M_TATIO,{
	switch(ep17_2_main){
		case 24:
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "We've got a new visitor after our walk.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "No, Tatio! I've sent you a call through Grey, but I didn't expect you to arrive this soon!";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "From what I heard from Grey, it seemed like an urgent matter.";
			mes "I decided it would be better to visit in person as soon as possible.";
			next;
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "It's important for you to show us what you're going to do.";
			mes "That's a good first step.";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "As you know, Rekenber has already taken a step forward.";
			mes "Hasn't the use of warp magic restriction in your country has been lifted?";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "Yes, that kind of consideration was given by the corporate.";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "Besides that, I intend to do what a corporate must do.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "I've already told you,	now is not a good time to make vague promises.";
			mes "I'm curious about what specific things you can do.";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "I left as soon as I got contact from Vice President Kaya Toss and just arrived.";
			mes "I know what you want hear, but I can't simply decide everything here.";
			next;
			mes "[Tatio]";
			mes "However, I am going to tell you all the promises I can make with my authority.";
			next;
			mes "[Tatio]";
			mes "Vice President Toss, I've seen the reports that you've worked with the government agents and adventurers.";
			mes "Thank you for your hard work.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "Thank you, Tatio.";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "I've seen everything that's happened.";
			mes "Now, I have to make my own move.";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Ah... Are you talking about the secretary?";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "In order to manage the corporate integrity. We will strictly enforce the rules that can prevent these things from happening in the future.";
			next;
			mes "[Tatio]";
			mes "It's hard to tell everything now, but I promise to work with the government and the private sector, rather than the corporate itself.";
			next;
			cutin "ep16_tes02",2;
			mes "[Tess]";
			mes "So, you're planning to tell your secretary's opinion to the president, right?";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "We will also accept Vice President Kaya Toss' opinion and throughly analyze what he has investigated so far, and distribute the compensations and punishment accordingly.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "That's the president's will, right?";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "Yes... of course.";
			next;
			mes "[Tatio]";
			mes "For that purpose, the corporate wants to talk more with the government and the Rebellions.";
			next;
			cutin "ep16_tes01",2;
			mes "[Tess]";
			mes "This is also what the goverment is hoping for.";
			mes "I have a lot to talk about in the future.";
			next;
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "Since you're here and there are delicious tea and snacks, why don't you tell us stories?";
			mes "You came all the way here, you didn't come empty-handed, did you?";
			next;
			cutin "ep15_tatio01",2;
			mes "[Tatio]";
			mes "Let's start right away.";
			mes "This place is good for long conversations.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "The more advanced the story, the more welcome it is.";
			next;
			cutin "16loo_01",2;
			mes "[Rookie]";
			mes "Well, the... Adventurer, I'm sure the representatives here will be having a long conversation.";
			mes "Shall we go outside?";
			next;
			select("I'll listen more.:I'll go outside.");
			cutin "16loo_02",2;
			mes "[Rookie]";
			mes "As you like adventurer, I'll wait outside.";
			mes "You did a great job wandering around the mansion.";
			next;
			mes "[Rookie]";
			mes "Also, it's a small amount but I'll give you some Barmeal Tickets. I got it from the automatic dolls here.";
			mes "It's thank for your hardwork!";
			close2;
			cutin "16loo_02",255;
			cloakonnpc "Rookie#jh5", getcharid(0);
			ep17_2_main = 25;
			completequest 16452;
			getitem 1000103,20;
			questinfo_refresh();
			end;
		default:
			npctalk "Tatio : I will humbly listen to anything.","",bc_self;
			end;
	}
		
OnInit:
	cloakonnpc strnpcinfo(0);
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 24";
	end;
}

ba_maison,189,56,3	script	Yunas#jh5	4_EP17_BASIC_B,{
	if(ep17_2_main == 17){
		cutin "ep172_beta",2;
		mes "[Yunas]";
		mes "Welcome, honored guest, I'm an automatic doll with an identifier called Yunas.";
		mes "Of course, I'm standing here to assist any guests that needs it.";
		next;
		cutin "",255;
		select("I want to ask about past records.");
		cutin "ep172_beta",2;
		mes "[Yunas]";
		mes "What record would you like me to check?";
		next;
		cutin "",255;
		select("Any record of mercenaries is a bell.");
		cutin "ep172_beta",2;
		mes "[Yunas]";
		mes "I'll prepare the record. Please wait a moment.";
		next;
		mes "[Yunas]";
		mes "As the guest requested. I'll deliver random selection of record about mercenaries in the database.";
		next;
		cutin "",255;
		cloakoffnpc "Mercenary#yunas_0", getcharid(0);
		cloakoffnpc "Mercenary#yunas_1", getcharid(0);
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#yunas_0";
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#yunas_1";		
		mes "..................";
		mes "..................";
		next;
		mes "[Mercenary]";
		mes "How did we get here?";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_0");
		next;
		mes "[Mercenary]";
		mes "A mansion... of someone you never knew.";
		mes "I have never been in a mansion like this before.";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_1");
		next;
		mes "[Mercenary]";
		mes "What kind of person is Varmdunt, who accepted us willingly?";
		emotion ET_QUESTION,getnpcid(0,"Mercenary#yunas_0");
		next;
		mes "[Mercenary]";
		mes "Oh, you should've asked who it is.";
		mes "Aren't you the one who saved us when we thought we're all going to die?";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_1");
		next;
		mes "[Mercenary]";
		mes "Yes, we're alive thanks to Mr. Varmdunt and Mr. H";
		mes "If Mr.H hadn't asked us to come here, we'd all be dead by now.";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_0");
		next;
		mes "[Mercenary]";
		mes "Let's regain our strength here and prepare for the fight.";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_1");
		next;
		mes "..................";
		mes "..................";
		cloakonnpc "Mercenary#yunas_0", getcharid(0);
		cloakonnpc "Mercenary#yunas_1", getcharid(0);
		next;
		cutin "ep172_beta",2;
		mes "[Yunas]";
		mes "Do you have any more records you'd want to take a look at?";
		next;
		cutin "",255;
		if(select("I'm curious about the guy named Mr. H.:No more.") == 2){
			cutin "ep172_beta",2;
			mes "[Yunas]";
			mes "Thank you for reading the records!";
			mes "If you need any more records, please do not hesitate to ask.";
			close3;
		}
		cutin "",255;
		cloakoffnpc "Mercenary#yunas_2", getcharid(0);
		cloakoffnpc "Mercenary#yunas_3", getcharid(0);
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#yunas_2";
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#yunas_3";
		mes "..................";
		mes "..................";
		next;
		mes "[Mercenary]";
		mes "... I think I've finally calm down.";
		mes "Everyone was furious.";
		emotion ET_SWEAT,getnpcid(0,"Mercenary#yunas_2");
		next;
		mes "[Mercenary]";
		mes "But it was something that had to be done.";
		mes "People simply died like that, people... There was blood everywhere and their eyes turned over.";
		mes "Now that I think about it, I deeply regret it.";
		emotion ET_KEK,getnpcid(0,"Mercenary#yunas_3");
		next;
		mes "[Mercenary]";
		mes "We used the substitute plan and we took more casualty than we should have.";
		mes "I should have stopped Mr. H.";
		mes "Everyone started yelling and panicking that we had to get rid of them first...";
		emotion ET_SCRATCH,getnpcid(0,"Mercenary#yunas_2");
		next;
		mes "[Mercenary]";
		mes "Neither Mr.H and we are not so bled up back then.";
		mes "Don't blame Mr.H too much.";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_3");
		next;
		mes "[Mercenary]";
		mes "Well, that's true... Let's stop talking about, dwelling on it will just be hard on us.";
		emotion ET_THINK,getnpcid(0,"Mercenary#yunas_2");
		next;
		mes "..................";
		mes "..................";
		cloakonnpc "Mercenary#yunas_2", getcharid(0);
		cloakonnpc "Mercenary#yunas_3", getcharid(0);
		next;
		cutin "ep172_beta",2;
		mes "[Yunas]";
		mes "Do you have any more records you'd want to take a look at?";
		next;
		cutin "",255;
		select("I'm done.");
		cutin "ep172_beta",2;
		mes "[Yunas]";
		mes "Thank you for reading the records!";
		mes "If you need any more records, please do not hesitate to ask.";
		next;
		mes "- I need to remember what I heard carefully. -";
		close2;
		cutin "",255;
		if(isbegin_quest(16442) == 1){
			completequest 16442;
			questinfo_refresh();
		}
		questinfo_refresh();
		setarray .@quest,16442,16443,16444,16445;
		for(.@i = 0; .@i < getarraysize(.@quest); .@i++){
			if(isbegin_quest(.@quest[.@i]) != 2)
				.@miss++;
		}
		if(!.@miss)
			unittalk getcharid(3),strcharinfo(0) + " : I think I've heard enough stories. Should I go back to the teahouse now?",bc_self;
		end;
	}
	cutin "ep172_beta",2;
	mes "[Yunas]";
	mes "Welcome to the Varmdunt Mansion. The Varmundt Mansion provides various benefits such as medical services, shopping and entertainment, and leisure activities...";
	next;
	mes "[Yunas]";
	mes "Uh. Oops. This is not it. I have mistakenly told you the wrong thing.";
	mes "Please disregard it...";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"isbegin_quest(16442) == 1";
	end;
}

ba_maison,187,54,5	duplicate(dummy_cloaked_npc)	Mercenary#yunas_0	1_ETC_01
ba_maison,190,54,3	duplicate(dummy_cloaked_npc)	Mercenary#yunas_1	1_F_MERCHANT_02
ba_maison,187,54,5	duplicate(dummy_cloaked_npc)	Mercenary#yunas_2	1_M_JOBGUIDER
ba_maison,190,54,3	duplicate(dummy_cloaked_npc)	Mercenary#yunas_3	1_M_SMITH


ba_maison,318,169,5	script	Skippy#jh5	4_EP17_BASIC_B,{
	if(ep17_2_main == 17){
		cutin "ep172_beta",2;
		mes "[Skippy]";
		mes "Do you want any records from a guest from the past?";
		mes "Do you have a specific record in mind?";
		next;
		cutin "",255;
		select("Any record of incidents and accidents.");
		cutin "ep172_beta",2;
		mes "[Skippy]";
		mes "Let me check for a moment...";
		mes "Record is randomly selected from the incedent and accident category.";
		next;
		mes "[Skippy]";
		mes "Incident, record 5872, confirmed.";
		mes "I'll play back the records of that time.";
		next;
		cutin "",255;
		cloakoffnpc "Mercenary#skippy_0", getcharid(0);
		cloakoffnpc "Mercenary#skippy_1", getcharid(0);
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#skippy_0";
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#skippy_1";
		mes "..................";
		mes "..................";
		next;
		mes "[Mercenary]";
		mes "A body was found near the wall of the mansion.";
		emotion ET_SURPRISE,getnpcid(0,"Mercenary#skippy_0");
		next;
		mes "[Mercenary]";
		mes "What's that horrible story?";
		mes "Whose body is it?";
		emotion ET_SURPRISE,getnpcid(0,"Mercenary#skippy_1");
		next;
		mes "[Mercenary]";
		mes "Well, no one knows. Even the managers doesn't know.";
		mes "The body was neatly dressed, and doesn't look like a mercenary at all.";
		emotion ET_THINK,getnpcid(0,"Mercenary#skippy_0");
		next;
		mes "[Mercenary]";
		mes "Do you think they're already here?";
		mes "But the corporate people aren't going to dress up and visit us.";
		emotion ET_QUESTION,getnpcid(0,"Mercenary#skippy_1");
		next;
		mes "[Mercenary]";
		mes "I know, it's just an apparition that's grumbling,";
		mes "I hope it's not a big deal...";
		emotion ET_THINK,getnpcid(0,"Mercenary#skippy_0");
		next;
		mes "..................";
		mes "..................";
		cloakonnpc "Mercenary#skippy_0", getcharid(0);
		cloakonnpc "Mercenary#skippy_1", getcharid(0);
		next;
		cutin "ep172_beta",2;
		mes "[Skippy]";
		mes "The record playback has finished.";
		mes "Do you need any information about other records?";
		next;
		cutin "",255;
		select("I need more information about the body.");
		cutin "ep172_beta",2;
		mes "[Skippy]";
		mes "Please wait a moment, gender is female, name is unidentified and she was wearing a gray suit, but very disheveled with blood.";
		mes "The cause of death was an attack from behind... then...";
		next;
		mes "- I received a records of an unknown body. -";
		close2;
		cutin "",255;
		if(isbegin_quest(16443) == 1){
			completequest 16443;
			questinfo_refresh();
		}
		setarray .@quest,16442,16443,16444,16445;
		for(.@i = 0; .@i < getarraysize(.@quest); .@i++){
			if(isbegin_quest(.@quest[.@i]) != 2)
				.@miss++;
		}
		if(!.@miss)
			unittalk getcharid(3),strcharinfo(0) + " : I think I've heard enough stories. Should I go back to the teahouse now?",bc_self;
		end;
	}
	cutin "ep172_beta",2;
	mes "[Skippy]";
	mes "Hello, there. Do you need a record of the past guests?";
	mes "The guest list is recorded in a huge database.";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"isbegin_quest(16443) == 1";
	end;
}

ba_maison,321,168,3	duplicate(dummy_cloaked_npc)	Mercenary#skippy_0	1_M_02
ba_maison,322,165,3	duplicate(dummy_cloaked_npc)	Mercenary#skippy_1	1_F_04

ba_maison,249,161,3	script	Adore#jh5	4_EP17_BASIC_B,{
	if(ep17_2_main == 17){
		cutin "ep172_beta",2;
		mes "[Adore]";
		mes "Hello, guest. Can I help you?";
		next;
		cutin "",255;
		select("Records about the mercenaries in the past.");
		cutin "ep172_beta",2;
		mes "[Adore]";
		mes "There's a lot of record about past guests, what kind of records do you need?";
		next;
		cutin "",255;
		select("About a mercenary named H.");
		cutin "ep172_beta",2;
		mes "[Adore]";
		mes "Searching, searching... Search complete. There are a very few records about Mr. H...";
		mes "However, there are many records of what others said about Mr. H.";
		next;
		mes "[Adore]";
		mes "If you want to read about the record, I will prepare it for you.";
		next;
		cutin "",255;
		cloakoffnpc "Mercenary#adore_0", getcharid(0);
		cloakoffnpc "Mercenary#adore_1", getcharid(0);
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#adore_0";
		specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#adore_1";
		mes "..................";
		mes "..................";
		next;
		mes "[Mercenary]";
		mes "By the way, where's Mr. H?";
		mes "I've been looking for him for a while, but...";
		emotion ET_QUESTION,getnpcid(0,"Mercenary#adore_0");
		next;
		mes "[Mercenary]";
		mes "It seems his away often.";
		mes "I have to talk to him someday. What if the corporates suddenly comes in.";
		emotion ET_THINK,getnpcid(0,"Mercenary#adore_1");
		next;
		mes "[Mercenary]";
		mes "Not long ago, I saw Mr. H talking with someone I don't know.";
		emotion ET_THINK,getnpcid(0,"Mercenary#adore_0");
		next;
		mes "[Mercenary]";
		mes "A person you don't know, where would you find a person a random person here?";
		emotion ET_QUESTION,getnpcid(0,"Mercenary#adore_1");
		next;
		mes "[Mercenary]";
		mes "That's why it's weird. He was also thoroughly checking the perimeter, but I'm good at hiding.";
		emotion ET_THINK,getnpcid(0,"Mercenary#adore_0");
		next;
		mes "[Mercenary]";
		mes "What did they talk about?";
		emotion ET_THINK,getnpcid(0,"Mercenary#adore_1");
		next;
		mes "[Mercenary]";
		mes "I didn't hear it because it was too far.";
		emotion ET_THINK,getnpcid(0,"Mercenary#adore_0");
		next;
		mes "[Mercenary]";
		mes "You didn't hide well, you were just far away!";
		mes "Anyway, that's really suspicious. What the hell is going on?";
		mes "..................";
		mes "..................";
		emotion ET_SWEAT,getnpcid(0,"Mercenary#adore_1");
		next;
		cloakonnpc "Mercenary#adore_0", getcharid(0);
		cloakonnpc "Mercenary#adore_1", getcharid(0);
		cutin "ep172_beta",2;
		mes "[Adore]";
		mes "Record out is complete.";
		mes "Do you need more information about H.?";
		next;
		cutin "",255;
		select("H's conversation with the stranger.");
		cutin "ep172_beta",2;
		mes "[Adore]";
		mes "Searching... no results found. We don't have any record of that information.";
		mes "This record was recorded by a cleaning robot and the manager without ears.";
		next;
		cutin "",255;
		select("The place where the conversation was recorded.");
		cutin "ep172_beta",2;
		mes "[Adore]";
		mes "Searching... Through the records of the cleaning robot, I can guide you to the last recognized location at that record.";
		mes "I will give you the coordinate. Please follow this <NAVI>[guide]<INFO>ba_maison,357,291,0,101,0</INFO></NAVI>.";
		close2;
		cutin "",255;
		if(isbegin_quest(16444) == 1){
			completequest 16444;
			setquest 16453;
			questinfo_refresh();
		}
		setarray .@quest,16442,16443,16444,16445;
		for(.@i = 0; .@i < getarraysize(.@quest); .@i++){
			if(isbegin_quest(.@quest[.@i]) != 2)
				.@miss++;
		}
		if(!.@miss)
			unittalk getcharid(3),strcharinfo(0) + " : I think I've heard enough stories. Should I go back to the teahouse now?",bc_self;
		end;
	}
	cutin "ep172_beta",2;
	mes "[Adore]";
	mes "Hello, there. How can I help you?";
	mes "I am really glad to assist any guest.";
	next;
	mes "[Adore]";
	mes "You should do anything to please me!";
	mes "Yes, I am created that way.";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"isbegin_quest(16444) == 1";
	end;
}

ba_maison,357,291,3	script	#jh5_1	4_EP17_CLEANER_W,{
	if(isbegin_quest(16453) == 1){
		cutin "ep172_omega",2;
		mes "- A little away from the reception area, a cleaning robot lies discharged in the shadow. It seems like it's been here for a very long time. -";
		next;
		mes "- I turned it upside down and it's stopped because of a little paper envelope stucked in it. -";
		next;
		mes "- Is this a Rekenber's pattern on the envelope? Why are these things here?";
		next;
		mes "- Carefully, I took out the envelope to not tear it. -";
		close2;
		cutin "",255;
		completequest 16453;
		questinfo_refresh();
		end;
	}
	cutin "ep172_omega",2;
	mes "- ......? -";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"isbegin_quest(16453) == 1";
	end;
}

ba_maison,246,158,5	duplicate(dummy_cloaked_npc)	Mercenary#adore_0	1_M_02
ba_maison,249,158,3	duplicate(dummy_cloaked_npc)	Mercenary#adore_1	1_M_ORIENT01

ba_maison,232,310,5	script	Nono#jh5	4_EP17_BASIC_B,{
	if(ep17_2_main == 17){
		mes "- Do you remember any of the guests' conversations? -";
		next;
		cutin "ep172_beta",2;
		mes "[Nono]";
		mes "You mean the old guests?";
		mes "Of course I remember everything!";
		mes "What story would you like to hear? I'll tell you all about it!";
		next;
		mes "[Nono]";
		mes "I have searched the database for past guests' conversations, the records are selected randomly!";
		mes "Here are the following results!";
		cutin "",255;
		next;
		.@s = select("Someone's Travel.:Traces of Discovery.:Goverment Criticism.");
		cutin "ep172_beta",2;
		mes "[Nono]";
		mes "I'll play the record!";
		next;
		cutin "",255;
		mes "..................";
		mes "..................";
		switch(.@s){
			case 1:
				cloakoffnpc "Mercenary#nono_0", getcharid(0);
				cloakoffnpc "Mercenary#nono_1", getcharid(0);
				specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#nono_0";
				specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#nono_1";
				next;
				mes "[Mercenary]";
				mes "There is a mercenary who was almost thrown out while trying to go deep into the mansion. Who is it?";
				emotion ET_QUESTION,getnpcid(0,"Mercenary#nono_0");
				next;
				mes "[Mercenary]";
				mes "I think it was Mr. H. Why would he do such a thing.";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_1");
				next;				
				mes "[Mercenary]";
				mes "Yeah. The supply that was provided to us are enough to get by already.";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_0");
				next;
				mes "[Mercenary]";
				mes "Did H. needed more Barmeal Tickets?";
				mes "Even if he didn't need it, I would still have shared it to him if he asked.";
				emotion ET_QUESTION,getnpcid(0,"Mercenary#nono_1");		
				next;
				mes "[Mercenary]";
				mes "I'm suspicious of Mr. H. Don't you think he's only doing that stands out?";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_0");				
				next;
				mes "[Mercenary]";
				mes "Come on, don't say that. We should trust each other.";
				emotion ET_BLABLA,getnpcid(0,"Mercenary#nono_1");
				close2;
				cloakonnpc "Mercenary#nono_0", getcharid(0);
				cloakonnpc "Mercenary#nono_1", getcharid(0);
				break;
						
			case 2:
				cloakoffnpc "Mercenary#nono_2", getcharid(0);
				cloakoffnpc "Mercenary#nono_3", getcharid(0);
				specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#nono_2";
				specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#nono_3";
				next;
				mes "[Mercenary]";
				mes "Another suspicious trace was found near the mansion.";
				mes "This time, someone said it's the trace of a fierce battle, but none of us got hurt or went missing.";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_2");
				next;
				mes "[Mercenary]";
				mes "I've heard it too. It must have been those corporate guys! We musn't stay here and clean up out there.";
				emotion ET_ANGER,getnpcid(0,"Mercenary#nono_3");
				next;
				mes "[Mercenary]";
				mes "Calm down. You don't even know what happened, do you?";
				mes "No one was hurt but they found a lot of blood stains. The leaders are still investigating it.";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_2");
				next;
				mes "[Mercenary]";
				mes "How can we not know anything when there is a lot of mess happening out there. I'm so frustrating, very frustrating!!";
				emotion ET_STARE,getnpcid(0,"Mercenary#nono_3");				
				close2;
				cloakonnpc "Mercenary#nono_2", getcharid(0);
				cloakonnpc "Mercenary#nono_3", getcharid(0);
				break;				
				
			case 3:
				cloakoffnpc "Mercenary#nono_4", getcharid(0);
				cloakoffnpc "Mercenary#nono_5", getcharid(0);
				specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#nono_4";
				specialeffect EF_BLUELIGHTBODY,AREA,"Mercenary#nono_5";
				next;
				mes "[Mercenary]";
				mes "I thought that the goverment will mediate in the case of an incident, but it's as if we didn't exist in the goverment's eyes.";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_4");
				next;
				mes "[Mercenary]";
				mes "There's no movement at all, let alone mediation.";
				mes "Are we not citizens? How could they do this!";
				emotion ET_ANGER,getnpcid(0,"Mercenary#nono_5");
				next;
				mes "[Mercenary]";
				mes "There's been a lot of bloodshed, and such big commotions.";
				mes "If the government doesn't come forward at times like this, someone has to step up and advance the government forward.";
				emotion ET_SURPRISE,getnpcid(0,"Mercenary#nono_4");
				next;
				mes "[Mercenary]";
				mes "But no one's stepping up. The government is not like a real government, it's not moving forward at all.";
				emotion ET_THINK,getnpcid(0,"Mercenary#nono_5");
				close2;
				cloakonnpc "Mercenary#nono_4", getcharid(0);
				cloakonnpc "Mercenary#nono_5", getcharid(0);
				break;
		}
		if(isbegin_quest(16445) == 1){
			completequest 16445;
			questinfo_refresh();
		}
		setarray .@quest,16442,16443,16444,16445;
		for(.@i = 0; .@i < getarraysize(.@quest); .@i++){
			if(isbegin_quest(.@quest[.@i]) != 2)
				.@miss++;
		}
		if(!.@miss)
			unittalk getcharid(3),strcharinfo(0) + " : I think I've heard enough stories. Should I go back to the teahouse now?",bc_self;
		end;
	}
	cutin "ep172_beta",2;
	mes "[Nono]";
	mes "My name is Nono, and I want to fly high in the sky.";
	mes "I was named Nono because I want to be called that way.";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"isbegin_quest(16445) == 1";
	end;
}

ba_maison,234,307,5	duplicate(dummy_cloaked_npc)	Mercenary#nono_0	4_M_ORIENT02
ba_maison,237,307,3	duplicate(dummy_cloaked_npc)	Mercenary#nono_1	4_F_01
ba_maison,234,307,5	duplicate(dummy_cloaked_npc)	Mercenary#nono_2	1_F_MERCHANT_02
ba_maison,237,307,3	duplicate(dummy_cloaked_npc)	Mercenary#nono_3	1_M_02
ba_maison,234,307,5	duplicate(dummy_cloaked_npc)	Mercenary#nono_4	1_M_INNKEEPER
ba_maison,237,307,3	duplicate(dummy_cloaked_npc)	Mercenary#nono_5	2_F_MAGICMASTER

ba_maison,103,92,3	script	Kaya Toss#ep172_bamaison-00	4_EP17_KAYA,{
	switch(ep17_2_main){
		case 21:
			cloakoffnpc "Assassin#ep172_bamaison-00", getcharid(0);
			mes "[???]";
			mes "To think you're really going to take out the liver and gallbladder for everyone.";
			mes "The corporate is ashamed of you.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "?!?";
			next;
			cutin "ep171_kaya03",2;
			mes "[Kaya Toss]";
			mes "Who are you. Why are you hiding in a place like this?";
			next;
			cutin "",255;
			mes "[???]";
			mes "Vice President, I'm with the Rekenber's Board. ...... You don't need to know my identity.";
			next;
			cutin "ep171_kaya03",2;
			mes "[Kaya Toss]";
			mes "You rude...! This is not a place for anyone to come and go. Why did you sneak and look for me?";
			next;
			cutin "",255;
			mes "[???]";
			mes "The corporate is worried about the Vice President's action. How long are you going to be swayed by their eloquence? What would you do if a representative of the corporate repeatedly acts againt the interest of the corporate?";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "Act against the corporate's interest? I'm always working for the benefit of the corporate.";
			next;
			cutin "",255;
			mes "[???]";
			mes "Let's pick one. Excessive promise of compensation for an accident, overestimation of corporate responsibility.";
			mes "You're hurting not only the corporate's finances but also its reputation.";
			next;
			mes "[???]";
			mes "Why would the corporate compensate for an accident caused by the Illusions?";
			mes "Rather, it should be the corporate that should receive compensation.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "Is there a problem when I promised the welfare benefits of the corporate to those who we hired and working under the name of the corporate?";
			next;
			cutin "",255;
			mes "[???]";
			mes "You're giving too much benefits.";
			mes "At this rate, more and more people will want to extort money from the corporate for various reasons.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "I don't think all of that is too much.";
			mes "I'm just doing what we have to do.";
			next;
			cutin "",255;
			mes "[???]";
			mes "Phew...... If I had been through with you, I wouldn't have come. That's it. I didn't come here to have a conversation anyway.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "What do you mean?";
			next;
			cutin "",255;
			mes "[???]";
			mes "A conversation is meaningless. It's time for you to disappear from this place!";
			next;
			select("It's dangerous!");
			cloakoffnpc "Dien#ep172_bamaison-00", getcharid(0);
			cutin "ep162_dn03",2;
			mes "[Dien]";
			mes "It's dangerous!";
			emotion ET_SURPRISE,getnpcid(0,"Dien#ep172_bamaison-00");
			next;
			cloakoffnpc "Ridsh#ep172_bamaison-00", getcharid(0);
			cutin "ep162_rds02",2;
			mes "[Ridsh]";
			mes "I've come here to see what's wrong, and looks like a rat appeared.";
			emotion ET_SURPRISE,getnpcid(0,"Ridsh#ep172_bamaison-00");
			next;
			cloakoffnpc "Cotnes#ep172_bamaison-00", getcharid(0);
			cutin "ep162_ctn02",2;
			mes "[Cotnes]";
			mes "Who are you! I'm not going to let you go!";
			emotion ET_SURPRISE,getnpcid(0,"Cotnes#ep172_bamaison-00");
			next;
			cutin "",255;
			mes "[???]";
			mes "Shit, am I caught by these uselessly sharp old people?!";
			next;
			cloakonnpc "Assassin#ep172_bamaison-00", getcharid(0);
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "Do, thank you for your help, Elders. It's... It's a job I've devoted my while life to. And the corporate sent an assassin to kill me.";
			next;
			mes "[Kaya Toss]";
			mes "I won't lose though.";
			mes "The only path for the corporate is clearing the past and improving the present.";
			close2;
			cutin "",255;
			ep17_2_main = 22;
			completequest 16449;
			setquest 16450;
			questinfo_refresh();
			end;
		case 22:
			cloakoffnpc "Dien#ep172_bamaison-00", getcharid(0);
			cloakoffnpc "Ridsh#ep172_bamaison-00", getcharid(0);
			cloakoffnpc "Cotnes#ep172_bamaison-00", getcharid(0);
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "I won't lose though.";
			mes "The only path for the corporate is clearing the past and improving the present.";
			close3;
		case 23:
			cloakoffnpc "Dien#ep172_bamaison-00", getcharid(0);
			cloakoffnpc "Ridsh#ep172_bamaison-00", getcharid(0);
			cloakoffnpc "Cotnes#ep172_bamaison-00", getcharid(0);
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "Understood. I'm going to contact the company and ask for an important person to talk more deeply with the government and the Rebellions.";
			next;
			mes "[Kaya Toss]";
			mes "We should investigate this incident properly and catch the culprit.";
			mes "Thank you again for your cooperation.";
			next;
			cutin "ep162_dn01",2;
			mes "[Dien]";
			mes "You must have been very surprised, but I gave my thanks to you for proceeding quickly.";
			next;
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "Then let's return to the tea house. I also want to calm down a little.";
			mes "Elders, will you come with me?";
			next;
			cutin "ep162_dn02",2;
			mes "[Dien]";
			mes "I'd be happy to escort you.";
			next;	
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "I'd be grateful if you would come with us too, adventurer.";
			mes "Let's have a tea together, while waiting for the important person to come.";
			close2;
			cutin "",255;
			cloakonnpc "Dien#ep172_bamaison-00", getcharid(0);
			cloakonnpc "Ridsh#ep172_bamaison-00", getcharid(0);
			cloakonnpc "Cotnes#ep172_bamaison-00", getcharid(0);
			ep17_2_main = 24;
			completequest 16451;
			setquest 16452;
			getitem 1000103,15;
			questinfo_refresh();
			end;
		default:
			cutin "ep171_kaya01",2;
			mes "[Kaya Toss]";
			mes "I'm here to think for a moment.";
			close3;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 21";
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 23";
	end;
}

ba_maison,100,90,7	script	Dien#ep172_bamaison-00	4_F_DIENE,{
	if(ep17_2_main == 22){
		cutin "ep162_dn01",2;
		mes "[Dien]";
		mes "I've heard your opinions.";
		mes "Well... I now understand that the word you said about taking responsibility wasn't gilded in front of us.";
		next;
		mes "[Dien]";
		mes "However, there is no reason to believe that you can apologize for everything that the corporates have done.";
		mes "Just trust yourself a little bit more, I just thought I'd watch what you'll do from now.";
		next;
		cutin "ep162_dn03",2;
		mes "[Dien]";
		mes "Do not forget. Even if we disappear someday, the younger generations, new rebellions, countless innocent people who have been affected by the wrong doings of the corporates and those who are not, are all watching the corporates' actions.";
		next;
		mes "[Dien]";
		mes "If you're already decided, I would like talk with the representative more clearly.";
		mes "Also, in order for us to do the job correctly, it would be better to accompany not only us, but also the people of the president.";
		next;
		cutin "ep162_dn02",2;
		mes "[Dien]";
		mes "For starter, show us what you can do with your first step.";
		close2;
		cutin "",255;
		ep17_2_main = 23;
		completequest 16450;
		setquest 16451;
		questinfo_refresh();
		end;
	}
	end;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 22";
	cloakonnpc strnpcinfo(0);
	end;
}

ba_maison,105,95,3	script	Ridsh#ep172_bamaison-00	4_F_LEEDSH,{
	npctalk "Ridsh : Tell the president to come out!","",bc_self;
	end;
	
OnInit:
	cloakonnpc strnpcinfo(0);
	end;
}
ba_maison,105,90,1	script	Cotnes#ep172_bamaison-00	4_F_COATNEIS,{
	npctalk "Ridsh : Are you fine, Mr. Kaya?","",bc_self;
	end;
	
OnInit:
	cloakonnpc strnpcinfo(0);
	end;	
}

ba_maison,100,95,5	duplicate(dummy_cloaked_npc)	Assassin#ep172_bamaison-00	4_M_MASKMAN

//Eradicating the Intruders
ba_maison,106,65,0	script	#ep172_maison_ev-00	HIDDEN_WARP_NPC,3,3,{
	end;
	
OnTouch:
	if(ep17_2_main == 25){
		cloakoffnpc "Rookie#ep172_bamaison-00", getcharid(0);
		cloakoffnpc "Manager#ep172_bamaison-00", getcharid(0);
	}
	end;
}
ba_maison,116,67,5	script	Rookie#ep172_bamaison-00	4_M_ROOKIE,{
	switch(ep17_2_main){
		case 25:
			sleep2 1000;
			npctalk "I'm looking forward to your kind cooperation.","Manager#ep172_bamaison-00",bc_self;
			sleep2 1500;
			cloakonnpc "Manager#ep172_bamaison-00", getcharid(0);
			select("What's wrong?");
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "It's about the intruder in the mansion.";
			mes "There's another mansion manager who's been damaged by the heart hunters.";
			next;
			mes "[Rookie]";
			mes "This time again, the communication was interrupted first, the managers must have been attacked before the security officers noticed it.";
			next;
			cutin "16loo_03",0;
			mes "[Rookie]";
			mes "Alpha said that they can fix anything that's broken, but there's a bigger problem...";
			next;
			mes "[Rookie]";
			mes "The hacked automatic doll is immediately cut off from the network to prevent contamination, assuming that Alpha has a strong signal.";
			next;
			mes "[Rookie]";
			mes "Even the identification code is broken.";
			mes "Alpha said that we will have to use force to automatic dolls like that.";
			next;
			mes "[Rookie]";
			mes "If there's an automatic doll attacking us, we'll take it out of course.";
			mes "Alpha asked me to bring it's 'Core'.";
			next;
			select("Core?");
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "It's the one on their chests. I guess it's the only way to fix the automatic dolls.";
			mes "I'll be glad if we can recover the cores...";
			next;
			mes "[Rookie]";
			mes "When on earth will those people arrive?";
			mes "I'm a bit frustrated because I couldn't find a single Illusion's member.";
			next;
			mes "[Rookie]";
			mes "I can't find where they're hiding during daytime......,";
			mes "I think they're working after the sun goes down, but they're in trouble in many ways.";
			next;
			mes "[Rookie]";
			mes "Anyway, Alpha said, we have to deal with the automatic robots who are not able to distinguish identification code and recover the cores.";
			mes "Would you like to come with me?";
			next;
			cloakoffnpc "Elyumina#ep172_bamaison-00", getcharid(0);
			cloakoffnpc "Rebellion#ep172_bamaison-00", getcharid(0);
			sleep2 200;
			npctalk "Rookie, where are you!! You're here!!","Elyumina#ep172_bamaison-00",bc_self;
			sleep2 1500;
			npctalk "Surprise!","",bc_self;
			cutin "ep171_elyumina02",2;
			mes "[Elyumina]";
			mes "Those guys are really crazy! Why the hell are you doing this to me? Traitor? You traitor?";
			mes "Do you think it is right for enemies to call you a traitor?";
			next;
			cutin "16loo_03",0;
			mes "[Rookie]";
			mes "Um... Mina? Can you talk to people without biting them?";
			mes "I don't understand what you're saying? Did you just speak a human language just now?";
			next;
			cutin "ep171_elyumina02",2;
			mes "[Elyumina]";
			mes "Ha-! Is that it?";
			mes "Hey, why do you keep leaving me alone?";
			mes "Don't leave me alone, even if I'm mean and sarcastic! Please, do you understand?";
			next;
			cutin "",255;
			select("What happened?");
			mes "[Rebellion]";
			mes "The manager who brought the meal suddenly changed and attack Elyumina.";
			mes "Fortunately, I was on the guest list, and the manager reverted to it's normal state right away,";
			next;
			mes "[Rebellion]";
			mes "The manager used the tray that it was carrying to struck Elyumina in the head. So strong, that it made a loud sound.";
			npctalk "I thought you saw the lettuce flying to you.","Rebellion#ep172_bamaison-00",bc_self;
			next;
			cutin "16loo_02",0;
			mes "[Rookie]";
			mes "I've heard a similar story from Alpha, and I would never thought it was you.";
			mes "If you told me as soon as the incident happened, that would've been great.";
			mes "Well, are you all right?";
			next;
			cutin "ep171_elyumina02",2;
			mes "[Elyumina]";
			mes "Great? Did you experience it? That wasn't even the end! You heartless bastard!";
			mes "There's also the manager who was sweeping the garden, and suddenly attacked me!";
			mes "It kept saying 'kill the traitor'!";
			npctalk "You bastard, what about my safety!","Elyumina#ep172_bamaison-00",bc_self;
			next;
			cutin "16loo_02",0;
			mes "[Rookie]";
			mes "Aha ha ha... don't get too excited, anyway.";
			mes "I was just about to check it, look here, the adventurer here is going with me.";
			next;
			mes "[Rookie]";
			mes "We're going to retrieve the cores of the hacked managers that Alpha talked about.";
			mes "Why don't you just go back and stay with the other Rebellions?";
			npctalk "I always have something to do!","Rebellion#ep172_bamaison-00",bc_self;
			next;
			cutin "ep171_elyumina03",2;
			mes "[Elyumina]";
			mes "You, I'll return now.";
			mes "Never come empty-handed you hear!";
			mes "I need to find a safe place!";
			next;
			cloakonnpc "Elyumina#ep172_bamaison-00", getcharid(0);
			cloakonnpc "Rebellion#ep172_bamaison-00", getcharid(0);
			cutin "16loo_02",0;
			mes "[Rookie]";
			mes "I can't help it. I'm worried about Elyumina's safety.";
			mes "I'm also worried about the managers who lost their identification code that Alpha mentioned.";
			next;
			mes "[Rookie]";
			mes "Shall we retrieve the cores first? If you found a 'Broken Manager', retrieve it's core.";
			next;
			mes "[Rookie]";
			mes "I'm going to look up on the northern area, you can look at the southern area.";
			next;
			mes "[Rookie]";
			mes "Let's meet up  at the lake on the eastern end of the road and wrap it up.";
			mes "Then, I'll get going first.";
			ep17_2_main = 26;
			setquest 18002;
			close2;
			cutin "",255;
			cloakonnpc strnpcinfo(0), getcharid(0);
			end;
	}
	end;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 25";
	cloakonnpc strnpcinfo(0);
end;	
}

ba_maison,118,68,3	duplicate(dummy_cloaked_npc)	Manager#ep172_bamaison-00	4_EP17_MASTER_A
ba_maison,120,67,3	duplicate(dummy_cloaked_npc)	Elyumina#ep172_bamaison-00	4_EP17_ELYUMINA
ba_maison,122,66,1	duplicate(dummy_cloaked_npc)	Rebellion#ep172_bamaison-00	4_M_REBELLION3

ba_maison,150,47,0	script	#ep172_hole-0	CLEAR_NPC,{
	.@id = atoi(replacestr(strnpcinfo(2),"ep172_hole-",""));
	.@quest = 18003 + .@id;
	if(ep17_2_main == 26 && isbegin_quest(.@quest) == 0){
		cloakonnpc(strnpcinfo(0), getcharid(0));
		cloakoffnpc "#ep172_beta-" + .@id, getcharid(0);
		mes "The body of Manager Beta is hidden under the landscapes.";
		next;
		mes "I've recovered the core.";
		mes "I'll let Alpha know later so she can retrieve the doll's body.";
		setquest .@quest;
		completequest .@quest;
		getitem 1000226,1;
		questinfo_refresh();
		.@count = countitem(1000226);
		if(.@count < 5){
			mes "Let's look for more.";
		} else {
			mes "I've recovered enough cores.";
			completequest 18002;
			setquest 18013;
		}
		questinfo_refresh();
	}
	end;
	
OnInit:
	.@id = atoi(replacestr(strnpcinfo(2),"ep172_hole-",""));
	.@quest = 18003 + .@id;
	questinfo QTYPE_CLICKME,QMARK_YELLOW,"ep17_2_main == 26 && isbegin_quest(" + .@quest + ") == 0 && countitem(1000226) < 5";
end;
}

ba_maison,208,87,0	duplicate(#ep172_hole-0)	#ep172_hole-1	CLEAR_NPC
ba_maison,221,193,0	duplicate(#ep172_hole-0)	#ep172_hole-2	CLEAR_NPC
ba_maison,314,146,0	duplicate(#ep172_hole-0)	#ep172_hole-3	CLEAR_NPC
ba_maison,338,267,0	duplicate(#ep172_hole-0)	#ep172_hole-4	CLEAR_NPC
ba_maison,275,313,0	duplicate(#ep172_hole-0)	#ep172_hole-5	CLEAR_NPC
ba_maison,207,276,0	duplicate(#ep172_hole-0)	#ep172_hole-6	CLEAR_NPC
ba_maison,131,197,0	duplicate(#ep172_hole-0)	#ep172_hole-7	CLEAR_NPC
ba_maison,64,187,0	duplicate(#ep172_hole-0)	#ep172_hole-8	CLEAR_NPC
ba_maison,70,256,0	duplicate(#ep172_hole-0)	#ep172_hole-9	CLEAR_NPC
ba_maison,150,47,3	duplicate(dummy_cloaked_npc)	#ep172_beta-0	4_EP17_BROKENBETA
ba_maison,208,87,3	duplicate(dummy_cloaked_npc)	#ep172_beta-1	4_EP17_BROKENBETA
ba_maison,221,193,3	duplicate(dummy_cloaked_npc)	#ep172_beta-2	4_EP17_BROKENBETA
ba_maison,314,146,3	duplicate(dummy_cloaked_npc)	#ep172_beta-3	4_EP17_BROKENBETA
ba_maison,338,267,3	duplicate(dummy_cloaked_npc)	#ep172_beta-4	4_EP17_BROKENBETA
ba_maison,275,313,3	duplicate(dummy_cloaked_npc)	#ep172_beta-5	4_EP17_BROKENBETA
ba_maison,207,276,3	duplicate(dummy_cloaked_npc)	#ep172_beta-6	4_EP17_BROKENBETA
ba_maison,131,197,3	duplicate(dummy_cloaked_npc)	#ep172_beta-7	4_EP17_BROKENBETA
ba_maison,64,187,3	duplicate(dummy_cloaked_npc)	#ep172_beta-8	4_EP17_BROKENBETA
ba_maison,70,256,3	duplicate(dummy_cloaked_npc)	#ep172_beta-9	4_EP17_BROKENBETA

ba_maison,303,141,3	script	Elena Bolkova#ep172_eln01	4_F_ELENA,{
	switch(ep17_2_main){
		case 26:
			if(isbegin_quest(18013) == 1){
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "Hey, adventurer, this way. Did you get any results?";
				next;
				select("Why, Elena?");
				cutin "162elena_02",2;
				mes "[Elena Bolkova]";
				mes "Rookie asked me a favor.";
				mes "Elyumina seems to have been attacked again.";
				mes "I just happen to be nearby at the time and somehow pull her out from that predicament.";
				next;
				select("Show her the cores.");
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "Did you found anything unusual?";
				mes "I've already searched a lot of places in the mansion, and all of it were empty.";
				next;
				mes "[Elena Bolkova]";
				mes "What, so did you?";
				mes "How do these guys avoid our eyes and keep making trouble?";
				mes "It's very annoying.";
				close2;
				sleep2 1000;
				cutin "",255;
				setpcblock PCBLOCK_ALL,true;
				cloakoffnpc "Eisen Werner#ep172_bamaison-00", getcharid(0);
				specialeffect EF_BEGINSPELL,AREA,"Eisen Werner#ep172_bamaison-00";
				npctalk "...Where... is the coordinate setting wrong? What's this place?","Eisen Werner#ep172_bamaison-00",bc_self;
				sleep2 1200;
				specialeffect EF_POTION4;
				npctalk "Oh? Who's this?!","",bc_self;
				sleep2 350;
				specialeffect EF_PIERCE,AREA,"Eisen Werner#ep172_bamaison-00";
				sleep2 350;
				cutin "ep16_eisen03",0;
				mes "[Eisen]";
				mes "What is this!!!!";
				next;
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "Hey, suspicious guy, you're that guy, right?";
				mes "You look exactly like guy that I missed at the lab last time.";
				specialeffect EF_TRACKCASTING,AREA,"Eisen Werner#ep172_bamaison-00";
				next;
				mes "[Elena Bolkova]";
				mes "I'm very lucky. How did a big fish like you ended up here?";
				next;
				cutin "ep16_eisen01",0;
				mes "[Eisen]";
				mes "What, the mercenaries really became the dogs of the republic aren't they?";
				mes "You already destroyed my lab. What else do I need to do?";
				next;
				mes "[Eisen]";
				mes "I don't have anything to say to you, so just let me go.";
				next;
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "Stop opening your filthy mouth.";
				mes "Ha, My personality has already died a long time ago.";
				mes "Uh, take this guy as prisoner, uh and keep him alive.";
				specialeffect EF_TRACKING,AREA,"Eisen Werner#ep172_bamaison-00";
				npctalk "Ugh...","","Eisen Werner#ep172_bamaison-00";
				next;
				cutin "ep16_eisen01",0;
				mes "[Eisen]";
				mes "What do you want from me?";
				mes "Seyren failed because of that adventurer.";
				mes "Was he a hopeless failure too?";
				next;
				select("Is it right to talk about experiments in this situation?");
				mes "[Eisen]";
				mes "What's left if you take the research and the experiments out of me?";
				mes "Stop asking the obvious.";
				mes "All right. I won't fall for your provocation. Instead I'll ask you one thing.";
				mes "If you answer me, I am willing to cooperate with you in response.";
				next;
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "You're not in the position to negotiate, are you?";
				specialeffect EF_TRACKING,AREA,"Eisen Werner#ep172_bamaison-00";
				npctalk "Damn it!","Eisen Werner#ep172_bamaison-00",bc_self;
				next;
				cutin "ep16_eisen01",0;
				mes "[Eisen]";
				mes "Damn it! I won't run away, so stop!";
				mes "Where did the guys from Cor go?";
				next;
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "(This guy, why would he be curious about that? It looks like he came here to join his colleagues late... Wouldn't we know where the others are if we successfully talk it out?)";
				next;
				cutin "ep16_eisen01",0;
				mes "[Eisen]";
				mes "Why are you being so quiet? Did you already disposed them?";
				next;
				select("She is currently held captive.");
				mes "[Eisen]";
				mes "Really? Then take me there.";
				mes "I don't want to wander around this crappy garden anymore.";
				npctalk "(Hehehe. I will take care of you all the moment I join my colleagues.)";
				next;
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "You look so arrogant, don't you?";
				mes "I don't know what you're planning, but I Elena Bolkova will take you.";
				next;
				cutin "ep16_eisen02",0;
				mes "[Eisen]";
				mes "I'm willing to come with you.";
				next;
				cutin "162elena_01",2;
				mes "[Elena Bolkova]";
				mes "What a weird guy. I'll take this guy with me. Rookie is probably there too.";
				next;
				cutin "162elena_02",2;
				mes "[Elena Bolkova]";
				mes "Huh? Where will I bring this guy?";
				mes "Ah, the guesthouse. We are currently using it as a prison.";
				mes "Follow me. Also, I'll take all the cores with me.";
				ep17_2_main = 27;
				completequest 18013;
				setquest 18014;
				delitem 1000226,5;
				getitem 1000103,10;
				setpcblock PCBLOCK_ALL,false;
				questinfo_refresh();
				close2;
				cutin "",255;
				cloakonnpc "Eisen Werner#ep172_bamaison-00", getcharid(0);
				end;
			}
		case 27:
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "I'll see you at the guesthouse.";
			close2;
			cutin "",255;
			end;
		default:
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "I'm watching the area to see if there are hidden enemies lurking around.";
			mes "There are a lot of blind spots in this place.";
			close3;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 26 && isbegin_quest(18013) == 1";
	end;
}

ba_maison,301,148,5	duplicate(dummy_cloaked_npc)	Eisen Werner#ep172_bamaison-00	4_M_EISEN
ba_in01,14,145,1	duplicate(dummy_cloaked_npc)	Rookie#ep172_bain01-01	4_M_ROOKIE

ba_in01,35,142,5	script	Rebellion#guesthouse_to_jail	4_M_REBELLION3,{
	if(ep17_2_main < 27){
		mes "[Rebellion]";
		mes "There is nothing particular here.";
		end;
	}
	mes "[Rebellion]";
	mes "Are you going in?";
	next;
	if(select("Yes.:No.") == 2){
		mes "[Rebellion]";
		mes "I'll stay here and keep this place safe.";
		end;
	}
	if(ep17_2_main >= 27 && ep17_2_main < 32)
		cloakoffnpc "Eisen Werner#ep172_bain-00", getcharid(0);
	warp "ba_in01",28,144;
	end;
}

ba_in01,13,149,5	script	Eisen Werner#ep172_bain-00	4_M_EISEN,{
	if(ep17_2_main >= 29)
		mes "He is thoroughly constrained for what he has done.";
	end;
	
OnInit:
	cloakonnpc strnpcinfo(0);
	end;
}

ba_in01,20,145,3	script	Elena Bolkova#ep172_bain01-00	4_F_ELENA,{
	switch(ep17_2_main){			
		case 27:
			cutin "162elena_02",2;
			mes "[Elena Bolkova]";
			mes "Oh, here you are, this way, is Rookie not here yet?";
			next;
			cloakoffnpc "Rookie#ep172_bain01-01", getcharid(0);
			cutin "16loo_01",1;
			mes "[Rookie]";
			mes "No, no, I'm here too. Am a bit late?";
			mes "I talked to Alpha for a moment.";
			next;
			mes "[Rookie]";
			mes "Who is that?";
			next;
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "A big catch?";
			mes "Just watch. It's a sight for these two to play.";
			next;
			cutin "ep16_eisen01",0;
			mes "[Eisen]";
			mes "Hey, this is different from what we've talked about.";
			mes "Who is this?";
			next;
			select("That's the guy in Cor that you've mentioned.");
			cutin "ep16_eisen02",0;
			mes "[Eisen]";
			mes "This kid? I can't recall...?";
			mes "Are you lying to me?";
			next;
			cutin "ep171_elyumina02",2;
			mes "[Elyumina]";
			mes "Who are you to treat me like that?!";
			mes "Are you a dog of those punks?";
			next;
			cutin "ep171_elyumina03",2;
			mes "[Elyumina]";
			mes "They betrayed me first, and they're calling me a traitor.";
			mes "Are you with those punks?";
			next;
			cutin "ep16_eisen03",0;
			mes "[Eisen]";
			mes "I can't believe it, Is this really the Illusion?";
			mes "No, are you really a member of the Illusion?";
			next;
			cutin "ep171_elyumina04",2;
			mes "[Elyumina]";
			mes "What the hell are you talking about?! Why would I be held here when I'm not even one of the Illusion!";
			mes "What should I do, You didn't recognize the Great Elyumina. Do you want me to hit your head?";
			next;
			cutin "ep16_eisen01",0;
			mes "[Eisen]";
			mes "Hey, Rebellion, I need you to change this one to something that talks properly.";
			mes "If you want any information from me, bring me a decent Illusion member.";
			next;
			cutin "ep171_elyumina02",2;
			mes "[Elyumina]";
			mes "No, did you wuss out just now?";
			mes "Hey, I've been telling you that I'm a member of the Illusion for a while now. Do you even know how many years I've been doing this for?";
			next;
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "(See, isn't it funny? Watching them fight like that.)";
			next;
			cutin "16loo_01",1;
			mes "[Rookie]";
			mes "(Do you think it's an internal division? Come to think of it, you said he was the director of the research facility of the previous operation, right? How was he captured by us?)";
			next;
			cutin "ep16_eisen01",0;
			mes "[Eisen]";
			mes "You are lacking something important, you don't have a 'chip'!";
			mes "If only the 'chip' was detected, I wouldn't have come in here, and I would never have met a con like you.";
			next;
			mes "[Eisen]";
			mes "The Illusion is an alliance, but it's like a structure of thought. The official members has a 'chip' planted in their body, it's use to recognize traitors like you.";
			next;
			mes "[Eisen]";
			mes "Unless that 'chip' exist in you, you're not one of the Illusion. Do you get it now? You kid.";
			next;
			cutin "ep171_elyumina04",2;
			mes "[Elyumina]";
			mes "Ho? Did you hear that, Rookie? It's called 'chip'.";
			mes "This stupid thing blew it all out of his mouth.";
			mes "Fucking bastards, they left me alone.";
			mes "You mean, I who were in the middle of it all, were just a pawn, right?";
			next;
			cutin "ep16_eisen03",0;
			mes "[Eisen]";
			mes "Wa... wait...!";
			next;
			cutin "ep171_elyumina04",2;
			mes "[Elyumina]";
			mes "Is it too late to make a stupid expression now?";
			mes "Are you a self proclaimed elite member of the Illusion?";
			mes "Rookie! I'll rip this off his neck and make a tracker to trace those 'chips'!";
			next;
			mes "[Elyumina]";
			mes "Yeah! Let's do it! Revenge on the traitors! Chaos! Destruction! Revenge! Fall!";
			close2;
			setpcblock PCBLOCK_ALL,true;
			npctalk "Rookie! Use that thing over there!","Elyumina#ep172_bain01-00",bc_self;
			sleep2 1800;
			npctalk "What? Now?","Rookie#ep172_bain01-01",bc_self;
			sleep2 100;
			specialeffect EF_GRIMTOOTH,AREA,"Rookie#ep172_bain01-01";
			specialeffect EF_NPC_STOP,AREA,"Eisen Werner#ep172_bain-00";
			npctalk "What's this...! Ugh...,","Eisen Werner#ep172_bain-00",bc_self;
			sleep2 1500;
			npctalk "Get knocked out, bastard!","Elyumina#ep172_bain01-00",bc_self;
			sleep2 300;
			specialeffect EF_HIT2,AREA,"Eisen Werner#ep172_bain-00";
			sleep2 1800;
			setpcblock PCBLOCK_ALL,false;
			cutin "ep171_elyumina01",2;
			mes "[Elyumina]";
			mes "How dare you play with me?";
			mes "How dare you ignore the Great Elyumina, the line is very short, isn't it?";
			next;
			cutin "162elena_02",2;
			mes "[Elena Bolkova]";
			mes "Fuahahahahaha!!!!";
			mes "No, what am I seeing?!!!";
			mes "I thought our teamwork was good, but we're not as good as our enemies?";
			next;
			cutin "16loo_02",1;
			mes "[Rookie]";
			mes "I know.";
			mes "Mina, what are you going to do now?";
			next;
			cutin "ep171_elyumina04",2;
			mes "[Elyumina]";
			mes "To guarantee my research rights, I'm going to make you something you'd like.";
			mes "No, I just can't stand being harassed like this just because I'm a traitor, right?";
			next;
			mes "[Elyumina]";
			mes "I'll investigate the 'chip' planted in this guy's body and create a tracker that respond to this 'chip'.";
			mes "I've been building something before to protect myself from those hearthunters.";
			next;
			cutin "ep171_elyumina01",2;
			mes "[Elyumina]";
			mes "I wouldn't have gone this far too if I didn't protect my own life.";
			mes "Anyway, Please get me some materials that I need while I'm trying to rip off this guy. what's this guy called again, Eisen?";
			next;
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "What materials do you need?";
			next;
			cutin "ep171_elyumina01",2;
			mes "[Elyumina]";
			mes "10 Fluorescent Liquid, 10 Broken Sword, and some modules...";
			next;
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "Do you need that many? I hope you're not thinking about something stupid. I'll get the modules from Cor.";
			mes "Adventurer, could you get us the Fluorescent Liquids and Broken Swords?";
			next;
			mes "[Rookie]";
			mes "I think I've seen a fluorescent liquid in the sewage treatment plant, you can get it if you catch a black colored heart hunter scout.";
			next;
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "Then I'll stay here and protect this place, and when he wakes up, shouldn't someone stay here and knock him out again?";
			mes "You two, can leave it to me. Don't worry about this place.";
			ep17_2_main = 28;
			completequest 18014;
			setquest 18015;
			close2;
			cutin "",255;
			cloakoffnpc "Rookie#ep172_bain01-01", getcharid(0);
			end;
		case 28:
			mes "[Elena Bolkova]";
			mes "Don't worry about this place. I'll keep it safe.";
			end;
			
		case 29:
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "Erst is probably right in the front lounge.";
			mes "Go ahead and meet with Erst first, and I'll join later.";
			close3;
		case 32:
		case 33:
			cutin "162elena_01",2;
			mes "[Elena]";
			mes "Oh, where is Eisen Werner.";
			mes "He was taken by Tess. It looks like they're going to interrogate him on their own.";
			next;
			mes "[Elena]";
			mes "And he'll be locked up somewhere for the rest of his life.";
			mes "Elyumina would have been like that too. Elyumina's pretty lucky, right?";
			next;
			mes "[Elena]";
			mes "Don't worry about this place. I'll keep it safe.";
			close3;
		default:
			cutin "162elena_01",2;
			mes "[Elena Bolkova]";
			mes "Don't worry about this place. I'm guarding it properly.";
			close3;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 27";
	end;
}

ba_in01,15,147,3	script	Elyumina#ep172_bain01-00	4_EP17_ELYUMINA,{
	switch(ep17_2_main){
		case 27:
			cutin "ep171_elyumina01",2;
			mes "[Elyumina]";
			mes "Now you're safe, and all you have to do is chase those traitors to the end.";
			mes "Hahahahaha!! I'll be the winner who survived until the end.";
			close3;
		case 28:
			if(countitem(7110) < 10 || countitem(7326) < 10){
				cutin "ep171_elyumina04",2;
				mes "[Elyumina]";
				mes "Hmm~ Modules modules~ Hmm~";
				mes "Cores cores~ Hmm~";
				mes "What are you doing? Why didn't bring the materials I told you about?";
				close3;
			}
			cutin "ep171_elyumina04",2;
			mes "[Elyumina]";
			mes "Good, good~ Hmm";
			mes "If you do this here...";
			next;
			mes "[Elyumina]";
			mes "A masterpiece is born!";
			mes "If you send a signal, the receiver will~";
			next;
			//specialeffect EF_CROSSHAIR,AREA,"Eisen Werner#ep172_bain-00";
			specialeffect EF_TRACKCASTING,AREA,"Eisen Werner#ep172_bain-00";
			mes "[Elyumina]";
			mes "That's a good catch!";
			mes "Now, with this, go after the remnant of the Heart Hunter and the traitors.";
			next;
			select("By myself?");
			cutin "ep171_elyumina03",2;
			mes "[Elyumina]";
			mes "Can you do it alone when I'm holding the tracker?";
			mes "I can't believe I was caught by this guy.";
			mes "It's a disgrace to me, the great Elyumina.";
			next;
			cutin "162elena_01",0;
			mes "[Elena Bolkova]";
			mes "Huh, how about me if there's no one else to go with?";
			mes "or Erst.";
			mes "Didn't you join Erst in the last operation?";
			next;
			select("Where is Erst?");
			mes "[Elena Bolkova]";
			mes "She is probably right in the front lounge.";
			mes "Didn't you see her when you came?";
			mes "I'll also take the opportunity to turn them over and join you later.";
			next;
			mes "[Elena Bolkova]";
			mes "Erst, is good with brainstorm things. Hahahaha.";
			mes "Go ahead and meet with Erst.";
			delitem 7110,10;
			delitem 7326,10;
			ep17_2_main = 29;
			completequest 18015;
			setquest 18016;	
			getitem 1000092,1;
			getitem 1000103,10;
			close2;
			cutin "",255;
			questinfo_refresh();
			end;
		case 31:
			cutin "ep171_elyumina01",2;
			mes "[Elyumina]";
			mes "I've heard the news. Those bastards.";
			mes "However, Is it true that all the important Illusion members we're able to run away?";
			next;
			mes "[Elyumina]";
			mes "You hid like rats, and you secretly operated at night, right?";
			mes "Let's see how far they can ran away.";
			close3;
		default:
			cutin "ep171_elyumina04",2;
			mes "[Elyumina]";
			mes "*Chuckles*, go find those traitors.";
			mes "Adventurer, *Chuckles*";
			close3;
	}

OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 28 && countitem(7110) >= 10 && countitem(7326) >= 10";
	end;
}

ba_in01,26,266,3	script	Smart Ellie#ep172_hangar_0	4_EP17_TABLET,{
	switch(ep17_2_main){
		case 31:
			cutin "ep172_beta",2;
			mes "[Ellie]";
			mes "Hello, guest.";
			mes "I'm responsible for the airship hangar's information.";
			mes "Please call me Ellie.";
			next;
			mes "[Ellie]";
			mes "After the master had destroyed this place, I have been doing something else for a while, but...";
			next;
			mes "[Ellie]";
			mes "Now I'm back at Alpha's request.";
			mes "Please leave the hangar's matters to me, Ellie.";
			next;
			mes "[Ellie]";
			mes "The leader of the 'intruders' had freely access the area for the master's collection 3...";
			mes "I returned here to manage it.";
			npctalk "Sounds troublesome.","",bc_self;;
			next;
			mes "[Ellie]";
			mes "We are currently tracking the expected path after receiving the incident report.";
			mes "However, tracking it is not easy because the main system of No. 3 is completely disconnected.";
			next;
			mes "[Ellie]";
			mes "The 'invaders' which the 'guests' calls the 'Illusions' has a 99.9% chance that they made modifications on the system.";
			next;
			mes "[Ellie]";
			mes "Dear 'guests', are you here?";
			cloakoffnpc "Erst#ep172_hangar_0", getcharid(0);
			cloakoffnpc "Rookie#ep172_hangar_0", getcharid(0);
			next;
			cutin "ep162_est01",1;
			mes "[Erst]";
			mes "Um, yeah. What's the big deal?";
			mes "You've been having a hard time since last night.";
			next;
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "I told Alpha that the analysisable data in the current state is over.";
			next;
			cutin "ep172_beta",2;
			mes "[Ellie]";
			mes "Yes. I have sent the data.";
			mes "Currently, there is no reception from the master's collection 3, but we have caught some unusual signals.";
			next;
			mes "[Ellie]";
			mes "This facility has not been used for a long time, but it has been secretly used by the 'intruders' and...";
			npctalk "Unusual signal?","Rookie#ep172_hangar_0",bc_self;
			next;
			mes "[Ellie]";
			mes "There are traces of magical communication with certain places outside the mansion.";
			mes "It's an intermittent signal.";
			next;
			cutin "ep162_est01",0;
			mes "[Erst]";
			mes "What, do they keep in touch with the outside world regularly?";
			mes "Where? the enterprise?";
			next;
			cutin "ep172_beta",2;
			mes "[Ellie]";
			mes "According to the analysis, it's a one-way reception.";
			mes "It appears to be collecting reports from the outside...";
			next;
			mes "[Ellie]";
			mes "It will take some time to completely analyze the code because it was used by the 'intruders' for one-way reception.";
			next;
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "Then, Ellie, I'll ask for one thing.";
			mes "Continue receiving the signals as if the 'intruders' leader is still here.";
			next;
			cutin "ep162_est01",1;
			mes "[Erst]";
			mes "That's a smart move, Rookie.";
			mes "With that, we'll be able to trace back the other collaborators out there.";
			next;
			cutin "ep172_beta",2;
			mes "[Ellie]";
			mes "I will do as you say.";
			mes "We will maintain information patters of the 'intruders' and collect information received from their accomplices from outside the mansion.";
			next;
			cutin "16loo_03",0;
			mes "[Rookie]";
			mes "If we're lucky, we might be able to locate the airship route that the 'Illusions' used to ran away.";
			next;
			cutin "ep162_est01",1;
			mes "[Erst]";
			mes "So we really didn't catch the 'Illusions' here after all.";
			mes "Except for that kid.";
			next;
			cutin "16loo_01",0;
			mes "[Rookie]";
			mes "We protected the mansion... Can't we be a little bit satisfied?";
			mes "Tess seems to be working hard on coordinating with the companies, so that's all for us.";
			next;
			cutin "16loo_03",0;
			mes "[Rookie]";
			mes "As always, you did great.";
			mes "We were close, but next time we'll catch the rest of them.";
			mes "I've been collecting these, I'll let you have it, adventurer.";
			completequest 18018;
			ep17_2_main = 32;
			getitem 1000103,15;
			questinfo_refresh();
			next;
			cutin "ep162_est01",1;
			mes "[Erst]";
			mes "I'll stay in the guest house, if you need anything, come over there.";
			next;
			cutin "16loo_03",0;
			mes "[Rookie]";
			mes "Then I'll let everyone and help Alpha.";
			mes "Take good care of Ellie!";
			next;
			cutin "ep172_beta",2;
			mes "[Ellie]";
			mes "Do not worry about this place.";
			mes "Me and Almond will take care of it.";
			mes "You can be rest assured.";
			close2;
			cutin "",255;
			cloakonnpc "Erst#ep172_hangar_0", getcharid(0);
			cloakonnpc "Rookie#ep172_hangar_0", getcharid(0);
			end;
		default:
			break;
	}
	if(ep17_2_main > 31){
		cutin "ep172_beta",2;
		mes "[Ellie]";
		mes "No intermittent signal has been received yet.";
		mes "The whereabouts of the master's collection 3 are also being tracked at the same time.";
		next;
		mes "[Ellie]";
		mes "Don't worry.";
		mes "Time is on our side.";
		next;
		mes "[Ellie]";
		mes "Me and Alpha will analyze the information properly, so I'd like you to clean up the intruders' remnant.";
		close3;
	}
	cutin "ep172_beta.bmp", 2;
	mes "[Ellie]";
	mes "Hello, guest.";
	mes "I'm responsible for the airship hangar's information.";
	mes "Please call me Ellie.";
	close;
	end;

OnInit:	
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 31 && isbegin_quest(18018) == 1";
	end;
}

ba_in01,28,255,5	script	Manager Beta Almond#ep172_hangar_0	4_EP17_BASIC_B,{
	switch(ep17_2_main){
		case 31:
			cutin "ep172_beta",2;
			mes "[Almond]";
			mes "Hello? It's nice to see you again~";
			mes "I owe you for taking care of me last night.";
			mes "Are you in charge of this place starting today? I'll clean up well.";
			next;
			mes "[Almond]";
			mes "I am repairing Sweetie's broken parts, he is good at breaking them.";
			mes "He wants to fight often, so you have to be careful~";
			next;
			mes "[Almond]";
			mes "If you want to do a combat training, just tell me.";
			mes "I'll clean up for you.";
			close3;
		case 32:
			if(isbegin_quest(18019) == 0){
				cutin "ep172_beta",2;
				mes "[Almond]";
				mes "Sweety woke up. He might know something.";
				mes "Can you talk to him?";
				setquest 18019;
				questinfo_refresh();
				close3;
			}
			cutin "ep172_beta",2;
			mes "[Almond]";
			mes "Almond didn't understand half of what Sweety was saying.";
			mes "But a fighting machine? I do remember seeing him fight in the library before.";	
			close3;
		default:
			break;
			
	}
	if(ep17_2_main < 31){
		cutin "ep172_beta.bmp", 2;
		mes "[Almond]";
		mes "Hello, you're not on the guestlist.";
		mes "Kindly register first to Alpha or you might be tagged as intruder.";
		close3;
	}
	if(isbegin_quest(18024) == 1 && countitem(1000226) >= 10){
		.@count = countitem(1000226);
		cutin "ep172_beta",2;
		mes "[Almond]";
		mes "This cores is enough~ We'll use it to repair the broken automatic dolls..., and those with remaining data will be fix in no time.";
		mes "I'll give you this Barmeal Ticket in return.";
		erasequest 18024;
		setquest 18025;
		getitem 1000103,2;
		questinfo_refresh();
		close3;
	}
	switch(checkquest(18022,HUNTING)){
		case -1:
		case 2:
			if(isbegin_quest(18024) == 1){
				.@count = countitem(1000226);
				if(.@count < 10){
					cutin "ep172_beta",2;
					mes "[Almond]";
					mes "I need you to retrieve 10 broken automatic doll's 'core'.";
					mes "I think you're a little short.";
					close3;
				}
			}
			cutin "ep172_beta",2;
			mes "[Almond]";
			mes "Repairing Sweety. The automatic doll Almond is busy.";
			close3;
			
		case 0:
		case 1:
			.@md_name$ = "Hey! Sweety";
			.@party_id = getcharid(1);
			.@party_name$ = getpartyname(.@party_id);	
			if(!.@party_id){
				mes "^0000CDThis is a memorial dungeon.^000000";
				mes "Please create a party and try again.";
				mes "^0000CDA party can be created using the /organize partyname command.^000000";
				end;
			}
			mes "[Almond]";
			mes "Sweety signed up for a battle?";
			mes "It's fine as long as Almond keep an eye on him.";
			switch(checkquest(18025,PLAYTIME)){
				case -1:
					.@cd = true;
					break;
					
				case 0:
				case 1:
					.@cd = false;
					break;
						
				case 2:
					erasequest 18025;
					.@cd = true;
					break;
			}
			switch(isbegin_quest(18024)){
				case 0:
					if(.@cd){
						mes "Also, while on your way, please go out to the garden and pick up the 'cores' of the broken automatic dolls.";
						setquest 18024;
						break;
					}
					break;
					
				case 1:
					break;
			}
			next;
			switch(select("Create '" + .@md_name$ + "'.:Enter '" + .@md_name$ + "'.")){
				case 1:
					if(!is_party_leader()){
						cutin "",255;
						mes "^0000CDThis is a memorial dungeon.^000000";
						mes "You must be the party leader to create a memorial dungeon.";
						end;								
					}
					switch(instance_create(.@md_name$)){
						case -1:
							cutin "",255;
							mes "Unknown Error Has Occurred.";
							end;
							
						case -2:
							cutin "",255;
							mes "^0000CDThis is a memorial dungeon.^000000";
							mes "Please create a party and try again.";
							mes "^0000CDA party can be created using the /organize partyname command.^000000";
							end;
							
						case -3:
							cutin "",255;
							mes "[Almond]";
							mes "You already have an instance active. Cancel it and try again later.";
							mes "Player already have instance.";
							end;
							
						case -4:
							cutin "",255;
							mes "[Almond]";
							mes "Reservation is currently full. Try again later.";
							end;
							
						default:
							cutin "",255;
							mes "[Almond]";
							mes "Let's clean up the desk.";
							end;
					}
					
				case 2:
					switch(instance_enter(.@md_name$)){
						case IE_OTHER:
							mes "An unknown error has occurred.";
							end;
							
						case IE_NOINSTANCE:
							mes "^ff0000Character doesn't have an instance reserved.^000000";
							end;
							
						case IE_OK:
							switch(isbegin_quest(18024)){
								case 0:
										setquest 18024;
										break;
								case 1:
									break;
							}
							mapannounce "ba_in01", strcharinfo(0) + " of the party, "+ .@party_name$ +", is entering the " + .@md_name$ + ".", bc_map, "0x00FF99";
							end;
					}
			}
			end;
	}
	cutin "ep172_beta",2;
	mes "[Almond]";
	mes "Repairing Sweety. The automatic doll Almond is busy.";
	close3;
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 32 && isbegin_quest(18019) == 0";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main > 32 && checkquest(18022,HUNTING) == 0 || checkquest(18022,HUNTING) == 1";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main > 32 && isbegin_quest(18024) == 1 && countitem(1000226) >= 10";
end;
}

ba_in01,22,262,5	duplicate(dummy_cloaked_npc)	Erst#ep172_hangar_0	4_F_ESTLOVELOY
ba_in01,24,262,7	duplicate(dummy_cloaked_npc)	Rookie#ep172_hangar_0	4_M_ROOKIE

ba_in01,14,257,5	script	Automatic Doll Guard Beta#ep172_hangar_0	4_EP17_GUARD_B,{
	npctalk "You don't have to worry. This place is well guarded.";
	end;
}

ba_in01,30,252,5	script	Automatic Doll Guard Beta#ep172_hangar_1	4_EP17_GUARD_B,{
	npctalk "We're on 24-hour surveillance.";
	end;
}

ba_in01,30,248,3	script	Automatic Doll Guard Beta#ep172_hangar_2	4_EP17_GUARD_B,{
	npctalk "Rest assured. The dolls can monitor without even blinking their eyes.","Automatic Doll Guard Beta#ep172_hangar_1";
	end;
}

ba_in01,33,250,3	script	Sweety#ep172_hangar_0	4_EP17_SWEETY,{
	switch(ep17_2_main){
		case 31:
			cutin "ep172_beta",2;
			mes "[Almond]";
			mes "His body's base is the same as ours, so it's easy to repair.";
			mes "I'll tell you, when he wake up later.";
			close3;
		case 32:
			if(isbegin_quest(18019) == 0){
				cutin "ep172_sweety01",2;
				mes "[Sweety]";
				mes "What are you looking at?";
				mes "Get away from me?!";
				close3;
			}
			cutin "ep172_sweety01",2;
			mes "[Sweety]";
			mes "Ah. I have a new body...";
			next;
			cutin "ep172_beta",0;
			mes "[Almond]";
			mes "Sweety. You are wrong.";
			mes "It's not a new body, we just repaired your damages. Do you understand?";
			next;
			mes "[Almond]";
			mes "It's amazing that you're compatible with our automatic dolls part.";
			mes "Alpha said that Sweety's body's base is the same as ours.";
			next;
			cutin "ep172_sweety03",2;
			mes "[Sweety]";
			mes "Huh, what do you know.";
			mes "In short, my body is immortal.";
			next;
			select("You were a human before, right?");
			cutin "ep172_beta",0;
			mes "[Almond]";
			mes "If you think outside of the box, all creatures that can talk and rational are human beings.";
			mes "But, Me and Sweety aren't humans because we don't have any biological definition, am I right? Haha.";
			next;
			cutin "ep172_sweety03",2;
			mes "[Sweety]";
			mes "That's bullshit! I'm a human being! I was human!";
			next;
			mes "[Sweety]";
			mes "I was the only one recognized among the bunch of idiots!";
			mes "Do you know how I survived?";
			npctalk "Haha, the past.","Manager Beta Almond#ep172_hangar_0",bc_self;
			next;
			mes "[Sweety]";
			mes "Would I have been abandoned like the rest of them, if it wasn't for my genius brain?";
			mes "But isn't it great that I survived?";
			next;
			select("It's a nice story...");
			showscript ""+strcharinfo(0)+": Really, it doesn't do anything.";
			cutin "ep172_beta",0;
			mes "[Almond]";
			mes "From my perspective... Sweety has a person's brain, right?";
			mes "His body was modified like an automatic doll.";
			mes "Does that make you an automatic doll like us~?";
			next;
			cutin "ep172_sweety03",2;
			mes "[Sweety]";
			mes "Don't treat me like I'm the same as you!";
			mes "I'm a member of the Illusion!";
			mes "I'm just buying time, I wont fall down easily!";
			mes "Soon-";
			next;
			select("Soon?");
			cutin "ep172_beta",0;
			mes "[Almond]";
			mes "It seems you're mistaken, Sweety.";
			mes "The leader of the 'intruders' or the one that the guests call the Illusions has ran away, right?";
			mes "Doesn't that mean that they abandoned you?";
			mes "That's what I understood from the current situation.";
			next;
			mes "[Almond]";
			mes "Not possible.";
			mes "You won't be able to receieve it even if it came.";
			mes "Ellie took your receiving chip while we're repairing you.";
			mes "Doesn't that mean Ellie will take the orders for you?";
			npctalk "No! I'll receive my next orders soon!","",bc_self;
			next;
			mes "[Almond]";
			mes "What do you think should I do, adventurer?";
			mes "I couldn't destroy him because this kid has a brain of a 'human child'.";
			next;
			cutin "ep172_sweety02",2;
			mes "[Sweety]";
			mes "You...? What are you talking about?";
			mes "What are you going to do with me?";
			mes "My teachers wouldn't abandon me!";
			next;
			cutin "ep172_beta",0;
			mes "[Almond]";
			mes "Can I make a suggestion?";
			mes "Sweety is expected to express extreme stress due to anxiety.";
			next;
			mes "[Almond]";
			mes "Wouldn't it be better if you deal with him whenever Sweety goes on a rampage?";
			mes "Then I'll repair him after.";
			next;
			mes "[Almond]";
			mes "I've once read a book about a training where the trainer knocks down the trainee whenever they try to get up, isn't it common?";
			mes "In this case, I'll ask you to be trainer.";
			npctalk "Hey! Can't you hear me?!","",bc_self;
			completequest 18019;
			ep17_2_main = 33;
			questinfo_refresh();
			next;
			cutin "ep172_sweety04",2;
			mes "[Sweety]";
			mes "... ... so you won't even listen to my opinions...?";
			close2;
			cutin "",255;
			end;
	}
	switch(checkquest(18023,PLAYTIME)){
		case -1:
			break;
			
		case 0:
		case 1:
			cutin "ep172_sweety04",2;
			mes "[Sweety]";
			mes "I won't fall for your tricks, even if you look at me like that.";
			mes "Go away. I need to be repaired.";
			close3;
			
		case 2:
			mes "[Sweety]";
			mes "I'm fully repaired!";
			mes "You. Next time I'll really beat you to death!";
			erasequest 18023;
			end;

	}
	switch(checkquest(18022,HUNTING)){
		case -1:
			cutin "ep172_sweety01",2;
			mes "[Sweety]";
			mes "What is it? What's going on?";
			mes "Did you come back here to die in my hands?";
			next;
			if(select("Apply for battle.:Have a conversation.") == 2){
				cutin "ep172_sweety04",2;
				mes "[Sweety]";
				mes "Do you think I'll tell you anything if you do that...?";
				mes "Why don't you just go and die?";
				close2;
				cutin "",255;
				npctalk "Sweety, you always talk like that~","Manager Beta Almond#ep172_hangar_0",bc_self;
				end;
			}
			cutin "ep172_sweety03",2;
			mes "[Sweety]";
			mes "I'm glad to hear that.";
			mes "If you want to battle, you're welcome anytime!";
			next;
			cutin "ep172_sweety01",2;
			mes "[Sweety]";
			mes "But there's a problem. If you want to fight me, you have to convince Almond.";
			mes "Can you do it?";
			next;
			if(select("I can.:It's impossible.") == 2){
				cutin "ep172_sweety02",2;
				mes "[Sweety]";
				mes "What, you're just a nobody anyways.";
				close3;
			}
			if(isbegin_quest(18022) == 0)
				setquest 18022;
			mes "[Sweety]";
			mes "*chuckles*... I won't let you live this time... *chuckles*";
			questinfo_refresh();
			close3;
			
		case 0:
		case 1:
			cutin "ep172_sweety03",2;
			mes "[Sweety]";
			mes "Whoo-hoo... Come on, tell Almond!";
			mes "I'm going to warm up this body!";
			mes "And today's the day that I'll take you down!";
			close3;
			
		case 2:
			cutin "ep172_sweety02",2;
			mes "[Sweety]";
			mes "...Tch, I really don't want to see you.";
			mes "Just take this and go away!";
			erasequest 18022;
			setquest 18023;
			getitem 1000103,4;
			questinfo_refresh();
			close3;
	}
	
OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"ep17_2_main == 32 && isbegin_quest(18019) == 1";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main > 32 && checkquest(18023) == -1 && checkquest(18022,HUNTING) == -1";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main > 32 && checkquest(18023) == 2 && checkquest(18022,HUNTING) == -1";
	questinfo QTYPE_DAILYQUEST,QMARK_YELLOW,"ep17_2_main > 32 && checkquest(18022,HUNTING) == 2";
end;
}

ba_maison,33,220,0	script	#ep172_maison_ev-01	HIDDEN_WARP_NPC,3,3,{
	end;
	
OnTouch:
	if(ep17_2_main == 33){
		cloakoffnpc "Philofontes#ep172_bamaison-01", getcharid(0);
		cloakoffnpc "Crux#ep172_bamaison-00", getcharid(0);
	}
end;
}

ba_maison,36,221,3	script	Philofontes#ep172_bamaison-01	4_M_PHILOFONTES,{
	mes "[Philofontes]";
	mes "Nice to see you again.";
	mes "Mr. Crux here came from Rune-Midgarts.";
	mes "I think he's here to deliver some important news.";
	end;
	
OnInit:
	cloakonnpc strnpcinfo(0);
end;
}

ba_maison,38,219,5	script	Crux#ep172_bamaison-00	4_EP16_CRUX,{
	if(ep17_2_main == 33){
		cutin "ep16_crux_findel02",2;
		mes "[Crux]";
		mes "Adventurer! Long time no see!";
		mes "I've been hearing news occasionally through the court wizard...";
		next;
		mes "[Crux]";
		mes "If you're schedule is open, won't you come with me to the Prontera Palace?";
		next;
		select("What happened?");
		mes "[Crux]";
		mes "We can't keep the throne empty for too long.";
		mes "Thanks to your visit to Terra Gloria last time, The coronation ceremony will be held soon.";
		next;
		mes "[Crux]";
		mes "Everyone in the royal family wants to give thanks to you, adventurer.";
		mes "Of course, even the ladies of my family.";
		mes "If we leave now...";
		next;
		mes "[Crux]";
		mes "We will arrive on time for the coronation.";
		mes "I came here to pick you up.";
		next;
		mes "[Crux]";
		mes "Shall we go?";
		ep17_2_main = 34;
		setquest 18021;
		next;
		if(select("Let's go right now.:Let's go a bit later.") == 2){
			mes "[Crux]";
			mes "I see. Well, you have a busy schedule after all.";
			mes "Is there a place where I can wait?";
			next;
			cutin "ep16_tes01",0;
			mes "[Philofontes]";
			mes "There is a guest house in the northern part of the mansion.";
			mes "The Rebellion are currently using it as a lounge, is it fine if you wait over there?";
			next;
			cutin "ep16_crux_findel02",2;
			mes "[Crux]";
			mes "Is that so?";
			mes "Then I'll be waiting at the guest house.";
			mes "See you later, " + strcharinfo(0) + ".";
			npctalk "I'll get going.";
			close2;
			cutin "",255;
			cloakonnpc "Philofontes#ep172_bamaison-01", getcharid(0);
			cloakonnpc "Crux#ep172_bamaison-00", getcharid(0);
			end;
		}
		cutin "ep16_tes01",0;
		mes "[Philofontes]";
		mes "I will tell the others about it.";
		mes "See you later.";
		next;
		cutin "ep16_crux_findel02",2;
		mes "[Crux]";
		mes "Then, let us go.";
		close2;
		cutin "",255;
		cloakonnpc "Philofontes#ep172_bamaison-01", getcharid(0);
		cloakonnpc "Crux#ep172_bamaison-00", getcharid(0);
		warp "prt_cas",138,342;
	}
	end;
	
OnInit:
	cloakonnpc strnpcinfo(0);
end;
}

ba_maison,33,220,0	script	#ep172_bain01-02	HIDDEN_WARP_NPC,3,3,{
	end;
	
OnTouch:
	if(ep17_2_main == 34)
		cloakoffnpc "Crux#ep172_bain-00", getcharid(0);
end;
}

ba_in01,48,146,3	script	Crux#ep172_bain-00	4_EP16_CRUX,{
	if(ep17_2_main == 34){
		cutin "ep16_crux_findel02",2;
		mes "[Crux]";
		mes "It's cozy and nice here.";
		mes "There is also a beautiful rest area in the main house of the Nerius family.";
		mes "When we're off duty, we usually play dice together.";
		next;
		mes "[Crux]";
		mes "Well, shall we leave now?";
		next;
		if(select("Let's go right now.:Let's go a bit later.") == 2){
			mes "[Crux]";
			mes "I'll wait for you.";
			close3;
		}
		mes "[Crux]";
		mes "Then, let us go.";
		close2;
		cutin "",255;
		cloakonnpc(strnpcinfo(0), getcharid(0));
		warp "prt_cas",138,342;
	}
	end;
	
OnInit:
	cloakonnpc strnpcinfo(0);
end;	
}

prt_cas,140,344,3	script	Chamberlain Bell#ep172_prtcas	4_M_RUSMAN1,3,3,{
	if(isbegin_quest(18021) < 2)
		end;
	mes "[Bell]";
	mes "I was waiting for your return.";
	mes "Where should I take you?";
	next;
	if(select("Go out.:Talk.") == 2){
		mes "[Bell]";
		mes "I didn't expect at all that it would turn out like this.";
		end;
	}
	mes "[Bell]";
	mes "Then, let us go.";
	close2;
	warp "prt_cas",215,160;
	end;
	
	
OnTouch:
	if(isbegin_quest(18021) == 1){
		specialeffect2 EF_DEVIL6;
		sleep2 1500;
		specialeffect2 EF_DEVIL10;
		mes "I arrived with Crux to the Prontera Palace, the palace was filled with a strange excitement.";
		next;
		mes "The people in the hall, were the royal family and nobility of the royal family who we saw before.";
		next;
		cutin "ep171_coronation",4;
		mes "At the end of the red carpet, there's a young man who's on his knees with a crown on his head.";
		next;
		mes "He restored his honor by regaining the glory he had lost.";
		next;
		mes "He who once had nothing but misery in his name.";
		next;
		mes "He who only saw the world, last time when he was with me.";
		next;
		mes "Wearing a crown named Glory, while his head towards the earth.";
		next;
		mes "The moment it is declared, a new time will begin.";
		next;
		mes "My heart starts pounding hard at the fact that I'm standing in the middle of the passage of time.";
		next;
		mes "This proved the fact that the path that I've been walking is not wrong.";
		next;
		mes "At the end of a long adventure, that young man standing in front of the throne, was guided by my hand.";
		next;
		mes "Knowing the sorrow of the unchosen, knowing the pain of the past that cannot be reversed.";
		next;
		mes "I knew you'd stand in the way of the future, you're not assertive and knows how to seek help.";
		next;
		mes "You will be a great king.";
		completequest 18021;
		close2;
		cutin "",255;
	}
end;
}

prt_cas,325,263,3	script	Nyhill M. Heine#ep172_prtcas	4_EP17_NIHIL_K,{
	//= Story End
	if(isbegin_quest(18021) < 2)
		end;
	if(ep17_2_main == 34){
		cutin "ep171_nihil01",2;
		mes "[Nyhill]";
		mes "What a surprise guest!";
		mes "I didn't expect that we'll meet like this.";
		mes "Thank you for coming despite your busy schedule.";
		next;
		select("You look good in that.");
		mes "[Nyhill]";
		mes "I feel like I'm wearing someone else's clothes...";
		mes "I'm still wondering if I can really do this.";
		mes "I mean, is it really okay?";
		next;
		select("You'll do well.");
		cutin "ep171_nihil02",2;
		mes "[Nyhill]";
		mes "If you say so, then I'll believe in you.";
		mes "You'll stop me if I ever went astray someday, right?";
		next;
		mes "[Nyhill]";
		mes "I believe you will.";
		mes "Because you're an upright person.";
		mes "Also...";
		next;
		mes "[Nyhill]";
		mes "Feel free rest whenever you want.";
		mes "After all, you're not alone.";
		ep17_2_main = 35;
		setquest 18020;
		completequest 18020;
		close3;
	}
	cutin "ep171_nihil01",2;
	mes "[Nyhill]";
	mes "I can only see you for a moment now.";
	mes "I will have to take over the king's responsibilities soon.";
	next;
	cutin "ep171_nihil02",2;
	mes "[Nyhill]";
	mes "So, stay healthy, and if you ever need help someday, I will help you with all my power.";
	close3;
}

//Airship Warp
ba_maison,33,225,0	script	#maison_to_airship	WARPNPC,1,1,{
	end;
	
OnTouch:
	if(ep17_2_main < 31)
		warp "ba_in01",63,255;
	else
		warp "ba_in01",13,255;
	end;
}

//SideQuests
//Library Quest (ep17_2_library)
ba_maison,85,111,3	script	Fountain#ba	4_ENERGY_BLUE,{
	if(ep17_2_main > 9){
		if(isbegin_quest(11622) == 1){
			cloakoffnpc "Mark#ep172_fountain", getcharid(0);
			cloakoffnpc "Magi#ep172_fountain", getcharid(0);
			cloakoffnpc "Dew#ep172_fountain", getcharid(0);
			cloakoffnpc "Alp#ep172_fountain", getcharid(0);
			cloakoffnpc "Oliver#ep172_fountain", getcharid(0);
			cutin "bu_mark1",2;
			mes "[Mark]";
			mes "Where should we go first...";
			next;
			mes "[Oliver]";
			mes "Of course it's the library!";
			next;
			cutin "bu_alp3",2;
			mes "[Alp]";
			mes "Oh!";
			mes "As expected, you know something!!! It's the great sage Varmdunt!!! He's a legend, that no one has ever surpassed him during and after his time.";
			next;
			mes "[Alp]";
			mes "It's said that the science and technology are only maintaining the foundation that he has established, but they can't implement things that have no data left from his research.";
			mes "It's a library that holds that research that he loved!!! It's a privately owned library, but I heard it's bigger than the Geffen Library!!! It's been a while since I've been this excited!!!";
			next;
			cutin "bu_du5",2;
			mes "[Dew]";
			mes "Ugh...";
			mes "It came out...";
			mes "The bookmania...";
			next;
			cutin "bu_maggi1",2;
			mes "[Magi]";	
			mes "Me too!!!";
			mes "I wonder how many magic books are there!";
			next;
			cutin "bu_mark2",2;
			mes "[Mark]";
			mes "The Great Sage Varmdunt is said to excel in magic and healing, right?";
			mes "Come on! Let's go to the library.";
			close2;
			cutin "",255;
			cloakonnpc "Mark#ep172_fountain", getcharid(0);
			cloakonnpc "Magi#ep172_fountain", getcharid(0);
			cloakonnpc "Dew#ep172_fountain", getcharid(0);
			cloakonnpc "Alp#ep172_fountain", getcharid(0);
			cloakonnpc "Oliver#ep172_fountain", getcharid(0);
			navigateto("ba_in01",211,83);
			end;
		}
		if (isbegin_quest(11621) == 1) {
			cloakoffnpc "Dew#ep172_fountain", getcharid(0);
			cutin "bu_du5", 2;
			mes "[Dew]";
			mes "Ugh! Ugh!";
			mes "Ha... I think I'm going to be fine now.";
			next;
			cloakoffnpc "Mark#ep172_fountain", getcharid(0);
			cloakoffnpc "Magi#ep172_fountain", getcharid(0);
			cutin "bu_mark3", 2;
			mes "[Mark]";
			mes "Hey!!!";
			mes "What are you doing in the fountain!!!";
			mes "Get out of there now!!!";
			next;
			cloakoffnpc "Mansion Manager Beta#ep172_fountain", getcharid(0);
			cutin "ep172_beta",2;			
			mes "[Mansion Manager Beta]";
			mes "Warning.";
			mes "This facility is not for cleaning. Going in it is prohibited.";
			next;
			cutin "bu_du5", 2;
			mes "[Dew]";
			mes "Eeeeek!!!";
			mes "Who is that!!!";
			next;
			cutin "ep172_beta", 2;
			mes "[Mansion Manager Beta]";
			mes "I'm Mansion Manager Beta of [The Mansion of the Great Sage Varmundt].";
			mes "The facilities in the mansion are public, and is being used by every guest.";
			mes "Please follow thhe instructions when using the facility.";
			next;
			mes "[Mansion Manager Beta]";
			mes "Warnings are being recorded during abnormal usage of a facility, and if warnings accumulate, you will be removed from the mansion.";
			next;
			mes "[Mansion Manager Beta]";
			mes "In addition, there is a facility for body washing located in the basement of the mansion. We encourage guests who visits the mansion, to visit Meditatio, the great bathhouse.";
			next;
			mes "[Mansion Manager Beta]";
			mes "Then, I hope you have a comfortable time. Thank you.";
			next;
			cloakonnpc "Mansion Manager Beta#ep172_fountain", getcharid(0);
			cutin "bu_du4", 2;
			mes "[Dew]";
			mes "Isn't it too much to probibit washing in the fountain?";
			next;
			cutin "bu_mark3", 2;
			mes "[Mark]";
			mes "No, It's enough measure, but...";
			next;
			cutin "bu_maggi4", 2;
			mes "[Magi]";
			mes "Mark...";
			mes "Mark...";
			next;
			cutin "bu_mark2", 2;
			mes "[Mark]";
			mes "Yeah?";
			mes "What's wrong?";
			next;
			cutin "bu_maggi4", 2;
			mes "[Magi]";
			mes "Look at the guards over there.";
			mes "It's... it's all broken up.";
			next;
			cutin "bu_alp3", 2;
			mes "[Alp]";
			mes "I saw quite a few on the way up here.";
			cloakoffnpc "Alp#ep172_fountain", getcharid(0);
			next;
			cutin "bu_mark4", 2;
			mes "[Mark]";
			mes "As expected of the Heart Hunters...";
			mes "This is not the time to be doing this.";
			mes "We need to hurry up with the investigation.";
			next;
			cutin "bu_maggi3", 2;
			mes "[Magi]";
			mes "Yes!";
			mes "I won't let the Heart Hunters ruin this wonderful place!";
			next;
			cutin "bu_mark1", 2;
			mes "[Mark]";
			mes "Where should we go first...";
			next;
			cloakoffnpc "Oliver#ep172_fountain", getcharid(0);
			cutin "bu_oliver4", 2;
			mes "[Oliver]";
			mes "Of course it's the library!";
			next;
			cutin "bu_alp4", 2;
			mes "[Alp]";
			mes "Oh!";
			mes "As expected, you know something!!! It's the great sage Varmdunt!!! He's a legend, that no one has ever surpassed him during and after his time.";
			next;
			mes "[Alp]";
			mes "It's said that the science and technology are only maintaining the foundation that he has established, but they can't implement things that have no data left from his research.";
			mes "It's a library that holds that research that he loved!!! It's a privately owned library, but I heard it's bigger than the Geffen Library!!! It's been a while since I've been this excited!!!";
			next;
			cutin "bu_du5",2;
			mes "[Dew]";
			mes "Ugh...";
			mes "It came out...";
			mes "The bookmania...";
			next;
			cutin "bu_maggi2", 2;
			mes "[Magi]";
			mes "Me too!!!";
			mes "I wonder how many magic books are there!";
			next;
			cutin "bu_mark2", 2;
			mes "[Mark]";
			mes "The Great Sage Varmdunt is said to excel in magic and healing, right?";
			mes "Come on! Let's go to the library.";	
			completequest 11621;
			setquest 11622;
			ep17_2_library = 2;
			close2;
			cutin "bu_mark2", 255;
			navigateto("ba_in01",211,83);
			cloakonnpc "Mark#ep172_fountain", getcharid(0);
			cloakonnpc "Magi#ep172_fountain", getcharid(0);
			cloakonnpc "Dew#ep172_fountain", getcharid(0);
			cloakonnpc "Alp#ep172_fountain", getcharid(0);
			cloakonnpc "Oliver#ep172_fountain", getcharid(0);
			end;
		}
		mes "- The fountain where Dew washed himself.";
		mes "Fortunately, it seems to have been cleaned up after that. -";
		close3;
	}

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(11621) == 1 " );
	end;
}

ba_maison,82,110,5	duplicate(dummy_cloaked_npc)	Mansion Manager Beta#ep172_fountain	4_EP17_BASIC_B
ba_maison,89,109,3	duplicate(dummy_cloaked_npc)	Dew#ep172_fountain	4_M_REDMAN
ba_maison,88,113,5	duplicate(dummy_cloaked_npc)	Mark#ep172_fountain	4_M_BLUEMAN
ba_maison,87,114,5	duplicate(dummy_cloaked_npc)	Magi#ep172_fountain	4_F_PINKWOMAN
ba_maison,78,112,3	duplicate(dummy_cloaked_npc)	Alp#ep172_fountain	4_M_BLACKMAN
ba_maison,84,109,5	duplicate(dummy_cloaked_npc)	Oliver#ep172_fountain	4_M_OLIVER

ba_in01,211,183,0	script	#ent_lib	WARPNPC,2,2,{
	switch(ep17_2_library){
		case 2:
			cloakoffnpc "Mark#ep172_libent", getcharid(0);
			cloakoffnpc "Magi#ep172_libent", getcharid(0);
			cloakoffnpc "Dew#ep172_libent", getcharid(0);
			cloakoffnpc "Oliver#ep172_libent", getcharid(0);
			cutin "bu_du5", 2;
			mes "[Dew]";
			mes "Is this the entrance to the library?";
			mes "The entrance seems normal... No, fire!!!";
			mes "There's a fire!!!";
			next;
			cutin "bu_maggi3", 2;
			mes "[Magi]";
			mes "Kyaaah!!!";
			mes "It's dangerous!!";
			mes "Wa... Waterball!!!";
			specialeffect EF_WATERBALL,AREA,"ep172_firepit-01";
			for(.@i = 0; .@i < 4; .@i++)
				classchange 4_TRACE,"#ep172_firepit-" + .@i,bc_self;
			next;
			cutin "ep172_tamarin02", 2;
			mes "[Tamarin]";
			mes "Uhh...";
			mes "What's going on here?";
			next;
			mes "Click";
			next;
			cloakoffnpc "Library Manager Alpha#ep172_libent", getcharid(0);
			for(.@i = 0; .@i < 4; .@i++)
				classchange 4_BONFIRE,"#ep172_firepit-" + .@i,bc_self;
			cutin "ep172_alpha", 2;
			mes "[Library Manager Alpha]";
			mes "This material is installed by the master himself, and cannot be removed with the master's permission.";
			next;
			cutin "ep172_alpha", 2;
			mes "[Library Manager Alpha]";
			mes "Therefore, we would like to ask you to refrain from entering. It could pose a fatal risk to your discharge from the mansion, and we are not responsible for any injuries or deaths if you forced your way in despite the warning.";
			next;
			cutin "bu_du5", 2;
			mes "[Dew]";
			mes "...Fire?";
			next;
			cutin "bu_mark1", 2;
			mes "[Mark]";
			mes "No matter how good your recovery skills are, you cannot recover hair or clothes...";
			next;
			cutin "ep172_tamarin02", 2;
			mes "[Tamarin]";
			mes "I don't think we can enter...";
			next;
			cutin "bu_maggi1", 2;
			mes "[Magi]";
			mes "That's too bad...";
			next;
			cutin "bu_alp1", 2;
			cloakoffnpc "Alp#ep172_libent", getcharid(0);
			mes "[Alp]";
			mes "......";
			next;
			cutin "ep172_alpha", 2;
			mes "[Library Manager Alpha]";
			mes "I wish you a safe and comfortable viewing.";
			next;
			cloakonnpc "Library Manager Alpha#ep172_libent", getcharid(0);
			cutin "bu_alp3", 2;
			mes "[Alp]";
			mes "...";
			next;
			cutin "bu_alp1", 2;
			mes "[Alp]";
			mes "All right...";
			mes "She's gone...";
			mes "Let's break through!!";
			next;
			cutin "bu_mark1", 2;
			mes "[Mark]";
			mes "Well...";
			mes "You weren't warned for killing the fire, so it's okay, right?";
			next;
			cutin "bu_du2", 2;
			mes "[Dew]";
			mes "One more time.";
			mes "Magi!!";
			next;
			cutin "bu_maggi3", 2;
			mes "[Magi]";
			mes "Waterball!!!!";
			specialeffect EF_WATERBALL2,AREA,"fire2";
			ep17_2_library = 3;
			erasequest 11622;
			setquest 11623;
			close2;
			cutin "bu_maggi3", 255;
			cloakonnpc "Mark#ep172_libent", getcharid(0);
			cloakonnpc "Magi#ep172_libent", getcharid(0);
			cloakonnpc "Dew#ep172_libent", getcharid(0);
			cloakonnpc "Oliver#ep172_libent", getcharid(0);
			cloakonnpc "Alp#ep172_libent", getcharid(0);
			warp "ba_lib",159,12;
			end;
		default:
			break;
	}
	if(ep17_2_library > 2){
		warp "ba_lib",159,12;
		end;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(11622) == 1 && ep17_2_library == 2 " );
	end;
}

ba_in01,213,178,3	duplicate(dummy_cloaked_npc)	Dew#ep172_libent	4_M_REDMAN
ba_in01,209,181,5	duplicate(dummy_cloaked_npc)	Mark#ep172_libent	4_M_BLUEMAN
ba_in01,209,179,5	duplicate(dummy_cloaked_npc)	Magi#ep172_libent	4_F_PINKWOMAN
ba_in01,213,181,3	duplicate(dummy_cloaked_npc)	Oliver#ep172_libent	4_M_OLIVER
ba_in01,210,184,5	duplicate(dummy_cloaked_npc)	Alp#ep172_libent	4_M_BLACKMAN
ba_in01,209,186,5	duplicate(dummy_cloaked_npc)	Library Manager Alpha#ep172_libent	4_EP17_MASTER_A
ba_in01,210,186,3	duplicate(dummy_npc)	#ep172_firepit-0	4_BONFIRE
ba_in01,211,186,3	duplicate(dummy_npc)	#ep172_firepit-1	4_BONFIRE
ba_in01,212,186,3	duplicate(dummy_npc)	#ep172_firepit-2	4_BONFIRE
ba_in01,213,186,3	duplicate(dummy_npc)	#ep172_firepit-3	4_BONFIRE

ba_lib,157,19,5	script	Library Manager Beta#inside_lib	4_EP17_BASIC_B,{
	switch(ep17_2_library){
		case 3:
			cutin "ep172_beta", 2;
			mes "[Library Manager Beta]";
			mes "Please be quiet inside the library. Also, you need to register to use the library. If you don't register, you won't be able to read any book inside the library.";
			next;
			select("Register");
			mes "[Library Manager Beta]";
			mes "You have been registered.";
			mes "Would you like to confirm your party's registration?";
			next;
			cutin "bu_du3", 2;
			mes "[Dew]";
			mes "Ahh!";
			mes "I'm done!";
			mes "The others have already found a book, and got captivated by it...";
			mes "and they told me to stay here and wait!";
			next;
			cutin "bu_du1", 2;
			mes "[Dew]";
			mes "You have your library registration already, is there a book you're looking for?";
			mes "I don't care about books... you should look around.";
			next;
			mes "[Dew]";
			mes "While you're looking around, let the other guys know that they need to register... See you later~~~";
			cutin "bu_du2", 2;
			ep17_2_library = 4;
			completequest 11623;
			setquest 11624;
			setquest 11625;
			setquest 11626;
			setquest 11627;
			setquest 11628;
			close3;
		case 4:
		case 5:
		case 6:
		case 7:
		case 8:
			cutin "ep172_beta", 2;
			mes "[Library Manager Beta]";
			mes "Please tell your friends to register here first.";
			close3;
		case 9:
			mes "[Library Manager Beta]";
			mes "Thank you for your party confirmation.";
			mes "" + strcharinfo(0) + ", 4; other applicants for library registration… 5 people... 4 people... 6 people... 7 people... 4 people... 3 people... Beep------ has been confirmed.";
			mes "Thank you for your cooperation.";
			getitem 1000103, 5;
			completequest 11629;
			completequest 11630;
			completequest 11631;
			completequest 11632;
			completequest 11633;
			ep17_2_library = 10;
			close;
		case 10:
			cutin "ep172_beta", 2;
			mes "[Library Manager Beta]";
			mes "Hello " + strcharinfo(0) + "!";
			mes "The following requests are only for library users, we'd appreciate if you'd give us your support.";
			next;
			setarray .@quest_id[0], 11634, 11636;
			setarray .@quest_menu$[0], "Ultimate Bookworm Hunt", "Ultimate Bookkeeping Hunt";
			.@size = getarraysize(.@quest_id);
	
			for ( .@i = 0; .@i < .@size; ++.@i ) {
				switch( checkquest(.@quest_id[.@i],HUNTING) ) {
					case -1:
						switch( checkquest(.@quest_id[.@i] + 1, PLAYTIME) ) {
							case -1:
								.@color$ = "^000000";
								.@started_quest$ = " [Daily] ";
								break;
							case 0:
							case 1:
								.@color$ = "^8C8C8C";
								.@started_quest$ = " [Wait] ";
								break;
							case 2:
								.@color$ = "^8C8C8C";
								.@started_quest$ = " [Ready] ";
								break;
						}
						break;
					case 0:
					case 1:
						.@color$ = "^8C8C8C";
						.@started_quest$ = " [In Progress] ";
						break;
					case 2:
						.@color$ = "^8C8C8C";
						.@started_quest$ = " [Completed] ";
						break;
				}
				.@menu$ += .@color$ + .@quest_menu$[.@i] + .@started_quest$ + "^000000:";
			}
			.@select = select(.@menu$ + "Stop.") - 1;
			if (.@select == .@size) {
				cutin "ep172_beta", 2;
				mes "[Library Manager Beta]";
				mes "We wish you a safe and comfortable viewing.";
				close3;
			}
			switch( checkquest(.@quest_id[.@select],HUNTING) ) {
			case -1:
				switch( checkquest(.@quest_id[.@select] + 1, PLAYTIME) ) {
				case -1:
					break;
				case 0:
				case 1:
					cutin "ep172_beta", 2;
					mes "[Library Manager Beta]";
					mes "Today's work has already been completed.";
					mes "Thank you.";
					close3;
				case 2:	// TODO: when the PLAYTIME quest is erased ?
					erasequest.@quest_id[.@select] + 1;
					break;
				}
				cutin "ep172_beta", 2;
				mes "[Library Manager Beta]";
				switch( .@quest_id[.@select] ) {
				case 11634:
					mes "Recently, we received an inquiry that the number of the Bookworms that feeds on magic books has increased exponentially, causing inconvenience in using the library.";
					mes "Please take care of 20 Bookworms to improve the environment of the library.";
					break;
				case 11636:
					mes "Recently, we received an inquiry that the library's bookshelves was in a mess because of the spellbooks, that wanders away from their designated section.";
					mes "Please collect 20 Roaming Spellbook around to improve the environment of the library.";
					break;
				}
				if ( select("Accept", "Reject") == 2 ) close3;
				mes "[Library Manager Beta]";
				mes "Thank you very much.";
				setquest .@quest_id[.@select];
				close3;
			case 0:
			case 1:	// TODO: it's the text when the hunting quest started ?
				cutin "ep172_beta", 2;
				mes "[Library Manager Beta]";
				mes "We wish you a safe and comfortable viewing.";
				close3;
			case 2:
				mes "[Library Manager Beta]";
				mes "I have confirmed the completion of the request.";
				mes "Thank you.";
				erasequest .@quest_id[.@select];
				setquest .@quest_id[.@select] + 1;
				getitem 1000103, 2;
				close3;
			}
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, "isbegin_quest(11623) == 1" );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, "isbegin_quest(11629) == 1 && isbegin_quest(11630) == 1 && isbegin_quest(11631) == 1 && isbegin_quest(11632) == 1 && isbegin_quest(11633) == 1" );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, "checkquest(11634,HUNTING) == 2 || checkquest(11636,HUNTING) == 2" );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, "ep17_2_library > 9 && (checkquest(11635,PLAYTIME) == 2 || checkquest(11637,PLAYTIME) == 2)" );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, "ep17_2_library > 9 && checkquest(11635,PLAYTIME) == -1 && checkquest(11634,HUNTING) == -1" );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, "ep17_2_library > 9 && checkquest(11637,PLAYTIME) == -1 && checkquest(11636,HUNTING) == -1" );
	end;
}

ba_lib,159,19,5	script	Dew#library	4_M_REDMAN,{
	cutin "bu_du3", 2;
	mes "[Dew]";
	mes "Maybe I'll take home... some books...";
	close3;
}

ba_lib,84,85,3	script	Mark#library	4_M_BLUEMAN,{
	if (isbegin_quest(11624)) {
		cutin "bu_mark2", 2;
		mes "[Mark]";
		mes "This is unbelievable!!!!";
		mes "I can't believe there are so many books that I couldn't find in the Prontera library!";
		next;
		cutin "bu_mark1", 2;
		mes "[Mark]";
		mes "You need to register? I was in a hurry, I didn't even take a look into it.";
		mes "I'll go ahead and register first.";
		ep17_2_library++;
		erasequest 11624;
		questinfo_refresh();
		setquest 11629;
		close3;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(11624) == 1 " );
	end;
}

ba_lib,112,266,5	script	Magi#library	4_F_PINKWOMAN,{
	if (isbegin_quest(11625)) {
		mes "[Magi]";
		mes "Awesome!!!";
		mes "There are so many magic spells that I've never seen before!!!!!";
		cutin "bu_maggi3", 2;
		next;
		mes "[Magi]";
		mes "Library registration?";
		mes "Was there something like that?";
		next;
		mes "[Magi]";
		mes "Wait a minute... I'll just look at this a little bit more and go register!!!";
		cutin "bu_maggi2", 2;
		ep17_2_library++;
		erasequest 11625;
		questinfo_refresh();
		setquest 11630;
		close3;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, "isbegin_quest(11625) == 1" );
	end;
}

ba_lib,96,208,5	script	Tamarin#library	4_EP17_TAMARIN,{
	if (isbegin_quest(11627)) {
		cutin "ep172_tamarin02", 2;
		mes "[Tamarin]";
		mes "Library registration... I was so excited about the library that I just came in. There are so many books that I want to read... I'll go register as soon as possible.";
		next;
		cutin "ep172_barmund_b03", 2;
		mes "[????????]";
		mes "It's over here~";
		mes "Let me know if you've seen the book, [City of Fairies]~";
		classchange(4_EP17_BOY_B,"????????#Tamarin_side",bc_self);
		next;
		cutin "ep172_tamarin02", 2;
		mes "[Tamarin]";
		mes "Huh? City of Fairies?";
		mes "I don't know?";
		next;
		cutin "ep172_barmund_b04", 2;
		mes "[????????]";
		mes "Eh? You don't know?";
		mes "That's odd?";
		mes "I'm sure that you would know where it is...";
		next;
		cutin "ep172_barmund_b05", 2;
		mes "[????????]";
		mes "Oh!";
		mes "Looking at you closely, you look quite different from the other managers, am I right?";
		next;
		cutin "ep172_tamarin02", 2;
		mes "[Tamarin]";
		mes "It's totally different, even if you don't look closely!!!";
		next;
		cutin "ep172_barmund_b05", 2;
		mes "[????????]";
		mes "Yeah, yeah~";
		mes "I got it already.";
		mes "I'll look for it myself!";
		ep17_2_library++;
		erasequest 11627;
		questinfo_refresh();
		setquest 11632;
		close2;
		cutin "ep172_barmund_b05", 255;
		classchange(HIDDEN_WARP_NPC,"????????#Tamarin_side",bc_self);
		end;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, "isbegin_quest(11627) == 1" );
	end;
}

ba_lib,99,209,3	script	????????#Tamarin_side	HIDDEN_WARP_NPC,{ end; }

ba_lib,199,233,4	script	Oliver#library	4_M_OLIVER,{
	if (isbegin_quest(11628)) {
		cutin "bu_oliver5", 2;
		mes "[Oliver]";
		mes "Hmm...";
		mes "This too...";
		mes "That too...";
		mes "It's a book that I've read..";
		next;
		mes "[Oliver]";
		mes "I thought I could find new books...";
		mes "By the way... Where did you see these books...";
		next;
		cutin "ep172_barmund_a03", 2;
		mes "[????????]";
		mes "Even if you've already read a book, you might be able to discover new parts by reading it again.";
		classchange(4_EP17_BOY_B,"????????#Oliver_side",bc_self);
		next;
		cutin "bu_oliver2", 2;
		mes "[Oliver]";
		mes "But once I read a book, I remember every word in it.";
		next;
		cutin "ep172_barmund_a03", 2;
		mes "[????????]";
		mes "But, the emotions you'll feel will be different, depending on the situation you are in.";
		next;
		cutin "bu_oliver4", 2;
		mes "[Oliver]";
		mes "Hee~~ That's right!";
		next;
		cutin "bu_oliver2", 2;
		mes "[Oliver]";
		mes "By the way, who are you?";
		next;
		cutin "ep172_barmund_a03", 2;
		mes "[????????]";
		mes "Well...";
		mes "Like the book in your hand.";
		mes "You don't know who I am right now, but you'll eventually know who I am if you think it over and over again.";
		classchange(HIDDEN_WARP_NPC,"????????#Oliver_side",bc_self);
		next;
		cutin "bu_oliver4", 2;
		mes "[Oliver]";
		mes "That brother was quite strange...";
		mes "Then I'll decide with this book as the brother said!!!";
		ep17_2_library++;
		erasequest 11628;
		questinfo_refresh();
		setquest 11633;
		close3;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, "isbegin_quest(11628) == 1" );
	end;
}

ba_lib,202,232,1	script	????????#Oliver_side	HIDDEN_WARP_NPC,{ end; }

ba_lib,293,234,3	script	Alp#library	4_M_BLACKMAN,{
	if (isbegin_quest(11626)) {
		cutin "bu_alp4", 2;
		mes "[Alp]";
		mes "Hahaha~";
		next;
		mes "- I'd better not talk to him right now. -";
		ep17_2_library++;
		erasequest 11626;
		questinfo_refresh();
		setquest 11631;
		close3;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, "isbegin_quest(11626) == 1" );
	end;
}

//Storage or Warehouse
ba_2whs01,150,51,5	script	Chirp#172wh01	4_EP17_BASKET,{
	if(ep17_2_main < 10){
		cutin "ep172_beta.bmp", 2;
		mes "[Chirp]";
		mes "Since everything is open to special guests, it is not possible to stop the tour. However, if you are going to look around the warehouse, you should not touch any of the items here.";
		close3;
	}
	if(BaseLevel < 160){
		cutin "ep172_beta",2;
		mes "[Chirp]";
		mes "This place is dangerous.";
		mes "Please come back again when you are able to protect yourself better.";
		next;
		mes "- You must be atleast level 160 to perform this quest. -";
		close3;
	}
	switch(ep17_2_whouse){
		case 0:
			cutin "ep172_beta",2;
			mes "[Chirp]";
			mes "What a mess is this.";
			mes "How did you come in here?";
			mes "You don't even have a key with you.";
			next;
			cutin "",255;
			if(select("What’s this place for?:Let’s go back because we are going to get caught up in a nasty mess..") == 2){
				mes "[Chirp]";
				mes "Maybe you just got in accidentally.";
				close3;
			}
			cutin "ep172_beta",2;
			mes "[Chirp]";
			mes "A human being?";
			mes "and... the guest?";
			next;
			mes "[Chirp]";
			mes "Did you come here to find the blueprints for the mansion? I'll bring it to you if you wait. I remember the saying that humans lack patience.";
			next;
			mes "[Chirp]";
			mes "This is Varmundt mansion's second warehouse.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Warehouse...?");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Oh, is there any notion of a warehouse for outsiders? Warehouse is where you store things that you don't use right now.";
			showscript ""+strcharinfo(0)+" : I know that!";
			next;
			mes "[Chirp]";
			mes "I am here to get the blueprints that you requested and the ingredients for the restaurant. Did you come here in person because you didn't trust me? Don't worry.";
			next;
			mes "[Chirp]";
			mes "I've been in charge of the storage for a very long time, so I can quickly find even old small items. Of course, I remember the location of the blueprint..";
			next;
			mes "[Chirp]";
			mes "Because I'm an automatic doll. There's no such thing as memory degeneration.";
			next;
			cutin "ep172_beta.bmp", 255;
			if(select("I'm not looking for a blueprint:It's very complicated here.") == 1 ){
				cutin "ep172_beta",2;
				mes "[Chirp]";
				mes "Is that so? I misunderstood the situation.";
				mes "I didn't think there would be any humans visiting the warehouse. Usually the humans that come all the way here were usually thieves.";
				next;
				mes "[Chirp]";
				mes "That doesn't mean that you are a thief. Becayse you wouldn't have qualified as a guest. The Varmdunt Mansion does not invite everyone as a guest.";
				next;
				mes "[Chirp]";
				mes "Even if you have that intention, it won't be easy to find what you want here anyway.";
				next;
				select("This place is very complicated.");
			}
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Of course, it's an old Varmundt's warehouse. It's because we're running out of space and we've been building and renovating.";
			next;
			mes "[Chirp]";
			mes "It's not really that complicated because things and shelves look like they're complicated, but they're classified.";
			next;
			mes "[Chirp]";
			mes "This is possible because it's a very large space unlike what you see from the outside. So if you're safe, go back and wait for me, I'll bring it to you soon... hopefully";
			next;
			cutin "ep172_beta.bmp", 255;
			select("But what?");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "I think I'll be delayed a little because of that broken cleaning robot. They are automatic dolls attacked from the previous intruders. How do we deal with them?";
			next;
			mes "[Chirp]";
			mes "Wouldn't ^EE0000setting a fire^000000 be the cleanest?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Eh? Then everything's going to burn?");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "It's okay. They're all fireproofed. Even if it burns, the blueprint for the mansion are in other warehouses. We need to go a little far, but that's okay. Rest assured.";
			next;
			mes "[Chirp]";
			mes "It's the fastest and cleanest way to do it all at once.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("That's not the problem...");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Then what's the problem?";
			next;
			cutin "ep172_beta.bmp", 255;
			switch(select("Let's call the security instead.:Call the superiors.")){
				case 1:
					cutin "ep172_beta",2;
					mes "[Chirp]";
					mes "It would be fine to call the security, but it would take a lot of time.";
					mes "Are you fine with that? Security will be in place and it will take at least a day to put them under control and deal with them.";
					next;
					mes "[Chirp]";
					mes "Rather, it's faster to start a fire and wait for it to burn down.";
					next;
					cutin "ep172_beta.bmp", 255;
					select("What's wrong with the you?");
					cutin "ep172_beta.bmp", 2;
					mes "[Chirp]";
					mes "I'm not a human being. I don't know what you expect from me.";
				case 2:
					cutin "ep172_beta",2;
					mes "[Chirp]";
					mes "What do you mean by calling the superiors?";
					mes "Are you telling me to leave the superiors to solve this problem?";
			}
			next;
			mes "[Chirp]";
			mes "Is it necessary to waste time passing a problem that I can handle?";
			next;
			mes "[Chirp]";
			mes "However, I was told to respect your opinion as much as possible, so if you want it, I will. Just a moment, please.";
			showscript ""+strcharinfo(0)+" : I'm so eager to...";
			sleep2 10;
			donpcevent strnpcinfo(0) + "::OnBar"; //Process Bar
			sleep2 1000;
			next;
			cloakoffnpc "Beta#172wh01", getcharid(0);
			cutin "ep172_beta.bmp", 0;
			mes "[Beta]";
			mes "Did you call me? What's the problem? Is it long? I'm kinda busy now.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Take a look here. What do you think? What do you want me to do with all the excited cleaning robots that are making that mess? Do you have a good idea?";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Beta]";
			mes "Oh my, that's serious.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Right? So, tell me the solution quickly. For the human guests here to hear. Because this guest here called you in and told you to work it out..";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Beta]";
			mes "But it's not just here. Wait. There's no security that I can send you now.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "I need to get something for the guests right now. If I go in there now, I'll be just like them. Are you okay with that?";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Beta]";
			mes "I can't do that. I can't help it. I'll send it to you as soon as possible. But after tomorrow.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Then can you start the fire?";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Beta]";
			mes "No. Wait. It might get stuck somewhere else. We can't risk our guests.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "I am confident that the fire won't spread.";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Beta]";
			mes "You can't. The more you catch me, the slower it gets. Just wait a little longer. I ask the guests for their understanding.";
			next;
			cloakonnpc "Beta#172wh01", getcharid(0);
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Did you see that? Even if I call my superiors, there's no solution that I can take care of. I can't even start a fire anymore. If I hadn't told you, I could've done it.";
			emotion ET_SWEAT, strcharinfo(0);
			next;
			mes "[Chirp]";
			mes "What should I do now? There's something I need to bring over there, and if I jump in there, I'll be just like them. I'm not a fighter.";
			next;
			mes "[Chirp]";
			mes "I can avoid my body even if I try hard to a certain extent, but I'm worried because there are too many of them. If they attack all at once, even the strongest automatic doll's body will be destroyed in no time.";
			next;
			mes "[Chirp]";
			mes "Of course, I can throw myself away for a mission. But I don't think that's right now. It would be more valuable to throw my body away on something more important.";
			next;
			mes "[Chirp]";
			mes "Besides, who else would manage everything in the warehouse? You don't even know what's where.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Should I organize a bit?");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes ""+strcharinfo(0)+"? You mean you're organizing those cleaning robots?";
			next;
			mes "[Chirp]";
			mes "Why? Are you willing to take responsibility for what humans have done?";
			next;
			cutin "ep172_beta.bmp", 255;
			switch(select("I'm a different person.:You look awkward.")){
				case 1:
					cutin "ep172_beta",2;
					mes "[Chirp]";
					mes "Is the fault of one human, the fault of all human?";	
				case 2:
					cutin "ep172_beta",2;
					mes "[Chirp]";
					mes "Are you showing pity to me for being helpless in front of the automatic doll in the warehouse? Do humans feel responsible for things they didn't do?";
			}
			next;
			cutin "ep172_beta.bmp", 255;
			select("No, it's not.");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Is it? That's why we misunderstood. We're all connected, so we share everything. fault, responsibility.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Varmundt is also a human being.");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "He's different. He's a wise man. If he is here now, he would have solved all the problems earlier. Maybe the problem itself didn't happen.";
			next;
			mes "[Chirp]";
			mes "Thank you for your advice, but there was a notice telling me to cooperate as much as I can without causing any inconvenience to you. I'll think of another way. Anything will come out with something.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("I'm a fighter.");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "... Is that so? You're a fighter, and you're making it your job to deal with those things, aren't you? Then isn't it a nuisance?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("No, it isn't.");
			cutin "ep172_beta.bmp", 2;
			emotion ET_SWEAT, strcharinfo(0);
			mes "[Chirp]";
			mes "You're a man who finds pleasure in dealing with things like that. I've heard of it. Then I'd like to ask you a favor. Oh, of course, I'll pay you for it.";
			next;
			mes "[Chirp]";
			mes "Can you take care of ^0000cd5 bodies^000000 please. Then I'll be able to get through that mess. Well, I hope you enjoy the fun.";
			setquest 17342;
			ep17_2_whouse = 1;
			close3;
		case 1:
			switch(checkquest(17342,HUNTING)){
				case 0:
				case 1:
					cutin "ep172_beta.bmp", 2;
					mes "[Chirp]";
					mes "Are you here? There are still too many of them. You need to work harder. Can you take care 0000cd5 bodies^000000 please.";
					mes "Then I'll be able to get through that mess.";
					close3;
				case 2:
					mes "[Chirp]";
					mes "Did you enjoy it enough? I'm wondering if you're enjoying the destruction or the payoff that comes with it, but I don't have to know.";
					next;
					mes "[Chirp]";
					mes "Thanks to you, I was able to go in and pick up the stuff. At that rate, I can move my body a little faster and I can move my body enough.";
					next;
					mes "- Clatter -";
					next;
					mes "- Clatters -";
					next;
					mes "[Chirp]";
					mes "Did you just hear that?";
					next;
					cutin "ep172_beta.bmp", 255;
					select("The clattering noise?");
					cutin "ep172_beta.bmp", 2;
					mes "[Chirp]";
					mes "Yes, that one. Wait, be quiet.";
					next;
					mes "- Clatter -";
					next;
					mes "[???]";
					mes "- w...who.... -";
					next;
					mes "[Chirp]";
					mes "It's the sound made by an automatic doll based on the voice pattern. But it's not the sound of an automatic doll here. A little farther than it sounds in this space....";
					next;
					emotion ET_SURPRISE, getnpcid(0, "Chirp#172wh01");
					mes "[Chirp]";
					mes "I think it's from the basement. It's trouble. If that's really from the basement, then it's a trouble.";
					next;
					cutin "ep172_beta.bmp", 255;
					select("Why?");
					cutin "ep172_beta.bmp", 2;
					mes "[Chirp]";
					mes "Unlike this warehouse on the ground, the basement floor is accessible only to Varmundt. There's a lot of secrets, and there's a lot of dangerous things.";
					next;
					mes "[Chirp]";
					mes "If other automatic dolls and human beings go in and out and mess with dangerous objects..";
					mes "There are consequences of a enough predictable destruction.";
					next;
					mes "[Chirp]";
					mes "If this is really the sound from basement, and that's the sound of a broken automatic doll, what's left of us is destruction.";
					next;
					mes "[Chirp]";
					mes "It's only a matter of time before this place becomes ashore in a massive explosion. It's not the size of what I set fire to.";
					next;
					mes "[Chirp]";
					mes "There are dangers lurking underground. Someone has to check. At least if you're going to check what happened, you might ask your superiors to come faster. Then you'll be safe.";
					next;
					mes "[Chirp]";
					mes "I hope I know how to prevent this destruction.";
					next;
					mes "[Chirp]";
					mes "I have to take advantage of the time when the broken automatic dolls are organized to pick up the plans and ingredients.";
					next;
					mes "[Chirp]";
					mes ""+strcharinfo(0)+" is a fighter. So the only way left is...";
					next;
					cutin "ep172_beta.bmp", 255;
					select("...I'll have to check.");
					cutin "ep172_beta.bmp", 2;
					emotion ET_SWEAT, strcharinfo(0);
					mes "[Chirp]";
					mes "Oh, would you? I'm surprised you like to be such a guard. I'll keep that in mind. Taking care of your play is one of our responsibilities.";
					next;
					mes "[Chirp]";
					mes "There's a ^0000cd staircase that's on the upper right most^000000 of this place. Go down the stairs and check the situation below. Don't ever touch anything.";
					next;
					mes "[Chirp]";
					mes "Then go ahead and come back.";
					completequest 17342;
					setquest 17343;
					ep17_2_whouse = 2;
					getitem 1000103,3;
					close3;					
			}
		case 2:
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "There's a ^0000cdstaircase that's on the upper right most^000000 of this place. Go down the stairs and check the situation below. Don't ever touch anything.";
			close3;
		case 3:
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Did you check? What's the situation in the basement?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("It was locked..");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Was it locked? But how did the automatic doll go in? That's even a bigger problem. This proves that there is a hole in the security of the mansion, the intruders also entered through as passage other than the only entrance.";
			next;
			mes "[Chirp]";
			mes "You should also check...you said the gate was locked. I can't force it. I need to find the emergency key..";
			next;
			mes "[Chirp]";
			mes "It was a place where only master entered, but he left an emergency key that can only be used in an emergency in case something goes wrong with him";
			next;
			mes "[Chirp]";
			mes "Now is the time of the emergency.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Please give it.");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Do you like treasure hunts? Or do you have an exceptional talent for treasure-hunting? If not, I'd like you to have it from now on.";
			next;
			mes "[Chirp]";
			mes "My master hid ^0000cd three emergency keys here and there in the warehouse^000000. And there are still many broken automatic dolls in there.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Then I will again...");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "That's right. It's time to have fun. I'm glad to help you again.";
			next;
			mes "[Chirp]";
			mes "Find all the emergency locks at the place I'm talking to, unlock the door to the basement, and you can go underground.";
			next;
			mes "[Chirp]";
			mes "<NAVI>[The spinning world]<INFO>ba_2whs01,110,218,0,101,0</INFO></NAVI> where all the truth beneath it. Try to find a place with such an object.";
			next;
			mes "[Chirp]";
			mes "He also said that in a place <NAVI>[place]<INFO>ba_2whs01,14,282,0,101,0</INFO></NAVI>where you freeze your breath, everything doesn't change forever, but stays the way it is.";
			next;
			mes "[Chirp]";
			mes "Lastly,  that all air should flow and uses a lot of energy. I don't know where <NAVI>[such place]<INFO>ba_2whs01,222,257,0,101,0</INFO></NAVI>is.";
			next;
			mes "[Chirp]";
			mes "I don't know what all the hints mean, but you, a human adventurer like yourself, might interpret them.";
			next;
			mes "[Chirp]";
			mes "I don't expect you to interpret the meaning of the great master in a single line, but... If you don't know, you can search everywhere. Then go ahead and come back.";
			completequest 17344;
			setquest 17345;
			setquest 17346;
			setquest 17347;
			getitem 1000103,3;
			ep17_2_whouse = 4;
			close3;
		case 8:
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Did you check the underground situation? What do you think? You haven't been here for a long time and I was thinking about reporting about the death of Mr. "+strcharinfo(0)+".";
			emotion ET_SWEAT, strcharinfo(0);
			next;
			mes "[Chirp]";
			mes "I'm glad I didn't like it either. But why did it take so long? Have you encountered a problem that is beyond your ability to solve?";
			next;
			mes "[Chirp]";
			mes "I've heard that sometimes humans are reckless in challenging things beyond their abilities.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("That's...");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "That's why to sum up the words of Mr. "+strcharinfo(0)+" if you hadn't opened the door and went underground, it wouldn't have been dangerous.";
			mes "If left alone, they would remain peaceful and secure.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("That's right.");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "And also someone got a new body there.";
			next;
			mes "[Chirp]";
			mes "I told you to never touch anything, but you got the body part and made them for me. Is that right?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Yes...");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "And I don't know what that's like. In the worst case scenario, it might come up from the basement and lead us to destruction. Is that right?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("But he's not leaving...");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Think of it like this. Why did the Master bother to put his head in the danger zone.";
			mes "A head laid alone in a place full of dangerous goods. Maybe it's also dangerous.";
			next;
			mes "[Chirp]";
			mes "Even the highest class of combat type automatic dolls are not made in the underground hazardous materials area. It may be the next generation of weapons.";
			mes "You're lucky if you know how to distinguish the enemy from the enemy.";
			next;
			mes "[Chirp]";
			mes "It's no longer a worry that the automatic dolls will bring about.";
			next;
			mes "[Chirp]";
			mes "How should I handle this now? Mr. "+strcharinfo(0)+" will come to the ground with the arms and legs that he attached in good faith, and finish us with his hands and feet.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("That's too much of a leap...");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "What are you going to do? Mr. "+strcharinfo(0)+", a combat-type human, are you going back down to play? But if you were going to take care of it yourself, you wouldn't have asked for it in the first place.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("......");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Then there's only one way. Fortunately, he said it doesn't come out.";
			next;
			mes "[Chirp]";
			mes "^0000cdI'm going to cover this up quietly^000000. In this mansion, or in the world, only Mr. "+strcharinfo(0)+" and I know it.";
			next;
			mes "[Chirp]";
			mes "You must divide roles. I will continue to stand by and prevent anyone from entering and leaving the basement. We'll also monitor it to see if it's coming up to the ground.";
			next;
			mes "[Chirp]";
			mes "Instead Mr. "+strcharinfo(0)+" comes here everyday and ^0000cd cleans the upper and lower floors^000000so there's no more danger.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Ground floor?");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "It wasn't a problem like the broken cleaning robot. While checking the warehouse, the remaining intruders were spotted. He's called Harthunter's Skirmisher. Like I said, I have a lot of work to do.";
			next;
			mes "[Chirp]";
			mes "So please arrange the ground floor for Harthunter Skirmishers to protect the goods here, and the broken warehouse manager on the basement floor so that you don't go against the new weapons.";
			next;
			mes "[Chirp]";
			mes "There's nothing to lose. It's a pleasure. Of course, I'll pay you accordingly. I'll also biometric you so you can get in and out of the basement without the emergency key.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Sure.");
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Thank you. I'll give you this meal coupon as a token of your promise. Then, I'll take it as a secret.";
			mes "I'll take back the emergency key.";
			delitem 1000102, 3;
			erasequest 17358;
			getitem 1000103, 6;
			ep17_2_whouse = 9;
			questinfo_refresh();
			close3;
		case 9:
			cutin "ep172_beta.bmp", 2;
			mes "[Chirp]";
			mes "Are you here to keep our promise?";
			mes "Which job would you like to take on?";
			next;
			setarray .@quest_id[0], 17359, 17361;
			setarray .@quest_menu$[0], "Ground Floor", "Basement";
			.@size = getarraysize(.@quest_id);
			for ( .@i = 0; .@i < .@size; ++.@i ) {
				switch( checkquest(.@quest_id[.@i],HUNTING) ) {
					case -1:
						switch( checkquest(.@quest_id[.@i] + 1, PLAYTIME) ) {
							case -1:
								.@color$ = "^000000";
								.@started_quest$ = "[Daily] ";
								break;
							case 0:
							case 1:
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Wait] ";
								break;
							case 2:
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Ready] ";
								break;
						}
						break;
					case 0:
					case 1:
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[In Progress] ";
						break;
					case 2:
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[Completed] ";
						break;
				}
				.@menu$ += .@color$ + .@started_quest$ + .@quest_menu$[.@i] + "^000000:";
			}
			.@select = select(.@menu$ + "I was wondering if everything's okay.") - 1;
			if (.@select == .@size) {
				mes "[Chirp]";
				mes "Nothing's going on yet. But no one knows how long it will last. Don't let your guard down.";
				close3;
			}
			switch( checkquest(.@quest_id[.@select],HUNTING) ) {
				case -1:
					switch( checkquest(.@quest_id[.@select] + 1, PLAYTIME) ) {
						case -1:
							break;
						case 0:
						case 1:
							mes "[Chirp]";
							mes "Thank you for keeping your promise. Please come back after dawn.";
							close3;
						case 2:
							erasequest.@quest_id[.@select] + 1;
							break;
					}
					mes "[Chirp]";
					switch( .@quest_id[.@select] ) {
						case 17359:
							mes "You really like fighting. Then, please handle ^0000cd 20 Harthunter scouts in the ground floor^000000.";
							break;
						case 17361:
							mes "You really like fighting. Then, please handle ^0000cd 20 broken security beta in the basement^000000.";
							break;
					}
					next;
					if ( select("Okay.", "I will rest for today.") == 2 ){
						mes "[Chirp]";
						mes "I hope you have a good break adventurer.";
						close3;
					}
					mes "[Chirp]";
					mes "In the meantime, I'll be doing my job.";
					setquest .@quest_id[.@select];
					close3;
				case 0:
				case 1:
					switch( .@quest_id[.@select] ) {
						case 17359:
							mes "[Chirp]";
							mes "Please handle ^0000cd 20 Harthunter scouts in the ground floor^000000.";
							close3;
						case 17361:
							mes "[Chirp]";
							mes "Please handle ^0000cd 20 broken security beta in the basement^000000.";
							close3;
					}
				case 2:
					mes "[Chirp]";
					mes "Have you taken care of everything?";
					next;
					mes "[Chirp]";
					mes "I see a decrease in the number of objects. I can successfully start my work now. Thank you. Please come back after dawn.";
					erasequest .@quest_id[.@select];
					setquest .@quest_id[.@select] + 1;
					getitem 1000103, 1;
					stopnpctimer;
					initnpctimer;
					close3;
			}
		default:
			end;
	}
	
OnBar:
    progressbar_npc "000000",1;
    end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_whouse < 1 && ep17_2_main > 10 && isbegin_quest(17342) == 0 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " checkquest(17342,HUNTING) == 2 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17344) == 1 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_whouse == 8 && isbegin_quest(17358) == 1 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_whouse > 8 && (checkquest(17362,PLAYTIME) == 2 || checkquest(17360,PLAYTIME) == 2 || checkquest(17362,PLAYTIME) == -1 || checkquest(17360,PLAYTIME) == -1)" );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " checkquest(17359,HUNTING) == 2 || checkquest(17361,HUNTING) == 2 " );
	end;
}

ba_2whs01,153,49,1	duplicate(dummy_cloaked_npc)	Beta#172wh01	4_EP17_BASIC_B

ba_2whs01,277,290,5	script	Lock#172wh01	4_ENERGY_BLUE,{
	if(ep17_2_whouse < 2){
		mes "- The door is firmly locked with a padlock. -";
		close;
	}
	switch(ep17_2_whouse){
		case 2:
			mes "- The door is tightly locked. -";
			next;
			mes "- Clatters -";
			next;
			mes "[???]";
			mes "- W...who.. -";
			next;
			mes "- I can hear a slightly clearer voice than what I heard at the entrance. But I can't go down and check because I don't have a key. Let's go back and ask Chirp. -";
			erasequest 17343;
			setquest 17344;
			ep17_2_whouse = 3;
			close;
		case 3:
			mes "- I can hear a slightly clearer voice than what I heard at the entrance. But I can't go down and check because I don't have a key. Let's go back and ask Chirp. -";
			close;
		case 4:
			setpcblock PCBLOCK_ALL,true;
			showscript "Mr. "+strcharinfo(0)+" : I put three emergency keys in the lock and the door opened.";
			sleep2 1500;
			npctalk "Emergency door opens.","Lock#172wh01",bc_self;
			sleep2 1500;
			npctalk "Boundary level 1.","Lock#172wh01",bc_self;
			sleep2 1500;
			npctalk "Life protection.","Lock#172wh01",bc_self;
			sleep2 1500;
			npctalk "If a person is found injured, check the signs of life and perform rescue activities quickly.","Lock#172wh01",bc_self;
			setpcblock PCBLOCK_ALL,false;
			erasequest 17348;
			setquest 17349;
			ep17_2_whouse = 5;
			sleep2 2000;
			warp "ba_2whs02",338,332;
			end;
		default:
			break;
	}
	if(ep17_2_whouse > 8){
		warp "ba_2whs02",338,332;
		end;
	}
	end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17343) == 1 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17348) == 1 " );
	end;
}

ba_2whs02,37,312,3	script	Head#172wh01	HIDDEN_WARP_NPC,7,7,{
	switch(ep17_2_whouse){
		case 5:
			mes "[Head]";
			mes "Hey~ Who's there~";
			next;
			select("There's a noise coming out from this place...");
			mes "[Head]";
			mes "Master? Is that you? Come in! Why it took you this long?";
			next;
			mes "[Head]";
			mes "But... your face changed a lot? What happened? Where and what have you been doing?";
			next;
			select("I am not Varmundt.");
			mes "[Head]";
			mes "Then… who? Master? How did you enter in here?";
			next;
			select("I am a guest here.");
			mes "[Head]";
			mes "Guest? Oh, so you came to my master's invitation? I've never seen a guest before! Actually, it's my first time seeing another human being besides my master! Nice to meet you. Second human! I am T2WH-0448.";
			next;
			mes "[T2WH-0448]";
			mes "By the way, how's it going out these days? I woke up because of the noise. I've been asleep for a long time.";
			next;
			mes "[T2WH-0448]";
			mes "...Actually, I don't know anything about outside as well as these days. I don't know unless my master told me. I've been here all my life.";
			next;
			mes "[T2WH-0448]";
			mes "He said he'd take me outside when I finish later. He said he would connect me to other automatic dolls. That's why I've been waiting for my master to come.";
			next;
			mes "[T2WH-0448]";
			mes "It's been too long since the master came. How long have I been asleep?";
			next;
			mes "[T2WH-0448]";
			mes "But how did you get here? He said only the owner could come in here. Unless it's an emergency... Oh! Don't tell me the master is dead? Is he hurt? Is that why he couldn't come?";
			next;
			select("It's not like that...");
			mes "[T2WH-0448]";
			mes "Really? You're a descendant of the guests you visited a long time ago, and you're here to deal with the invaders? The second human being is kinda cool.";
			next;
			mes "[T2WH-0448]";
			mes "But you're saying that even here, the master hasn't come to the mansion for a long time? Is something wrong?";
			next;
			mes "[T2WH-0448]";
			mes "But why are you here? I'm picking the door with an emergency key. You can't just pick it up..";
			next;
			select("There's a strange noise from the basement.");
			mes "[T2WH-0448]";
			mes "Oh, the sound of me singing? You mistook me for a broken automatic doll? But what's that? That thing behind you?";
			next;
			mes "[T2WH-0448]";
			mes "You said it's broken, but why aren't you falling down and flashing? Why attack? The automatic dolls were not supposed to attack the guests.";
			next;
			select("The intruders broke them.");
			mes "[T2WH-0448]";
			mes "Really? But you brought it here? Why?";
			next;
			select("Wasn't it there originally?");
			mes "[T2WH-0448]";
			mes "No. There's nothing here. It was a completely clean area. You brought him in with you on your way in.";
			emotion ET_SWEAT, strcharinfo(0);
			next;
			select("I'm sorry. It seems like it came with me while the door got opened.");
			mes "[T2WH-0448]";
			mes "So now I have to be unable to move among those friends? If they hurt me, do I have to disappear like this without a single defense?";
			next;
			select("Shall we take him out?");
			mes "[T2WH-0448]";
			mes "No, you can't. The master left me here. So I have to stay here. Until the master comes.";
			next;
			mes "[T2WH-0448]";
			mes "But what about all of that? I don't want to disappear without even going outside.";
			next;
			mes "[T2WH-0448]";
			mes "You can protect me. That will do. So bring me some parts so I can build my body.";
			next;
			select("What?");
			mes "[T2WH-0448]";
			mes "If you brought him here, you should be responsible for it. I'll hide as much as I can so that they don't find me, but if they attack, I'll run away, even if I can't fight back";
			next;
			mes "[T2WH-0448]";
			mes "It's not working as it is. You can't make eye contact. I'm too small and fragile.";
			next;
			select("So how do you want me to do?");
			mes "[T2WH-0448]";
			mes "This is the place where the owner used to make things out of all the things he had collected. Just like I was born.";
			mes "So go around and find something that ^0000cd can build my body^000000.";
			next;
			mes "[T2WH-0448]";
			mes "Your emergency key can get you into the danger zone, so take a close look and get me a good one as soon as possible.";
			next;
			mes "[T2WH-0448]";
			mes "Just the body... the arms and legs, right? It's okay to have legs, but everyone seems to have arms too.";
			next;
			mes "[T2WH-0448]";
			mes "I'm sure there's a room down there that's good for the body, and somewhere that's good for the arms, and somewhere that's good for the legs. Unless the master moved it.";
			next;
			mes "[T2WH-0448]";
			mes "The closest <NAVI>[place is where the body is]<INFO>ba_2whs02,31,50,0,101,0</INFO></NAVI>, so go there first. Get me one quickly. I'm scared.";
			erasequest 17349;
			setquest 17350;
			ep17_2_whouse = 6;
			questinfo_refresh();
			close;
		case 6:
			mes "[T2WH-0448]";
			mes "The closest <NAVI>[place is where the body is]<INFO>ba_2whs02,31,50,0,101,0</INFO></NAVI>, so go there first. Get me one quickly. I'm scared.";
			close;
		case 7:
			mes "[T2WH-0448]";
			mes "Do you have it? Come on, put them together.";
			next;
			sleep2 10; //Prevents crash on client
			donpcevent strnpcinfo(0) + "::OnBar"; //Process Bar
			sleep2 2000;
			mes "[T2WH-0448]";
			mes "Are you all set? Where are you...";
			next;
			specialeffect EF_GUARD2,AREA,"Head#172wh01"; // EF_GUARD2
			classchange(4_M_BARMUND,"Head#172wh01",bc_self);	
			emotion ET_HUK, strcharinfo(0);
			mes "[T2WH-0448]";
			mes "How is it? Isn't it weird?";
			setquest 17354;
			erasequest 17354;
			next;
			select("Tha--that appearance is...?");
			mes "[T2WH-0448]";
			mes "You look like my master.";
			next;
			mes "[T2WH-0448]";
			mes "I really like it. Thank you. Now I'm also kinda relieved.";
			next;
			select("Go back and report to Chirp.");
			mes "[T2WH-0448]";
			mes "What's with your name? Is it an automatic doll? Or a human?";
			next;
			select("Ah, it' the upper floor's...");
			mes "[T2WH-0448]";
			mes "Really? All the old automatic dolls outside got that name? Then give me my name too. My master didn't make a name for me. It's just a serial number.";
			next;
			select("Suddenly like this?");
			mes "[T2WH-0448]";
			mes "Can't you name me? Can it only be done by special people? But you're a special guest.";
			next;
			mes "[T2WH-0448]";
			mes "Then there's nothing we can do. All I have to think about is... hmmm… how about this? Varmundt.";
			next;
			select("Eh??");
			mes "[T2WH-0448]";
			mes "Why? Is it weird? I don't know any name. How about 'basement gatekeeper'? Hmm... I'll have to think a little bit more about the name. I have to wait here until the master comes back anyway.";
			next;
			mes "[T2WH-0448]";
			mes "We can think about it while avoiding them. Or you can ask my master to name me when he comes back.";
			next;
			mes "[T2WH-0448]";
			mes "You said, you should go up and report to another automatic doll, right? Well, bye! Thank you for helping me.";
			delitem 1000101,3;
			erasequest 17353;
			setquest 17358;
			getitem 1000103,3;
			ep17_2_whouse = 8;
			close;
		case 8:
			mes "[T2WH-0448]";
			mes "Didn't you say that you should go up and report to another automatic doll? Can I just stay like this?";
			close;			
		default:
			end;
	}
	end;

OnBar:
    progressbar_npc "000000",2;
    end;
	
OnTouch:
	if(ep17_2_whouse < 8){
		classchange(4_GHOSTRING,"Head#172wh01",bc_self);
		end;
	}
	if(ep17_2_whouse > 7){
		classchange(4_M_BARMUND,"Head#172wh01",bc_self);
		end;
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17349) == 1 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17353) == 1 " );
	end;
}

ba_2whs01,110,217,3	script	Emergency Key#172wh01	CLEAR_NPC,4,4,{
	end;
	
OnTouch:
	if(isbegin_quest(17345) == 1){
		setpcblock PCBLOCK_ALL,true;
		classchange(4_ENERGY_YELLOW,"Emergency Key#172wh01",bc_self);
		showscript ""+strcharinfo(0)+" : She said there's an emergency key over here, but... Let's take a closer look under the map..";
		sleep2 1000;
		showscript ""+strcharinfo(0)+" : I found it!!!";
		sleep2 1000;
		getitem 1000102,1;
		if(countitem(1000102) > 2) {
			showscript ""+strcharinfo(0)+" : Now that we've found all the emergency keys, let's go and open the locked door.";
			setquest 17348;
		} else {
			showscript ""+strcharinfo(0)+" : Let's search for other emergency key.";
		}
		erasequest 17345;
		questinfo_refresh();
		setpcblock PCBLOCK_ALL,false;
		end;
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17345) == 1 " );
	end;
}

ba_2whs01,14,282,3	script	Emergency Key#172wh02	CLEAR_NPC,4,4,{
	end;
	
OnTouch:
	if(isbegin_quest(17346) == 1){
		setpcblock PCBLOCK_ALL,true;
		classchange(4_ENERGY_YELLOW,"Emergency Key#172wh02",bc_self);
		showscript ""+strcharinfo(0)+" : She said there's an emergency key over here, but… whoa, it's cold...";
		sleep2 1000;
		showscript ""+strcharinfo(0)+" : I found it!!!";
		sleep2 1000;
		getitem 1000102,1;
		if(countitem(1000102) > 2) {
			showscript ""+strcharinfo(0)+" : Now that we've found all the emergency keys, let's go and open the locked door.";
			setquest 17348;
		} else {
			showscript ""+strcharinfo(0)+" : Let's search for other emergency key.";
		}
		erasequest 17346;
		questinfo_refresh();
		setpcblock PCBLOCK_ALL,false;
		end;
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17346) == 1 " );
	end;
}

ba_2whs01,222,257,3	script	Emergency Key#172wh03	CLEAR_NPC,4,4,{
	end;
	
OnTouch:
	if(isbegin_quest(17347) == 1){
		setpcblock PCBLOCK_ALL,true;
		classchange(4_ENERGY_YELLOW,"Emergency Key#172wh03",bc_self);
		showscript ""+strcharinfo(0)+" : She said there's an emergency key over here, but... Let me put my hand in it...";
		sleep2 1000;
		showscript ""+strcharinfo(0)+" : I found it!!!";
		sleep2 1000;
		getitem 1000102,1;
		if(countitem(1000102) > 2) {
			showscript ""+strcharinfo(0)+" : Now that we've found all the emergency keys, let's go and open the locked door.";
			setquest 17348;
		} else {
			showscript ""+strcharinfo(0)+" : Let's search for other emergency key.";
		}
		erasequest 17347;
		questinfo_refresh();
		setpcblock PCBLOCK_ALL,false;
		end;
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17347) == 1 " );
	end;
}

ba_2whs02,31,50,3	script	Junk#172wh01	4_ENERGY_BLACK,{
	if(isbegin_quest(17351) == 1){
		showscript ""+strcharinfo(0)+" : I already found something useful for the body. Now, let's go find an arm.";
		end;
	}
	if(isbegin_quest(17350) == 1){
		setpcblock PCBLOCK_ALL,true;
		showscript ""+strcharinfo(0)+" : Let me see... It's good for the body...";
		sleep2 10; //Prevents crash on client
		donpcevent strnpcinfo(0) + "::OnBar"; //Process Bar
		sleep2 2000;
		showscript ""+strcharinfo(0)+" : I don't see the right thing. Let's look it up again.";
		erasequest 17350;
		setquest 17351;
		getitem 1000101,1;
		navigateto("ba_bath",129,82,NAV_ALL);
		setpcblock PCBLOCK_ALL,false;
		end;
	}
	showscript ""+strcharinfo(0)+" : I shouldn't touch these kind things.";
	end;

OnBar:
    progressbar_npc "000000",2;
    end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17350) == 1 " );
	end;	
}

ba_2whs02,128,82,3	script	Junk#172wh02	4_ENERGY_BLACK,{
	if(isbegin_quest(17352) == 1){
		showscript ""+strcharinfo(0)+" : I already found something useful for the arm. Now, let's go find a leg.";
		end;
	}
	if(isbegin_quest(17351) == 1){
		setpcblock PCBLOCK_ALL,true;
		showscript ""+strcharinfo(0)+" : Arm... arm... Where is the right thing...";
		sleep2 10; //Prevents crash on client
		donpcevent strnpcinfo(0) + "::OnBar"; //Process Bar
		sleep2 2000;
		showscript ""+strcharinfo(0)+" : I don't see the right thing. Let's look it up again.";
		sleep2 10; //Prevents crash on client
		donpcevent strnpcinfo(0) + "::OnBar"; //Process Bar
		sleep2 2000;
		showscript ""+strcharinfo(0)+" : Is this good enough with your arm? You'll be okay, right? Let's take it first. All we have to do is find the leg...";
		erasequest 17351;
		setquest 17352;
		getitem 1000101,1;
		navigateto("ba_bath",239,124,NAV_ALL);
		setpcblock PCBLOCK_ALL,false;
		end;
	}
	showscript ""+strcharinfo(0)+" : I'll just keep it pile up like this.";
	end;

OnBar:
    progressbar_npc "000000",2;
    end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17351) == 1 " );
	end;	
}

ba_2whs02,239,124,3	script	Junk#172wh03	4_ENERGY_BLACK,{
	if(isbegin_quest(17353) == 1){
		showscript ""+strcharinfo(0)+" : I already found everything. Let's go back.";
		end;
	}
	if(isbegin_quest(17352) == 1){
		setpcblock PCBLOCK_ALL,true;
		showscript ""+strcharinfo(0)+" : All I need is a leg. Let's see...";
		sleep2 10; //Prevents crash on client
		donpcevent strnpcinfo(0) + "::OnBar"; //Process Bar
		sleep2 2000;
		showscript ""+strcharinfo(0)+" : You'll be satisfied with this leg, right? Let's go back.";
		erasequest 17352;
		setquest 17353;
		getitem 1000101,1;
		ep17_2_whouse = 7;
		navigateto("ba_bath",37,312,NAV_ALL);
		setpcblock PCBLOCK_ALL,false;
		end;
	}
	showscript ""+strcharinfo(0)+" : Isn't this dangerous?";
	end;

OnBar:
    progressbar_npc "000000",2;
    end;

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17352) == 1 " );
	end;	
}

//Bath
ba_in01,384,38,3	script	Gentleman#172ba01	4_EP17_BUCKETS,5,5,{
	switch(ep17_2_bath){
		case 0:
			cloakoffnpc "Denny#172ba01", getcharid(0);
			cloakoffnpc "Magenta#172ba01", getcharid(0);
			cloakoffnpc "Zion#172ba01", getcharid(0);
			cloakoffnpc "Rookie#172ba01", getcharid(0);
			cloakoffnpc "Molar#172ba01", getcharid(0);
			cloakoffnpc "Canine#172ba01", getcharid(0);
			cloakoffnpc "Danae#172ba01", getcharid(0);
			cutin "ep172_beta.bmp", 2;
			mes "[Gentleman]";
			mes "I'm sorry. It's Barmund's policy to quarantine guests from ^0000cd dangerous situations^000000. Please wait a little longer.";
			npctalk "Why does it take so long to search? Let us in. We can find it faster.","Denny#172ba01",bc_self;
			npctalk "We're experts in this field.","Molar#172ba01",bc_self;
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Magenta]";
			mes "Let's not just keep it to ourselves about danger, let's get it together.";
			npctalk "Time goes by while we're stopping here.","Canine#172ba01",bc_self;
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Gentleman]";
			mes "Sorry, we haven't figured it out yet. The search is aimed at investigating the existence of risk factors. Please wait a little longer. Please understand this procedure.";
			npctalk "We're gonna hold him responsible if something happens to my child!","Zion#172ba01",bc_self;
			npctalk "We have that procedure! You're interrupting us!","Denny#172ba01",bc_self;
			next;
			mes "[Gentleman]";
			mes "Once again, you can't go in unless your safety is confirmed. I'll be right back once I hear from ^0000cdmy colleague^000000.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I told you to cooperate with the mansion's automatic dolls as much as possible, but if you don't leave until the end, we have no choice but to use force, right?";
			next;
			switch(select("Mr. Rookie? What's wrong?:It looks complicated, so let's just pass it.")){
				case 1:
					cutin "16loo_02.bmp", 2;
					mes "[Rookie]";
					mes "Oh, Mr. Adventurer is also here. I'm afraid you can't use it for a while if you're here to take a bath. Look at that. That automatic doll blocking the door.";
					next;
					mes "[Zion]";
					mes "There's a ghost coming out of here. Be careful with yourself.";
					next;
					select("Ghost??");
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "I don't know who it is yet. As you know, as soon as we got into the mansion, we were all scattered to explore the facilities.";
					mes "The scout team, who went out to check for possible remains of illusion in the bathhouse, came back shocked. ^0000cdThere's something in the bathroom^000000.";
					npctalk "It's not a ghost, it's a conspiracy around a mansion!","Denny#172ba01",bc_self;
					npctalk "It's a ghost. It has to be a ghost!","Magenta#172ba01",bc_self;
					npctalk "There's something. That's scary. I'm kinda excited.","Zion#172ba01",bc_self;
					next;
					cutin "16loo_03.bmp", 2;
					mes "[Rookie]";
					mes "I had to figure out what was really happening, what was Ilusion's weird prank, so this time, ^0000cd Goni went^000000. It's perfect to move silently by himself.";
					next;
					select("But why here...?");
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "That is... it's been a while since Goni went in, but he hasn't come out. If strong like Goni's  doesn't come out after the time limit, that means there is a problem.";
					next;
					mes "[Rookie]";
					mes "I'm here to follow the procedure to find out what the dangerous goods are, because I'm certain that there are unknown risks. We can't let unknown risks interfere with our mission in this mansion.";
					npctalk "Is there any?","Danae#172ba01",bc_self;
					next;
					cutin "16loo_03.bmp", 2;
					mes "[Rookie]";
					mes "Strength put in is lost... Now that it's done, we should be more careful. As you can see, he's blocking us.";
					npctalk "Is Goni just expandable? You're too cold to say lose.","Molar#172ba01",bc_self;
					npctalk "He's alive and well. That's what my gut tells me.","Denny#172ba01",bc_self;
					npctalk "Let's hurry in and find it. Mr. Adventurer is here so we can find him faster!","Magenta#172ba01",bc_self;
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Gentleman]";
					mes "I'm sorry. We're searching now. When you're done, you listen and decide.";
					next;
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "There are certain dangers in this mansion now. It's a very important question for us whether it's just that or more.";
					next;
					mes "[Rookie]";
					mes "We need to check first to see if the danger is supernatural or  ^0000cd illusion^000000. Can I tell you more? Maybe that's why illusion came to this mansion for it.";
					mes "Otherwise, it's likely to fall into the hands of illusion.";
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Gentleman]";
					mes "I fully understand what you're saying. But the procedure is...";
					mes "Oh! They're coming just in time to search. Why don't you talk to him.";
					next;
					cutin "ep172_beta.bmp", 0;
					sleep2 500;
					cloakoffnpc "Boiler#172ba01", getcharid(0);
					cloakoffnpc "Sweepy#172ba01", getcharid(0);
					mes "[Boiler]";
					mes "You're wrong. You're all wrong. I told you there's no danger.";
					next;
					cutin "ep172_beta.bmp", 1;
					mes "[Sweepy]";
					mes "There were no guests who said to be missing. Did they really go in there?";
					npctalk "Nooo! How! How can you  not even know the risks of the place you're managing!","Denny#172ba01",bc_self;
					npctalk "lot of people saw it.","Zion#172ba01",bc_self;
					next;
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "Were there really no missing persons in there?";
					next;
					cutin "ep172_beta.bmp", 0;
					mes "[Sweepy]";
					mes "Maybe they run away.";
					npctalk "He's been through a lot.","Boiler#172ba01",bc_self;
					next;
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "If they did, they would have come back earlier. Otherwise, they had been contacted by our crew, who are densely packed around the mansion.";
					next;
					select("Any guess of what happened?");
					cutin "ep172_beta.bmp", 2;
					mes "[Gentleman]";
					mes "Of all the things you've said, I suspect the most is the intruders.";
					next;
					cutin "ep172_beta.bmp", 0;
					mes "[Boiler]";
					mes "Gentleman, Isn't that it? Long and dark green ^0000cdhair^000000. It's been around for a long time.";
					npctalk "Hair... there's a possibility. It doesn't match anything in the bathhouse.","Sweepy#172ba01",bc_self;
					next;
					select("Hair?");
					cutin "ep172_beta.bmp", 2;
					mes "[Gentleman]";
					mes "That's exactly what Boiler said. From a very long time ago, unknown hair was often found. Perhaps the hair and the risk factors in this bath are the same.";
					npctalk "Why are you talking about that now?","Denny#172ba01",bc_self;
					next;
					cutin "ep172_beta.bmp", 1;
					mes "[Sweepy]";
					mes "I think it will be better if we let human guests go in there and search the place by themselves.";
					mes "We can’t even detect the dangers and could not even find human guests. Maybe we can’t feel it because we are not human.";
					next;
					cutin "ep172_beta.bmp", 0;
					mes "[Boiler]";
					mes "Right. There is what you call human sense. Maybe they can find what automatic dolls are missing. I guess finally we could find the truth about that hair.";
					next;
					cutin "ep172_beta.bmp", 1;
					mes "[Sweepy]";
					mes "We heard about the characteristics of the missing person, but human guests may know something more about characteristics that they can find.";
					npctalk "Here is an automatic doll that can think.","Zion#172ba01",bc_self;
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Gentleman]";
					mes "......you have a point. Okay.";
					mes "We will now open our bath house for you guys. There's suspicion that there is an unknown creature, so be extra careful while you search the premises.";
					next;
					mes "[Gentleman]";
					mes "If you see a monster while using it, don't try to contact it but just tell us. Also tell us if you found the missing person.";
					next;
					mes "[Gentleman]";
					mes "Ok then, I will escort you inside.";
					npctalk "They fight by themselves and suddenly decide on their own.","Denny#172ba01",bc_self;
					next;
					mes "[Gentleman]";
					mes "Ahh, one reminder before entering. Skills that use water, such as ^EE0000water ball and holy water generation^000000, are prohibited in Meditathio, a large bath here, for facility protection and management.";
					mes "Thank you for your understanding.";
					next;
					cutin "ep172_beta.bmp", 255;
					mes "[Magenta]";
					mes "Hey... hmm, Lucky. Hmm... hmm... don't get me wrong. Is it better Lucky would just stay here?";
					npctalk "Yeah, right. We will go after Goni. You better stay.","Zion#172ba01",bc_self;
					next;
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "What are you saying. I could find a missing thing better than you guys. I am weak in external missions but I can protect myself. Am I that unreliable?";
					next;
					cutin "16loo_03.bmp", 255;
					mes "[Magenta]";
					mes "No!! Lucky is really great! The best!! We can’t live without Lucky! However...";
					next;
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "Ahh. I will just sneak a peek. Okay. Then I will search near the entrance. We have to check who is entering or what since we have only one entrance.";
					next;
					select("I will go with you.");
					cutin "16loo_02.bmp", 2;
					mes "[Rookie]";
					mes "I feel safe that Mr. Adventurer would come along. Hurry let's go. If you find something <NAVI>[inside]<INFO>ba_bath,165,43,0,101,0</INFO></NAVI>, send me a signal.";
					mes "Okay then, let's meet up inside.";
					setquest 17363;
					ep17_2_bath = 1;				
					cloakonnpc "Denny#172ba01", getcharid(0);
					cloakonnpc "Magenta#172ba01", getcharid(0);
					cloakonnpc "Zion#172ba01", getcharid(0);
					cloakonnpc "Rookie#172ba01", getcharid(0);
					cloakonnpc "Molar#172ba01", getcharid(0);
					cloakonnpc "Canine#172ba01", getcharid(0);
					cloakonnpc "Danae#172ba01", getcharid(0);
					cloakonnpc "Boiler#172ba01", getcharid(0);
					cloakonnpc "Sweepy#172ba01", getcharid(0);
					close3;
				case 2:
					cutin "ep172_beta.bmp", 2;
					mes "[Gentleman]";
					mes "If that's the case, we have no choice but to call the security.";
					next;
					cutin "16loo_03.bmp", 2;
					mes "[Rookie]";
					mes "Hmm... how can we do this.";
					close3;
			}
		case 1:
			break;
		default:
			break;
	}
	cutin "ep172_beta.bmp", 2;
	mes "[Gentleman]";
	mes "Sorry, but the bathhouse is currently closed due to internal conditions. Please come back later.";
	mes "If you want a quiet bath, use the private bathroom attached to your room.";
	next;
	mes "^EE0000[?Precautions?]^000000";
	mes "Skills that use water, such as water ball and holy water generation, are prohibited in Meditathio, a large bath here, for facility protection and management.";
	close3;
	
OnTouch:
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_main > 8 && isbegin_quest(17363) == 0 && ep17_2_bath == 0 " );
	end;
}

ba_bath,165,43,3	script	Gentleman#172ba02	4_EP17_BUCKETS,5,5,{
	if(ep17_2_bath == 5){
		cutin "ep172_beta.bmp", 2;
		mes "[Gentleman]";
		mes "Mr. Adventurer, you also go to the <NAVI>[lounge]<INFO>ba_bath,203,58,0,101,0</INFO></NAVI>.";
		close3;
	}
	cutin "ep172_beta.bmp", 2;
	mes "[Gentleman]";
	mes "This bathhouse in the Varmundt mansion has long been very popular. Varmundt was a man who took a break at the end of a hard day.";
	next;
	mes "[Gentleman]";
	mes "He liked the bath time, which was good for relieving the fatigue of the day, gaining energy for tomorrow, organizing thoughts, good for blood circulation and for rehydration.";
	next;
	mes "[Gentleman]";
	mes "I am very interested in bathing methods everywhere, and as I expanded the baths, it became such a large bath. For this reason, I used it to guests who visited the mansion and praised the facilities of this bathhouse.";
	next;
	mes "[Gentleman]";
	mes "Because of that, the mansion's bathhouse became very popular. I hope you will relieve all your fatigue in this historic bathhouse.";
	close3;
	
OnTouch:
	switch(ep17_2_bath){
		case 1:
			cloakoffnpc "Denny#172ba02", getcharid(0);
			cloakoffnpc "Magenta#172ba02", getcharid(0);
			cloakoffnpc "Zion#172ba02", getcharid(0);
			cloakoffnpc "Rookie#172ba02", getcharid(0);
			cloakoffnpc "Molar#172ba02", getcharid(0);
			cloakoffnpc "Canine#172ba02", getcharid(0);
			cloakoffnpc "Danae#172ba02", getcharid(0);
			cutin "ep172_beta.bmp", 0;
			mes "[Gentleman]";
			mes "Welcome. Your companions are already here.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Is everybody here? In pairs, follow the procedure for searching for dangerous goods and searching for missing persons. Signal when you find them, and the assembly place is in the lounge.";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "We should focus on searching for dangerous goods rather than searching for missing persons. The identity of the dangerous thing has not been revealed, and it's human beings, monsters, automatic dolls, supernatural beings, all the evidence and circumstantial evidence.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Human beings are likely to be individuals or groups as the remains of illusion or third figures. There is a possibility of using a separate exit other than what is known, so focus on checking the facilities. Denny and Canine take over.";
			npctalk "Okay.","Denny#172ba02",bc_self;
			npctalk "Let's go.","Canine#172ba02",bc_self;
			next;
			sleep2 500;
			cloakonnpc "Denny#172ba02", getcharid(0);
			cloakonnpc "Canine#172ba02", getcharid(0);
			mes "[Rookie]";
			mes "Next, monster. Since it's a bathhouse, it's assumed that monsters are aquatic creatures, or something like them, so focus on baths and pipes. Zion and Danae, check it out.";
			npctalk "Leave it to me.","Zion#172ba02",bc_self;
			npctalk "All right!","Danae#172ba02",bc_self;
			next;
			sleep2 500;
			cloakonnpc "Danae#172ba02", getcharid(0);
			cloakonnpc "Zion#172ba02", getcharid(0);
			mes "[Rookie]";
			mes "If it is a broken automatic doll, it will know about this mansion well, so you'll have to listen to the bath managers first. I'll do this.";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Last but not least, if it's a ghost...";
			next;
			cutin "16loo_03.bmp", 255;
			mes "[Magenta]";
			mes "I know! The ceiling! The drain! I'll see!";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "... Okay. Magenta. Molar will go also.";
			npctalk "Okay.","Molar#172ba02",bc_self;
			next;
			sleep2 500;
			cloakonnpc "Magenta#172ba02", getcharid(0);
			cloakonnpc "Molar#172ba02", getcharid(0);
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Mr. Adventurer and I will meet the managers to see if there's anything suspicious sighting with other automatic dolls. I need to get the blueprints first...";
			next;
			sleep2 500;
			specialeffect EF_DRAGONSMOKE,AREA,"Rookie#172ba02"; //373
			specialeffect EF_PEONG,AREA,"Rookie#172ba02"; //411
			cutin "16loo_01.bmp", 255;
			mes "Eeekkk-";
			next;
			sleep2 500;
			specialeffect EF_DRAGONSMOKE,AREA,"Rookie#172ba02"; //373
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "But I'll have to start with this ^0000cd steam^000000. It's blurry and you can’t see something.";
			next;
			select("I will go to the boiler room.");
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Do you want to? I'm here to get a blueprint from Mr. Gentleman. Mr. Adventurer, please go to the <NAVI>[boiler room]<INFO>ba_bath,286,68,0,101,0</INFO></NAVI> and ask them to shut down the boiler. I'll be right with you.";
			erasequest 17363;
			setquest 17364;
			ep17_2_bath = 2;
			questinfo_refresh();
			close3;
		case 2:
			cloakoffnpc "Rookie#172ba02", getcharid(0); //Just in-case the server restarted
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I'll get a blueprint from Mr. Gentleman here. Mr. Adventurer, please go to the <NAVI>[boiler room]<INFO>ba_bath,286,68,0,101,0</INFO></NAVI> and ask them to shut down the boiler. I'll be right with you.";
			close3;
		case 4:
			cloakoffnpc "Rookie#172ba02", getcharid(0); //Just in-case the server restarted
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "He usually goes on a mission alone, but I haven't seen him without report for this long. That's why everyone is looking for him. Something happened. Come on, think about something else.";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Gentleman]";
			mes "Even if you say so, I have nothing more to say.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Oh? Mr. Adventurer? I think the boiler has stopped, where are you going?";
			next;
			select("You said we should go to the lake?");
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Who said? …Me? Mr. Adventurer, are you sure ^0000cd you saw me for real^000000?";
			next;
			select("Come to think of it...");
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "The way he spoke seemed stiff and flustered... Definitely ^0000cd not me^000000. I guess it's an unknown thing that appears in this bathhouse.";
			mes "That's a headache. I can't believe you showed up in the same way as anyone else. No, in a way, it's better than that.";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "From what I told you to go to the lake, I think you tried to get him out of the bathroom somehow. So it's not supernatural.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Whatever it is, we need to clear it up before it falls into even greater chaos.";
			next;
			cutin "16loo_01.bmp", 255;
			mes "Eeekkkkkk-";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Mr. Adventurer, you also go to the <NAVI>[lounge]<INFO>ba_bath,203,58,0,101,0</INFO></NAVI>.";
			erasequest 17366;
			setquest 17367;
			ep17_2_bath = 5;
			cloakonnpc "Rookie#172ba02", getcharid(0);
			cloakoffnpc "Rookie#172ba04", getcharid(0);
			cloakoffnpc "Magenta#172ba03", getcharid(0);
			cloakoffnpc "Molar#172ba03", getcharid(0);
			questinfo_refresh();
			close3;
		case 5:
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Mr. Adventurer, you also go to the <NAVI>[lounge]<INFO>ba_bath,203,58,0,101,0</INFO></NAVI>.";
			close3;
		default:
			break;
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_bath == 1 && isbegin_quest(17363) == 1 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17366) == 1 " );
	end;
}

//Static NPC's for quest and etc.
ba_in01,383,41,5	duplicate(dummy_cloaked_npc)	Denny#172ba01	4_M_REBELLION3
ba_bath,163,43,5	duplicate(dummy_cloaked_npc)	Denny#172ba02	4_M_REBELLION3
ba_bath,201,58,5	duplicate(dummy_cloaked_npc)	Denny#172ba03	4_M_REBELLION3
ba_bath,281,298,7	duplicate(dummy_cloaked_npc)	Denny#172ba04	4_M_REBELLION3
ba_bath,285,299,5	duplicate(dummy_cloaked_npc)	Denny#172ba05	4_M_REBELLION3
ba_in01,379,42,5	duplicate(dummy_cloaked_npc)	Magenta#172ba01	4_M_GUNSLINGER2
ba_bath,167,40,1	duplicate(dummy_cloaked_npc)	Magenta#172ba02	4_M_GUNSLINGER2
ba_bath,204,56,1	duplicate(dummy_cloaked_npc)	Magenta#172ba03	4_M_GUNSLINGER2
ba_bath,154,303,5	duplicate(dummy_cloaked_npc)	Magenta#172ba04	4_M_GUNSLINGER2
ba_bath,285,294,1	duplicate(dummy_cloaked_npc)	Magenta#172ba05	4_M_GUNSLINGER2
ba_bath,287,298,3	duplicate(dummy_cloaked_npc)	Magenta#172ba06	4_M_GUNSLINGER2
ba_in01,379,38,5	duplicate(dummy_cloaked_npc)	Molar#172ba01	4_M_REBELLION
ba_bath,165,40,7	duplicate(dummy_cloaked_npc)	Molar#172ba02	4_M_REBELLION
ba_bath,200,57,7	duplicate(dummy_cloaked_npc)	Molar#172ba03	4_M_REBELLION
ba_bath,283,300,5	duplicate(dummy_cloaked_npc)	Molar#172ba04	4_M_REBELLION
ba_in01,385,41,3	duplicate(dummy_cloaked_npc)	Canine#172ba01	4_F_REBELLION3
ba_bath,163,39,7	duplicate(dummy_cloaked_npc)	Canine#172ba02	4_F_REBELLION3
ba_bath,204,54,1	duplicate(dummy_cloaked_npc)	Canine#172ba03	4_F_REBELLION3
ba_bath,281,295,7	duplicate(dummy_cloaked_npc)	Canine#172ba04	4_F_REBELLION3
ba_in01,381,39,5	duplicate(dummy_cloaked_npc)	Rookie#172ba01	4_M_ROOKIE
ba_bath,283,295,7	duplicate(dummy_cloaked_npc)	Rookie#172ba05	4_M_ROOKIE
ba_bath,283,298,5	duplicate(dummy_cloaked_npc)	Rookie#172ba06	4_M_ROOKIE
ba_in01,379,36,7	duplicate(dummy_cloaked_npc)	Danae#172ba01	4_F_REBELLION2
ba_bath,162,43,5	duplicate(dummy_cloaked_npc)	Danae#172ba02	4_F_REBELLION2
ba_bath,202,54,7	duplicate(dummy_cloaked_npc)	Danae#172ba03	4_F_REBELLION2
ba_bath,283,293,7	duplicate(dummy_cloaked_npc)	Danae#172ba04	4_F_REBELLION2
ba_bath,284,297,7	duplicate(dummy_cloaked_npc)	Gentleman#172ba03	4_EP17_BUCKETS
ba_in01,384,40,3	duplicate(dummy_cloaked_npc)	Boiler#172ba01	4_EP17_BASIC_B
ba_bath,289,65,5	duplicate(dummy_cloaked_npc)	Boiler#172ba03	4_EP17_BASIC_B
ba_bath,282,297,5	duplicate(dummy_cloaked_npc)	Boiler#172ba04	4_EP17_BASIC_B
ba_bath,280,297,5	duplicate(dummy_cloaked_npc)	Sweepy#172ba03	4_EP17_CLEANER
ba_in01,385,37,3	duplicate(dummy_cloaked_npc)	Sweepy#172ba01	4_EP17_CLEANER
ba_bath,285,297,7	duplicate(dummy_cloaked_npc)	Goni#172ba01	4_M_GONY
ba_bath,282,296,7	duplicate(dummy_cloaked_npc)	Goni#172ba02	4_M_GONY
ba_bath,284,67,5	duplicate(dummy_cloaked_npc)	Valve#172ba01	4_EP17_CLEANER_W
ba_bath,289,64,5	duplicate(dummy_cloaked_npc)	Valve#172ba02	4_EP17_CLEANER_W
ba_in01,383,36,7	duplicate(dummy_cloaked_npc)	Zion#172ba01	4_F_REBELLION3
ba_bath,163,41,7	duplicate(dummy_cloaked_npc)	Zion#172ba02	4_F_REBELLION3
ba_bath,201,55,7	duplicate(dummy_cloaked_npc)	Zion#172ba03	4_F_REBELLION3
ba_bath,287,295,7	duplicate(dummy_cloaked_npc)	Zion#172ba04	4_F_REBELLION3
//End of Static NPC

ba_bath,166,42,3	script	Rookie#172ba02	4_M_ROOKIE,{
	if(ep17_2_bath == 2){
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "I'll get the blueprint from Mr. Gentleman. Mr. Adventurer, please go to the <NAVI>[boiler room]<INFO>ba_bath,286,68,0,101,0</INFO></NAVI> and ask them to shut down the boiler. I'll be right with you.";
		close3;
	}
	end;

OnInit:
	cloakonnpc strnpcinfo(0);
	end;
}

ba_bath,288,68,3	script	Sweepy#172ba02	4_EP17_CLEANER,{
	if(ep17_2_bath > 13){
		cutin "ep172_beta.bmp", 2;
		mes "[Sweepy]";
		mes "What's going on? Do we still have a story to hear? Haven't you cleared up all your questions about the monster?";
		next;
		cutin "ep172_beta.bmp", 255;
		select("I just wanted to talk to you.");
		cutin "ep172_beta.bmp", 2;
		mes "[Sweepy]";
		mes "What do you want to talk about? All I have to talk about is cleaning. Are you curious about cleaning?";
		mes "Hygiene is very important here because it's a public bath. In addition to regular daily cleaning, I do it as often as necessary.";
		next;
		mes "[Sweepy]";
		mes "Automatic cleaning dolls sweep foreign substances and dirt all over the place. The basic policy is to send all the guests out when cleaning, but if you want to continue taking a bath, you should not bother.";
		next;
		mes "[Sweepy]";
		mes "However, the automatic dolls that came out for cleaning are very dangerous for the purpose of cleaning, so I recommend you not to approach them as closely as possible.";
		mes "Actually, the cleaning robot wasn't as strong as it is now. The measure was taken inevitably because of an intruder.";
		next;
		cutin "ep172_beta.bmp", 255;
		select("Because of an intruder?");
		cutin "ep172_beta.bmp", 2;
		mes "[Sweepy]";
		mes "Maybe they have seen that intruder before. When they found out I was in the bath, their eyes turned upside down and they came in swarms. I didn't let them in, but they came in by force.";
		next;
		mes "[Sweepy]";
		mes "Anywhere they can fit their body in, such as water pipes and drains, it came through. And so did the fish from the lake.";
		mes "Thanks to them, cleaning became more difficult. The intruder even interfered with cleaning. He didn't cooperate at all in cleaning.";
		next;
		mes "[Sweepy]";
		mes "This is a bathhouse. Hygiene should be the top priority. The function of automatic dolls cleaning in natural order has been strengthened.";
		next;
		mes "[Sweepy]";
		mes "The intruder took a step back but not completely eradicated. Therefore, the cleaning robot has no choice but to remain intact. So be careful when it's time to clean.";
		next;
		cutin "ep172_beta.bmp", 255;
		select("Did they bother you a lot?");
		cutin "ep172_beta.bmp", 2;
		mes "[Sweepy]";
		mes "I don't know anything about human desires.";
		mes "However, humans need a bath and space and cleaning to take a bath. The mission given to me is cleaning. That's all I know.";
		next;
		mes "[Sweepy]";
		mes "There were two groups of intruders. Obsessed with bathing or facilities. What they had in common was that they were obsessed with something.";
		next;
		mes "[Sweepy]";
		mes "The bath-obsessed humans did not cooperate in cleaning, and the facility-obsessed humans destroyed facilities and automatic dolls.";
		mes "Boiler also ripped damaged pipes and disassembled the automatic dolls. They say they don't know how long it will take to recover. Things aren't much different elsewhere, so the whole mansion is like this.";
		next;
		mes "[Sweepy]";
		mes "What is the biggest feature that distinguishes guests from intruders? Why do guests and intruders have different behavior patterns? How do humans tell the difference between the two?";
		next;
		mes "[Sweepy]";
		mes "As an automatic doll, I think it's natural that we don't know much because we've only been in contact with guests.";
		mes "We can't feel things that humans can feel for granted. I don't even know the touch of the tip of my hand.";
		next;
		mes "[Sweepy]";
		mes "But even if I don't know that, I don't have a problem with my work. I can clean up. I can carry out the mission given to me. What is designated as trash can be swept away as it appears.";
		next;
		mes "[Sweepy]";
		mes "Human beings are human, automatic dolls are automatic.";
		next;
		mes "[Sweepy]";
		mes "Hmmm... but I'd be happy if the human guest, Mr. "+strcharinfo(0)+" , could help me with one thing. Are you interested?";
		next;
		switch(checkquest(17379,HUNTING)){
			case -1:
				switch( checkquest(17380, PLAYTIME) ) {
					case -1:
						.@color$ = "^000000";
						.@started_quest$ = "[Daily] ";
						break;
					case 0:
					case 1:
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[Wait] ";
						break;
					case 2:
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[Ready] ";
						break;
				}
				break;
			case 0:
			case 1:
				.@color$ = "^8C8C8C";
				.@started_quest$ = "[In Progress] ";
				break;
			case 2:
				.@color$ = "^8C8C8C";
				.@started_quest$ = "[Completed] ";
				break;
		}
		switch(select(""+.@color$+""+.@started_quest$+"It's my pleasure^000000.:I'm kinda busy.")){
			case 1:
				switch( checkquest(17380, PLAYTIME) ) {
					case -1:
						break;
					case 0:
					case 1:
						mes "[Sweepy]";
						mes "Thank you for today. For the meantime, enjoy your stay in the bath.";
						mes "Come back later after dawn.";
						close3;
					case 2:
						erasequest 17380;
						break;
						
				}
				switch( checkquest(17379, HUNTING) ) {
					case -1:
						mes "[Sweepy]";
						mes "Okay then, could you eliminate ^0000cd 15 hot water mark and 15 hot water pirania^000000. These are the ones that make the bathhouse dirty.";
						next;
						mes "[Sweepy]";
						mes "The mansion is out of hand so we have to handle it on our own. We remove it on sight but there are too many of them. We can't do it like this because it's a matter of hygiene and safety. So please.";
						setquest 17379;
						close3;
					case 0:
					case 1:
						mes "[Sweepy]";
						mes "Are you done?";
						mes "These are the ones that make the bathhouse dirty.";
						next;
						mes "[Sweepy]";
						mes "Please come back once you're done.";
						close3;
					case 2:
						mes "[Sweepy]";
						mes "Thank you for today! The bath is now cleaner.";
						next;
						mes "[Sweepy]";
						mes "Please enjoy your stay in the bath.";
						erasequest 17379;
						setquest 17380;
						getitem 1000103,3;
						close3;
				}
			case 2:
				mes "[Sweepy]";
				mes "Enjoy your stay in the bath. I'll do some cleaning first.";
				close3;
		}
	
	}
	cutin "ep172_beta.bmp", 2;
	mes "[Sweepy]";
	mes "So what is it? You came to me because it is something to do with Boiler, right?";
	close3;
	
OnInit:
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_bath > 13 && ( checkquest(17380,PLAYTIME) == 2 || checkquest(17380,PLAYTIME) == -1 ) && checkquest(17379,HUNTING) == -1 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " checkquest(17379,HUNTING) == 2 " );
	end;
}

ba_bath,286,68,5	script	Boiler#172ba02	4_EP17_BASIC_B,{
	switch(ep17_2_bath){
		case 2:
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Hey, human guests should not be in this place. They are fragile.";
			next;
			select("I have something to do.");
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Hmm... No choice. Then be careful of the pipes. If you touch it, you might melt.";
			mes "So what's your errand? I can’t give you much time.";
			next;
			select("Please shut down the boiler.");
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Boiler? I already ^0000cdshut it down^000000? It’s strange. Steam is still coming out? Boiler is not running? Hey, look. I am on maintenance while it was off.";
			mes "Is it because the water has not cooled yet? Anyway I turned the boiler off.";
			next;
			sleep2 500;
			cloakonnpc "Boiler#172ba02", getcharid(0);
			cloakoffnpc "Boiler#172ba03", getcharid(0);
			mes "[Boiler]";
			mes "I think it will fit right here. Oh... It’s not perfect but it works.";
			next;
			sleep2 500;
			cloakonnpc "Boiler#172ba03", getcharid(0);
			cloakoffnpc "Boiler#172ba02", getcharid(0);
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Have you seen a lot of things like this on the way?";
			next;
			select("No. It’s my first time seeing it.");
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Umm... I picked it up on the way here, but it looks just like an automatic doll part. There are so many outside, so I thought it was here also. If it was here, I would pick it up and use it for repair.";
			next;
			mes "[Boiler]";
			mes "Anyway broken automatic dolls came out over and over even if we remove it? Tell me. Is one of the errors a self duplication?";
			mes "Oh. Sweepy doesn’t clean it properly. Anyway we needed it. I have to say thank you.";
			npctalk "I clean it often but the numbers are too many.","Sweepy#172ba02",bc_self;
			next;
			mes "[Boiler]";
			mes "... so you’re not going? Boiler is off. You came to say that right?";
			next;
			select("Isn’t it an automatic doll?");
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "What? You mean the monster?";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Sweepy]";
			mes "Probably not. Haven’t you thought that if it was an automatic doll, we would know it at first sight?";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Mess outside is because of the intruders... They don't have choice but to deal with it.";
			npctalk "Sweepy#172ba02","Crazy intruder. Intruders have destroyed many places and some us have been destroyed. We are still in recovery.",bc_self;
			next;
			select("So what do you think monster is?");
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Maybe it is the ^0000cdspector in the boiler^000000.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Sweepy]";
			mes "What are you saying?";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Spector. You don't know Spector? Mr. "+strcharinfo(0)+", you know? It is something that died and what’s inside of it, going around without shape.";
			mes "What happens here is very similar to what the humans talk about.";
			next;
			select("Then, it is a ghost...");
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Umm... Maybe not? Ah~ You thought it was a human ghost. That's not it, There was the automatic doll that managed the boiler here before I even came.";
			mes "Back then, it was a boiler for a small bath, and it was often overloaded to pour water from so many baths. It could not withstand high pressure and temperature.";
			next;
			mes "[Boiler]";
			mes "Anyway, it exploded when they were fixing it and the automatic doll got burned out also. Maybe it’s that automatic doll.";
			mes "I’m wondering if the data was engraved in some mysterious way inside this boiler.";
			next;
			mes "[Boiler]";
			mes "This boiler sometimes moves alone without anyone touching it. It seems that the data of the automatic doll from the past remains and continues to execute orders.";
			mes "Then it makes sense now to hear the sound without anything. It can also show strange shapes because it also spits out steam.";
			next;
			select("That’s scary.");
			cloakoffnpc "Valve#172ba01", getcharid(0);
			cutin "ep172_beta.bmp", 1;
			mes "[Boiler]";
			mes "Scary. Valve here, thinks she is a boiler. Is she scary too? Valve, look here.";
			next;
			sleep2 500;
			specialeffect EF_PEONG,AREA,"Valve#172ba01"; //411
			cutin "ep172_omega.bmp", 4;
			mes "[Valve]";
			mes "Chee--eek-";
			next;
			cloakonnpc "Valve#172ba01", getcharid(0);
			cutin "ep172_beta.bmp", 2;
			mes "[Sweepy]";
			mes "Boiler’s ghost, do you think it makes sense? It may be because of a problem we haven’t found yet. But maybe because we are automatic dolls.";
			next;
			mes "[Sweepy]";
			mes "We think there must be something we miss because we cannot hear the signs or sound that human guests hear and feel.";
			next;
			mes "[Sweepy]";
			mes "But in the end, we didn’t even notice the existence of the problem. Problems that we probably don’t find because of our limitations.";
			mes "That’s why I suggested we find a problem with the guests.";
			next;
			mes "[Sweepy]";
			mes "Honestly, we didn’t know what was weird because there were no guests for a long time. It wasn’t until human guests came in that it was reasonable to note the differences between humans and us automatic dolls.";
			next;
			mes "[Sweepy]";
			mes "I heard that humans have developed senses and emotions. And the ability to put all that together.";
			mes "We only collect information and come to a conclusion, but humans are different. I’ve heard that they combine their personal experiences, thoughts, and imaginations.";
			next;
			mes "[Sweepy]";
			mes "I hope we can solve the problem..";
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Boiler]";
			mes "I turned off the boiler. Tell the <NAVI>[other guests]<INFO>ba_bath,270,94,0,101,0</INFO></NAVI> to feel free to search the area.";
			erasequest 17364;
			setquest 17365;
			getitem 1000103, 7;
			ep17_2_bath = 3;
			cloakoffnpc "Rookie#172ba03", getcharid(0);
			questinfo_refresh();
			close3;
		case 3:
			cutin "ep172_beta.bmp", 0;
			mes "[Boiler]";
			mes "I turned off the boiler. Tell the <NAVI>[other guests]<INFO>ba_bath,270,94,0,101,0</INFO></NAVI> to feel free to search the area.";
			cloakoffnpc "Rookie#172ba03", getcharid(0); //Just incase the server restarts
			close3;
		case 14:
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "What are you curious about? Do you have any questions for us?";
			next;
			switch(select("Boiler...:Something like herbs...")){
				case 1:
				case 2:
					break;
			}
			mes "[Boiler]";
			mes "Boiler? Are you curious about the boiler? Why? Are you trying to steal boiler?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Steal the boiler?");
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "Oh, no? The intruder was very interested in the boiler and the supply system. And then they stole the boiler. Without me knowing.";
			mes "But "+strcharinfo(0)+" doesn't seem interested in things like this. I was wondering if you wanted to take a boiler. Or not..";
			next;
			mes "[Boiler]";
			mes "But what did the intruder do with it? You think they were gonna make an open-air bath?";
			mes "Uhm.. I don't really remember what I could do with the boiler. See if humans can make anything? Is that right "+strcharinfo(0)+"?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("What else did they do?");
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "Umm... They liked to soak themselves, but they were more obsessed with the boiler. They seemed to be interested in the cleanup facility.";
			next;
			mes "[Boiler]";
			mes "I was excited to explain it again. But I didn't know you'd steal the boiler. I really didn't know. That's the famous whim of man.";
			next;
			mes "[Boiler]";
			mes ""+strcharinfo(0)+" Are you fickle too? I don't know much about humans yet. There's a lot to know. That's why you prepare yourself. Don't let them steal it again.";
			next;
			mes "[Boiler]";
			mes "For example, my master says it's cool when he soaks himself in the bath. But it’s incredibly hot water. I was wondering if I set the wrong temperature? But I didn't.";
			next;
			mes "[Boiler]";
			mes "But he said it’s still cool. What does that mean? Am I mistaken?";
			next;
			mes "[Boiler]";
			mes "And then, if you soak these dry grasses in hot water, it comes with the ingredients you have. But that's it.";
			mes " But it's good for your health, so they fill every bath with herb water. Do humans breathe on their skin? Or drink that water on the skin?";
			next;
			mes "[Boiler]";
			mes "Humans are happy in the water. Why is that?";
			next;
			mes "[Boiler]";
			mes "Oh, there's another one! Why do you put ground steam in the bathtub and apply it to your face without squeezing it?";
			mes "I was so curious that I tried it, but I didn't know what it was good for. Maybe it's because I'm an automatic doll?";
			next;
			mes "[Boiler]";
			mes "If I had five senses like humans, I could understand humans better. Why didn't he give us that?";
			next;
			sleep2 500;
			cloakoffnpc "Valve#172ba01", getcharid(0);
			cutin "ep172_omega.bmp", 4;
			mes "[Valve]";
			mes "It's all done. You have to drink it now.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "I'm not going to drink. No one's drinking.";
			next;
			cutin "ep172_omega.bmp", 4;
			mes "[Valve]";
			mes "Is it not ready yet? Can't you just drink it? Squeeze it out and you'll get a lot of essence.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "Valve, humans are not tea bags. If I've said this much, remember.";
			next;
			cutin "ep172_omega.bmp", 4;
			mes "[Valve]";
			mes "Boiler only needs to boil water well.";
			cloakonnpc "Valve#172ba01", getcharid(0);
			cloakoffnpc "Valve#172ba02", getcharid(0);
			next;
			cutin "ep172_omega.bmp", 4;
			mes "[Valve]";
			mes "The temperature should be raised higher. To make it better.";
			cloakonnpc "Boiler#172ba02", getcharid(0);
			cloakoffnpc "Boiler#172ba03", getcharid(0);
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "I told you not to touch the boiler.";
			next;
			sleep2 500;
			specialeffect EF_PIERCE,AREA,"Valve#172ba02"; //81
			mes "- KANG -";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "Stop it and come over here.";
			next;
			sleep2 500;
			cloakoffnpc "Valve#172ba01", getcharid(0);
			cloakonnpc "Valve#172ba02", getcharid(0);
			cloakoffnpc "Boiler#172ba02", getcharid(0);
			cloakonnpc "Boiler#172ba03", getcharid(0);
			mes "[Boiler]";
			mes "It'll be quiet for a while, so it's okay.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("It looks dangerous. Dispose it...");
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "Why waste it! It'll still be useful if we fix it. Who am I supposed to work with if you destroy Valve? I don't like strangers.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("But why don't you fix it?");
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "Because I can't get my hands off the boiler? The intruders broke the boiler, Valve even broke also, and there was no time to fix it.";
			next;
			mes "[Boiler]";
			mes "I'm only one and it needs two to rotate the boiler room. There's no time to fix it. I'm gonna send it somewhere else, but I'm glad if they don't delete the data.";
			mes "It's not serious, so I can fix it slowly. Not that bad. Sometimes it touches the boiler. I don't know much about humans, but I know about herbs and boiler.";
			next;
			mes "[Boiler]";
			mes "Well, you still have to fix it....";
			mes "Umm... "+strcharinfo(0)+", are you free?";
			next;
			cutin "ep172_beta.bmp", 255;
			select("Yes?");
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "If you're free, please help me. I'm short of hands. But the valve needs to be fixed and the boiler needs to be fixed. I'm the only one, and the guards are busy.";
			mes "I wish I were two. Wow... it's so nice to think about it. Two of me would be the best boiler room.";
			next;
			mes "[Boiler]";
			mes "I'll have to ask Alpha to clone me. I don't know if it can be, but logically, it’s more efficient for me to be two.";
			mes "But what can I do right now? I am not two. I should get help. So if you're free, help me.";
			next;
			switch(checkquest(17376,HUNTING)){
				case -1:
					switch( checkquest(17377, PLAYTIME) ) {
						case -1:
							.@color$ = "^000000";
							.@started_quest$ = "[Daily] ";
							break;
						case 0:
						case 1:
							.@color$ = "^8C8C8C";
							.@started_quest$ = "[Wait] ";
							break;
						case 2:
							.@color$ = "^8C8C8C";
							.@started_quest$ = "[Ready] ";
							break;
					}
					break;
				case 0:
				case 1:
					.@color$ = "^8C8C8C";
					.@started_quest$ = "[In Progress] ";
					break;
				case 2:
					.@color$ = "^8C8C8C";
					.@started_quest$ = "[Completed] ";
					break;
			}
			switch(select(""+.@color$+""+.@started_quest$+"I'll help you.^000000:I have to go take a bath.")){
				case 1:
					switch( checkquest(17377, PLAYTIME) ) {
						case -1:
							break;
						case 0:
						case 1:
							mes "[Boiler]";
							mes "Thank you for today. For the meantime, enjoy your stay in the bath.";
							mes "Come back later after dawn.";
							close3;
						case 2:
							erasequest 17377;
							break;
							
					}
					switch( checkquest(17376, HUNTING) ) {
						case -1:
							mes "[Boiler]";
							mes "Thank you. Then can you handle ^0000cd20 broken inspector^000000? I also need about ^0000cd 5 broken automatic doll parts^000000.";
							next;
							cutin "ep172_beta.bmp", 255;
							select("Of course.");
							cutin "ep172_beta.bmp", 2;
							mes "[Boiler]";
							mes "Yes, then, please.";
							cloakonnpc "Valve#172ba01", getcharid(0);
							setquest 17376;
							close3;	
						case 0:
						case 1:
							mes "[Boiler]";
							mes "How are you handling them?";
							mes "I hope you can handle them properly.";
							close3;
						case 2:
							if(countitem(1000231) < 5){
								mes "[Boiler]";
								mes "Where's the broken parts that I need?";
								close3;
							}
							mes "[Boiler]";
							mes "Thank you for your help!";
							mes "Please enjoy the bath for the meantime.";
							erasequest 17376;
							setquest 17377;
							getitem 1000103,2;
							close3;
					}
				case 2:
					mes "[Boiler]";
					mes "Enjoy your bath.";
					close3;
			}

		default:
			break;
	}
	cutin "ep172_beta.bmp", 2;
	mes "[Boiler]";
	mes "It's a good idea to pay special attention when cleaning up. It’s very dangerous.";
	close3;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17364) == 1 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_bath > 13 && ( checkquest(17377,PLAYTIME) == 2 || checkquest(17377,PLAYTIME) == -1 ) && checkquest(17376,HUNTING) == -1 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " checkquest(17376,HUNTING) == 2 && countitem(1000231) > 4 " );
	end;
}

ba_bath,270,94,5	script	Rookie#172ba03	4_M_ROOKIE,{
	if(ep17_2_bath == 3){
		cutin "16loo_03.bmp", 2;
		mes "[Rookie]";
		mes "...Hey there!...";
		next;
		select("Rookie?");
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "Yes? Yes. Th-- There's nothing here.. Go to the ^0000cd lake^000000.";
		next;
		select("Lake?");
		mes "[Rookie]";
		mes "They open all the drains while cleaning, but sometimes they fall into the lake instead of the sewage treatment plant, so you should go.";
		next;
		mes "[Rookie]";
		mes "<NAVI>[There]<INFO>ba_bath,165,43,0,101,0</INFO></NAVI> might be something there. Take a look.";
		erasequest 17365;
		setquest 17366;
		ep17_2_bath = 4;
		cloakonnpc "Rookie#172ba03", getcharid(0);
		questinfo_refresh();
		close3;
	}

OnInit:
	cloakonnpc strnpcinfo(0);
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17365) == 1 " );
	end;
}

ba_bath,203,58,3	script	Rookie#172ba04	4_M_ROOKIE,5,5,{
	if(ep17_2_bath == 5){
		mes "[Magenta]";
		mes "Lucky! You're safe! I thought something happened to you.";
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "Did you see me, too?";
		next;
		cutin "16loo_01.bmp", 255;
		sleep2 500;
		cloakoffnpc "Denny#172ba03", getcharid(0);
		cloakoffnpc "Canine#172ba03", getcharid(0);
		mes "[Denny]";
		mes "Rookie? Did you call that? Like you said, I was going to the lake. Why are you calling me?";
		next;
		sleep2 500;
		cloakoffnpc "Zion#172ba03", getcharid(0);
		cloakoffnpc "Danae#172ba03", getcharid(0);
		mes "[Zion]";
		mes "How did you get here earlier than me?";
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "Hold on, calm down. Did you all see me out there?";
		next;
		cutin "16loo_01.bmp", 255;
		mes "[Denny]";
		mes "Of course! If Rookie is not Rookie, who is it?";
		npctalk "I wouldn't lie to you then.","Zion#172ba03",bc_self;
		next;
		cutin "16loo_03.bmp", 2;
		mes "[Rookie]";
		mes "So it's not one of us.";
		mes "Listen. We don't know the identity of the risk factors here yet. But it's not an automatic doll or a ghost. It's not a monster. It's not even a supernatural being.";
		npctalk "So what is it?","Zion#172ba03",bc_self;
		next;
		cutin "16loo_01.bmp", 255;
		mes "[Denny]";
		mes "How did you figure that out?";
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "It met everyone once. You saw me out there, didn't you? I told you where to go. Didn't you feel anything weird? It's a fake that imitates me..";
		next;
		cutin "16loo_01.bmp", 255;
		mes "[Magenta]";
		mes "What? It wasn't the real Lucky?";
		npctalk "It looks exactly the same.","Zion#172ba03",bc_self;
		npctalk "Oh, that's right! He told me to go to the lake, too!","Denny#172ba03",bc_self;
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "I've been with Mr. Gentleman all along. That adventurer over there almost ran into the fake and went to the lake.";
		mes "Given the circumstances, it's an intelligent life and it doesn't mean to hurt us. They're just trying to get us out of here. There's a good chance Goni's safe.";
		next;
		cutin "16loo_01.bmp", 255;
		mes "[Magenta]";
		mes "You mean I was fooled by a fake? Whoever it is, I’ll find it to the end.";
		npctalk "You lied to me...","Zion#172ba03",bc_self;
		npctalk "Oh, come on. I'm just freaking out.","Zion#172ba03",bc_self;
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "It knows this bathhouse well. Perhaps there is a secret passage, given that it knows the existence of a lake that drains water intermittently in the bathhouse.";
		next;
		mes "[Rookie]";
		mes "It’s used to the water. And...water vapor. Yeah, it knows how to use the steam. I don't know what's working on steam. There's gotta be something else besides obstructing the view. So be careful.";
		next;
		cutin "16loo_03.bmp", 2;
		mes "[Rookie]";
		mes "It will be very fast here with water. Like aquatic creatures.";
		next;
		cutin "16loo_03.bmp", 255;
		mes "[Magenta]";
		mes "Then, we can stop it from using water.";
		npctalk "Raccoon will work.","Zion#172ba03",bc_self;
		npctalk "Yeah, let's drive it away!","Denny#172ba03",bc_self;
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "Denny, set up the trap neatly.";
		npctalk "I never thought I'd use a trap here either. I'm glad I brought it.","Denny#172ba03",bc_self;
		next;
		mes "[Rookie]";
		mes "Magenta blocks the drain and the exit.";
		npctalk "I've seen it all before!","Magenta#172ba03",bc_self;
		next;
		mes "[Rookie]";
		mes "Next, use a smoke bomb and a bomb while driving from one side. Be careful not to get the ammunition wet because there’s a lot of water and steam. Don't let the bath facilities get damaged.";
		npctalk "Alright.","Zion#172ba03",bc_self;
		next;
		cutin "16loo_03.bmp", 2;
		mes "[Rookie]";
		mes "Hmm... there's water, so it'd be nice to use it. If we tie its feet with ice... Can we use the ice trap?";
		next;
		cutin "16loo_03.bmp", 255;
		mes "[Denny]";
		mes "I brought them all. Let me see... it's here.";
		next;
		cutin "16loo_02.bmp", 2;
		mes "[Rookie]";
		mes "Mr. Adventurer, it's an ^0000cd ice trap^000000.Please install it in every <NAVI>[marked place]<INFO>ba_bath,55,55,0,101,0</INFO></NAVI>.You just have to keep it in place and keep it steady. You have to hurry.";
		next;
		cutin "16loo_01.bmp", 2;
		mes "[Rookie]";
		mes "Now, in your positions!";
		erasequest 17367;
		setquest 17368;
		getitem 1000100, 4;
		getitem 1000103, 7;
		ep17_2_bath = 6;
		cloakonnpc "Denny#172ba03", getcharid(0);
		cloakonnpc "Canine#172ba03", getcharid(0);
		cloakonnpc "Zion#172ba03", getcharid(0);
		cloakonnpc "Danae#172ba03", getcharid(0);
		cloakonnpc "Magenta#172ba03", getcharid(0);
		cloakonnpc "Molar#172ba03", getcharid(0);
		cloakonnpc "Rookie#172ba04", getcharid(0);
		close3;
	}
	
OnTouch:
	if(ep17_2_bath == 5){
		cloakoffnpc "Magenta#172ba03", getcharid(0);
		cloakoffnpc "Molar#172ba03", getcharid(0);
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17367) == 1 " );
	end;
}

//Bath Traps
ba_bath,55,55,5	script	Marked Place#172ba01	HIDDEN_WARP_NPC,2,2,{
	if(ep17_2_bath == 6){
		specialeffect EF_ICECRASH,AREA,"Marked Place#172ba01"; //135
		specialeffect 1028,AREA,"Marked Place#172ba01"; //1028
		showscript ""+strcharinfo(0)+" : I guess it's this location. The cold air flowed out when the trap was fixed. Let's move on to the next location.";
		erasequest 17368;
		setquest 17369;
		delitem 1000100, 1;
		ep17_2_bath = 7;
		navigateto("ba_bath",306,121,NAV_ALL); //Navigation_Active "ba_bath" 0 5 1 306 121
		sleep2 1000;
		end;
	}
	end;
	
OnTouch:
	if(isbegin_quest(17368) == 1)
		classchange(4_ENERGY_BLUE,"Marked Place#172ba01",bc_self);
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17368) == 1 " );
	end;
}

ba_bath,306,121,5	script	Marked Place#172ba02	HIDDEN_WARP_NPC,2,2,{
	if(ep17_2_bath == 7){
		specialeffect EF_ICECRASH,AREA,"Marked Place#172ba02"; //135
		specialeffect 1028,AREA,"Marked Place#172ba02"; //1028
		showscript ""+strcharinfo(0)+" : I fixed the trap where Rookie talked. Let's move on to the next location.";
		erasequest 17369;
		setquest 17370;
		delitem 1000100, 1;
		ep17_2_bath = 8;
		navigateto("ba_bath",21,276,NAV_ALL); //Navigation_Active "ba_bath" 0 5 1 306 121
		sleep2 1000;
		end;
	}
	end;
	
OnTouch:
	if(isbegin_quest(17369) == 1)
		classchange(4_ENERGY_BLUE,"Marked Place#172ba02",bc_self);
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17369) == 1 " );
	end;
}

ba_bath,21,276,5	script	Marked Place#172ba03	HIDDEN_WARP_NPC,2,2,{
	if(ep17_2_bath == 8){
		specialeffect EF_ICECRASH,AREA,"Marked Place#172ba03"; //135
		specialeffect 1028,AREA,"Marked Place#172ba03"; //1028
		showscript ""+strcharinfo(0)+" : The trap was placed in the marked place to secure it. Let's move on to the next location.";
		erasequest 17370;
		setquest 17371;
		delitem 1000100, 1;
		ep17_2_bath = 9;
		navigateto("ba_bath",155,305,NAV_ALL); //Navigation_Active "ba_bath" 0 5 1 306 121
		sleep2 1000;
		end;
	}
	end;
	
OnTouch:
	if(isbegin_quest(17370) == 1)
		classchange(4_ENERGY_BLUE,"Marked Place#172ba03",bc_self);
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17370) == 1 " );
	end;
}

ba_bath,155,305,5	script	Marked Place#172ba04	HIDDEN_WARP_NPC,2,2,{
	if(ep17_2_bath == 9){
		specialeffect EF_ICECRASH,AREA,"Marked Place#172ba04"; //135
		specialeffect 1028,AREA,"Marked Place#172ba04"; //1028
		showscript ""+strcharinfo(0)+" : Finally, the trap was set and fixed. Where are we going now?";
		erasequest 17371;
		setquest 17372;
		delitem 1000100, 1;
		ep17_2_bath = 10;
		sleep2 2000;
		cloakoffnpc "Magenta#172ba04", getcharid(0);
		npctalk "Mr. Adventurer, have you set up all the traps? It's already started there. Hurry up and go.","Magenta#172ba04",bc_self; // 1237
		navigateto("ba_bath",286,298,NAV_ALL); //Navigation_Active "ba_bath" 0 5 1 306 121
		sleep2 2000;
		cloakonnpc "Magenta#172ba04", getcharid(0);
		end;
	}
	end;
	
OnTouch:
	if(isbegin_quest(17371) == 1)
		classchange(4_ENERGY_BLUE,"Marked Place#172ba04",bc_self);
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17371) == 1 " );
	end;
}

ba_bath,286,298,3	script	Monster#172ba01	HIDDEN_WARP_NPC,2,2,{
	switch(ep17_2_bath){
		case 11:
			cloakoffnpc "Rookie#172ba05", getcharid(0);
			cloakoffnpc "Denny#172ba04", getcharid(0);
			cloakoffnpc "Magenta#172ba05", getcharid(0);
			cloakoffnpc "Zion#172ba04", getcharid(0);
			cloakoffnpc "Molar#172ba04", getcharid(0);
			cloakoffnpc "Molar#172ba04", getcharid(0);
			cloakoffnpc "Danae#172ba04", getcharid(0);
			sleep2 500;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Mr. Adventurer, you arrived just in time.";
			mes "Here, ahead. Be careful everyone.";
			next;
			sleep2 1000;
			specialeffect EF_SMOKE,AREA,"Monster#172ba01"; // EF_SMOKE (44)
			specialeffect EF_PEONG,AREA,"Monster#172ba01"; // EF_PEONG (411)
			cutin "16loo_01.bmp", 255;
			mes "Eeekkk-";
			next;
			select("This steam must be...");
			sleep2 500;
			classchange(4_M_ROOKIE,"Monster#172ba01",bc_self);
			cloakoffnpc "Goni#172ba01", getcharid(0);
			mes "[Denny]";
			mes "Isn't that Goni?? Besides, are there… two Rookie?";
			npctalk "Lucky...?","Magenta#172ba05",bc_self;
			npctalk "Who's the real one?","Denny#172ba04",bc_self;
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Of course it's me! Who did you guys come all the way here with? You're here to catch that fake.";
			npctalk "In this way, Rookie is right. Right.","Molar#172ba04",bc_self;
			npctalk "Of course it's me!","Rookie#172ba05",bc_self;
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "I don't know who it is, but since you don't have a place to run now, you'd better not think about it. This place is surrounded by triplets. Danny, Magenta. Check it out.";
			next;
			cutin "16loo_01.bmp", 0;
			mes "[??????]";
			mes "......";
			npctalk ".......","Monster#172ba01",bc_self;
			next;
			cutin "16loo_01.bmp", 255;
			cloakonnpc "Denny#172ba04", getcharid(0);
			cloakonnpc "Magenta#172ba05", getcharid(0);
			sleep2 1000;
			cloakoffnpc "Denny#172ba05", getcharid(0);
			cloakoffnpc "Magenta#172ba06", getcharid(0);
			mes "[Denny]";
			mes "Goni, is holding his breath. No injury also.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Take out all the potion you've got.";
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Magenta]";
			mes "Is that necessary? I'll spray water and slap you in the face, and you'll get up in no time.";
			npctalk "You, I told you to stop reading spy novels, right?","Zion#172ba04",bc_self;
			next;
			sleep2 500;
			cloakonnpc "Rookie#172ba05", getcharid(0);
			sleep2 500;
			cloakoffnpc "Rookie#172ba06", getcharid(0);
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Goni, Goni? Try drinking this. Can you drink this?";
			npctalk "Rookie, You'd better go down a little. I think if we get any closer, we'll get confused who is who.","Canine#172ba04",bc_self;
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Magenta]";
			mes "Lucky, step back a little bit more than that. Is that really Goni? Not fake again? Let's check it out.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "How could it not be Goni when there's a fake me over there?";
			next;
			cutin "16go_03.bmp", 2;
			mes "[Goni]";
			mes "......!!";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Goni? Are you awake now? Are you okay?";
			next;
			sleep2 1000;
			specialeffect EF_SUI_EXPLOSION,AREA,"Goni#172ba01"; //183
			mes "[Rookie]";
			mes "Cover everyone! Also Mr. Adventurer!";
			next;
			cutin "16loo_01.bmp", 255;
			select("Okay!!");
			sleep2 500;
			cloakonnpc "Rookie#172ba06", getcharid(0);
			sleep2 1000;
			cloakoffnpc "Rookie#172ba05", getcharid(0);
			mes "[Denny]";
			mes "I mean, even if I told you to cover...";
			next;
			sleep2 1000;
			specialeffect EF_SMOKE,AREA,"Monster#172ba01"; //44
			specialeffect EF_PEONG,AREA,"Monster#172ba01"; //411
			mes "Eeekkk-";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Ah! steam again!!!";
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Denny]";
			mes "Now Goni… became two.";
			classchange(4_M_GONY,"Monster#172ba01",bc_self);
			npctalk "Hey Lucky! Goni does not even know the code. So what shall we do?","Magenta#172ba05",bc_self;
			npctalk "The one on the left side does look like Goni? The one who breathes like that seems to be more like Goni?","Denny#172ba05",bc_self;
			npctalk "Anyone can tell that the one on the right side is Goni. Try to look at that eye.","Canine#172ba04",bc_self;
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "Everyone, be quiet. We have an easy and sure way to recognize the real Goni.";
			mes "Goni? Who's the real Goni between the two?";
			next;
			cutin "16go_03.bmp", 2;
			mes "[Goni]";
			mes "......";
			npctalk "......","Goni#172ba01",bc_self;
			next;
			cutin "16go_03.bmp", 0;
			mes "[Goni]";
			mes "Of course it's me.";
			npctalk "Of course it's me.","Monster#172ba01",bc_self;
			next;
			cutin "16go_03.bmp", 255;
			mes "[Zion]";
			mes "Oh… yeah. So easy. I think I can even guess the one who was born yesterday.";
			npctalk "Denny, Magenta. Hold it tight.","Rookie#172ba05",bc_self;
			next;
			cutin "16go_03.bmp", 0;
			mes "[Goni]";
			mes "What's wrong? Let go of it! That's fake!";
			npctalk "Let go of it! That's fake!","Monster#172ba01",bc_self;
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "Mr. Adventurer, do you know which one is real?";
			next;
			select("The silent one.:The one who claims to be real.");
			cutin "16loo_02.bmp", 255;
			mes "[Zion]";
			mes "Our baby, you have a keen eye.";
			next;
			mes "[Zion]";
			mes "Goni, come here.";
			next;
			cutin "16go_03.bmp", 2;
			mes "[Goni]";
			mes "......";
			npctalk "......","Goni#172ba01",bc_self;
			next;
			cutin "16go_03.bmp", 255;
			sleep2 500;
			cloakonnpc "Goni#172ba01", getcharid(0);
			sleep2 500;
			cloakoffnpc "Goni#172ba02", getcharid(0);
			mes "[Magenta]";
			mes "Hahaha! Now our Goni is in silent training!!";
			npctalk "Reveal who you are! This rascal!!!","Zion#172ba04",bc_self;
			npctalk "Zion, you seem to be more like a rascal...","Danae#172ba04",bc_self;
			next;
			cutin "16go_03.bmp", 0;
			mes "[??????]";
			mes "Ha... I guess I've delayed too much. I'm going to get away...";
			mes "I, cured him of his injuries and... Well, since we haven't done anything to each other, why don't we part ways like this?";
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "You can't do that. There's a victim here. Right, Goni?";
			next;
			cutin "16go_03.bmp", 2;
			mes "[Goni]";
			mes "......";
			npctalk "......","Goni#172ba01",bc_self;
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Okay. Shall we talk now? Who are you?";
			next;
			cutin "16go_03.bmp", 0;
			mes "[??????]";
			mes "Before that...";
			erasequest 17372;
			setquest 17373;
			ep17_2_bath = 12;
			questinfo_refresh();
			close3;
		case 12:
			cutin "16go_03.bmp", 0;
			mes "[??????]";
			mes "Before that, don't touch me. I won't attack you. But let me go as it is. Then I won't hurt you.";
			mes "You gave him back. Wasn't that what you were looking for? If you let me go, you will be blessed in the future.";
			npctalk "Who's hurting who? I don't think you know what's going on.","Denny#172ba05",bc_self;
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I was looking for Goni, but that's not all I was looking for. I've been looking for the thing that put Goni in danger. It might hurt other people.";
			mes "We can't send the risk back like this. We have to do some research...";
			npctalk "But how can we send you peacefully!","Denny#172ba05",bc_self;
			next;
			cutin "16go_03.bmp", 0;
			mes "[??????]";
			mes "Well, I won't do anything more, so just bite me. I'm not a villain.";
			npctalk "Aigoo~ I'm not curious at all~","Magenta#172ba06",bc_self;
			npctalk "I guess everyone learns such lines from somewhere. They're all the same.","Canine#172ba04",bc_self;
			npctalk "I'd like to know if there's a place like that. So that I will make it all to dust.","Molar#172ba04",bc_self;
			next;
			cutin "ep172_beta.bmp", 1;
			sleep2 500;
			cloakoffnpc "Gentleman#172ba03", getcharid(0);
			mes "[Gentleman]";
			mes "What's the fuss about? In case there's an accident...";
			mes "Mr. Goni is two persons...? So this is what  "+strcharinfo(0)+" said?";
			npctalk "Oh my god... even an automatic doll...","Monster#172ba01",bc_self;
			next;
			cutin "ep172_beta.bmp", 255;
			select("Yeah. That person is fake.");
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Please wait a moment. I'll deal with it.";
			mes "Who are you? Please identify yourself. Why are you bothering our master's guests here?";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Wait, but are you going to keep talking like that? It's confusing, so why don't you talk in original form?";
			next;
			cutin "16go_03.bmp", 0;
			mes "[??????]";
			mes "Well... I understand. I need you to put this gun away. I won't run away or hurt you.";
			next;
			cutin "16go_03.bmp", 255;
			classchange(4_EP17_MERMAID,"Monster#172ba01",bc_self); 
			specialeffect EF_SMOKE,AREA,"Monster#172ba01"; //44
			specialeffect EF_PEONG,AREA,"Monster#172ba01"; //411
			mes "[??????]";
			mes "This is who I am.";
			next;
			select("Mermaid?");
			emotion ET_HUK, strcharinfo(0);
			mes "[??????]";
			mes "That doesn’t mean human fish in terms of human words. It's a nickname, and Mermaid and I are not exactly the same species here.";
			next;
			mes "[??????]";
			mes "But it's complicated to explain about our species, so feel free to call me what you want.";
			mes "Anyway, call me like that, but there's no one here to pick a fight. Most of all, we're all guests of the same Barmunt.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "You’re really the master’s, so you’re saying you are Barmunt’s guest? Then let me know your name.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[??????]";
			mes "Is it time to introduce yourself? I've heard that people here introduce themselves first to socialize. I am Princess. I came from Celestial gold.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Please wait a moment. I will check.";
			npctalk "But by the way, where is Celestial gold? I’ve never heard of it.","Denny#172ba05",bc_self;
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Magenta]";
			mes "Why are you doing this here when you’re a princess?";
			next;
			mes "[Princess]";
			mes "That... That’s... That’s not what I meant. ...That’s why I didn’t want to show up in front of my people...";
			mes "Don't look at me like that. I've heard what my name means among humans, but where I was born and raised, it's completely different.";
			npctalk "Ah, so your name is just Princess but you are not a princess.","Zion#172ba04",bc_self;
			npctalk "I mean, Sesinsa, you know him as a gentleman, no. No.","Denny#172ba05",bc_self;
			npctalk "But it suits you.","Magenta#172ba06",bc_self;
			npctalk "Really? Do I really look like a strong pillar to support everything?","Monster#172ba01",bc_self;
			sleep2 1000;
			npctalk "...that’s what you meant?","Magenta#172ba06",bc_self;
			sleep2 500;
			npctalk "...that’s the meaning.","Monster#172ba01",bc_self;
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "I'm sorry, I've double-checked the list, but I can't find it. May I have your name again?";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "Probably not on the list. That’s what I asked for.";
			mes "I've been wandering away from home. That's how Barmunt let me use this mansion's bathhouse without anyone contacting me.";
			next;
			mes "[Princess]";
			mes "I don't remember the exact time of it... but I been here a long time since Barmunt didn't show up.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "So it's been a while since you've been in and out of this bathhouse. But we need to make sure you're really his guest, as you claimed.";
			next;
			mes "[Gentleman]";
			mes "Please understand that this is a necessary confirmation procedure without the owner giving us any other word. Do you happen to have any vouchers or messages from your master?.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "I'm afraid I don't have it. I was supposed to be quiet in the first place.";
			next;
			mes "[Princess]";
			mes "I've been staying on the water around here. Then I met Barmunt, who was walking outside the mansion.";
			mes "Barmunt knew my situation, and he was very kind to invite me to his mansion, so I could always use the bathhouse.";
			next;
			mes "[Princess]";
			mes "I let you use it quietly without letting anyone know about my situation, which I'm wary of. Especially not to encounter automatic dolls that are different from living things.";
			mes "Barmunt was very considerate of us on the way to this bathhouse.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Clearly, security would have been triggered the moment an outsider entered the mansion in the usual way. Okay. Excuse me. Then I'll make sure you don't have any inconvenience when you register as a guest.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "Well, do I have to?";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "If you use it without registration, it may cause unnecessary misunderstanding to other users, so you should at least register it. Because you're not here right now.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "If that’s so... I understand.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "I'll take care of it right away. May I have your name again?.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "Princess, from the East Sea, from Celestial gold.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Is it our turn now? Why don't we talk while you register?";
			erasequest 17373;
			setquest 17374;
			ep17_2_bath = 13;
			questinfo_refresh();
			close3;
		case 13:
			mes "[Princess]";
			mes "What are you curious about?";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I know why you're here. But why did you attack people? You could have known that they didn't mean to hurt you?";
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Princess]";
			mes "First of all, I didn't attack. He's been following me for a very long time. And then by mistake...";
			mes "I was going to treat the fainted man and let him out nicely, but then you guys just walked in and...";
			next;
			mes "[Princess]";
			mes "I always tried to get people out of here, but it didn't work. I didn't mean to harm you. In the first place, I was reluctant to contact anything.";
			mes "That's why Barmunt was so considerate, but since I've been chased for a long time, I did it by reflex... That's what my anxiety is about..";
			next;
			select("Why are you so reluctant?");
			mes "[Princess]";
			mes "That's my nature. This nature forced me to leave my hometown after being bullied. So when I come into contact with other people, I become unknowingly wary..";
			mes "I'm so sorry if I hurt you. I want you to forgive me for doing something unintentionally to protect myself.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Well... Goni was injured, but he didn't mean it, and he's a guest in this mansion..";
			mes "As long as you make sure you promise not to disturb or harm us, we're going to step down at this point, what do you think?";
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Princess]";
			mes "Of course, I'll make a pledge on my honor.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Then we'll trust Ms. Princess’ words of honor, and we'll wrap it up and step down.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "You've been waiting a long time. Ms. Princess of Celestial gold, I've registered you to be a guest at the Barmunt mansion. It took some time because the communication was unstable. I'm sorry..";
			mes "You can now stay in this mansion as a guest of Barmunt. Please make yourself at home.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "I have a question. Barmunt. Is he busy these days? I've been looking for him, but he hasn't shown up for a while.";
			mes "Can I think that Barmunt won't show up for some time in the future?";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Master can come back soon as tomorrow, but I would not expect him to come for a while.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "Then can I use this bath house as my base?";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "I'm sorry, but what does that mean?";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "I'm trying to get back at the people of my hometown by creating a new force. Don't you need a hub to pull together to do that?";
			mes "I've been in and out of this place for a long time, but it's been a hassle for me to keep it for a long time, so I'll own it for you.";
			npctalk "What's that supposed to mean?","Denny#172ba05",bc_self;
			npctalk "Does that make sense?","Molar#172ba04",bc_self;
			npctalk "Well, I've never heard of that logic.","Canine#172ba04",bc_self;
			next;
			sleep2 500;
			cloakoffnpc "Boiler#172ba04", getcharid(0);
			cloakoffnpc "Sweepy#172ba03", getcharid(0);
			cutin "ep172_beta.bmp", 0;
			mes "[Sweepy]";
			mes "What is this sound I hear?";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Boiler]";
			mes "What are you talking about? This is definitely the bathhouse in Master Barmunt's mansion.";
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "Barmunt will understand. He's understanding, so he'll gladly allow me to settle just as he helped me hide myself in the bathhouse.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Although my master has granted you a visit and he has been generous as you have said, it has shown it as his sincerity and kindness.";
			mes "Please don't ignore the kindness of Mr. Barmunt, who does his best.";
			npctalk "It is illegal extortion to acquire real estate of an object whose intention cannot be expressed.","Sweepy#172ba03",bc_self;
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "Not really. If you've lived in a particular property with an owner for a long time, that property belongs to you. That's how everyone lives.";
			mes "Or how about this one? Recognize me as the sole official successor to the Barmunt legacy. Can't I then claim just ownership during Barmunt's absence?";
			npctalk "Wait, is my common sense weird? Is that normal?","Denny#172ba05",bc_self;
			npctalk "That sounds plausible, but it's weird if you listen carefully. Did you just ask it to adopt you to Barmunt?","Magenta#172ba06",bc_self;
			npctalk "I think so.","Molar#172ba04",bc_self;
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "The rightful owner of this mansion and bathhouse is Barmunt, and even a long-term resident cannot claim ownership.";
			mes "Let's discuss the matter ourselves when Mr. Barmunt comes back later. It's not something that we can tell you as a worker.";
			npctalk "Real estate. That's making us greedy.","Danae#172ba04",bc_self;
			npctalk "People like us have to go without loads.","Denny#172ba05",bc_self;
			npctalk "Why do you keep trying to take our property when our master is not around? That's funny.","Boiler#172ba04",bc_self;
			npctalk "There is no logic in the argument and the statement is weak.","Sweepy#172ba03",bc_self;
			next;
			cutin "ep172_beta.bmp", 255;
			mes "[Princess]";
			mes "There's a secret all over this mansion. The same goes for this bathhouse. At first glance, it seems to have been built in disorder with the flow of taste and interest, but it has its own rules.";
			mes "It looks like the lines are woven according to the order of baths and the temperature of the water, but even the lines are a meaningful act, as is all in this mansion.";
			next;
			mes "[Princess]";
			mes "Where you can get sunlight and moonlight, the ceiling where the light grunts in the water. Besides those drainage pipes... He made these for some great research normal people couldn't understand. It's not just a bathhouse.";
			next;
			mes "[Princess]";
			mes "Is there anyone who understands even one of these things? Barmunt also doesn't want the bath to be abandoned and forgotten for a long time.";
			mes "I have the power here to avenge the disgrace of my life. Why can't I use it?";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Once again, I'm telling you. You have to make all the decisions yourself. Neither us nor guests, Princess, will decide.";
			next;
			cutin "ep172_beta.bmp", 255;
			select("How are we supposed to gather the group?");
			mes "[Princess]";
			mes "Shouldn't we appease the tough guy who came here? It happens to be right in front of me.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "How are you going to make us your men? I think you'd better grow your strength first.";
			mes "If you had a group before you had power, what would you do but break it down or lose it?";
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Princess]";
			mes "..I know I'm weak even if you don't say that. But I don't know what to do.";
			npctalk "Whoa... this atmosphere....","Magenta#172ba06",bc_self;
			next;
			select("You can get trained.");
			mes "[Princess]";
			mes "Training...? But who... Ah...!";
			npctalk "Denny#172ba05","I suddenly feel nervous.",bc_self;
			npctalk "Why are you looking at us like that?","Zion#172ba04",bc_self;
			next;
			mes "[Princess]";
			mes "You guys look so strong. Why don't you fight me? I don't have the means to protect myself, but I'm the weakest alive.";
			mes "So I want you to tell me how to survive and fight.";
			npctalk "I knew it...","Danae#172ba04",bc_self;
			next;
			mes "[Magenta]";
			mes "That sounds fun. You want to shoot, Princess? We only know about shooting, will it be okay? I'm fine. From revolver to gatling, you can choose whatever you want.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Ammunition fighting isn't right for anyone who usually stays in the water. So you'd rather ask the adventurer to help us.";
			next;
			cutin "16loo_01.bmp", 255;
			mes "[Princess]";
			mes "Is that so...? I'd like you to fight with me often, if you don't mind Mr. Adventurer.";
			next;
			select("Sure, it's not hard.");
			mes "[Princess]";
			mes "Thank you very much. I look forward to meeting you.";
			mes "I have also unintentionally caused you trouble. Forgive me. But aren't friendships originally meant to be stronger in a fight? We are not same guests of Barmunt’s mansion.";
			npctalk "Friends? Since when?","Zion#172ba04",bc_self;
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "Are you done talking? Thank you so much for your help in many ways, "+strcharinfo(0)+". This is a small reward.";
			npctalk "Why aren't you giving us?","Magenta#172ba06",bc_self;
			npctalk "We just did our job. The adventurer helped us.","Rookie#172ba04",bc_self;
			next;
			cutin "ep172_beta.bmp", 0;
			mes "[Boiler]";
			mes "Adventurer, when you're free, come to the boiler room. Let's do something together.";
			mes "Then we'll go now.";
			next;
			cutin "ep172_beta.bmp", 1;
			mes "[Gentleman]";
			mes "If you need anything, please feel free to visit us. It was unintentionally rude to you, too.";
			next;
			sleep2 500;
			cloakonnpc "Gentleman#172ba03", getcharid(0);
			cloakonnpc "Boiler#172ba04", getcharid(0);
			cloakonnpc "Sweepy#172ba03", getcharid(0);
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "We've found Goni, and we've confirmed there's no danger in the bathhouse, so let's go.";
			mes "Mr. Adventurer, thank you so much for helping us search Goni.";
			npctalk "Baby, see you again!","Zion#172ba04",bc_self;
			next;
			cutin "16loo_01.bmp", 255;
			sleep2 500;
			cloakonnpc "Rookie#172ba05", getcharid(0);
			cloakonnpc "Denny#172ba05", getcharid(0);
			cloakonnpc "Magenta#172ba06", getcharid(0);
			cloakonnpc "Zion#172ba04", getcharid(0);
			cloakonnpc "Molar#172ba04", getcharid(0);
			cloakonnpc "Canine#172ba04", getcharid(0);
			cloakonnpc "Danae#172ba04", getcharid(0);
			cloakonnpc "Goni#172ba02", getcharid(0);
			mes "[Princess]";
			mes "You'd better go now. See you later.";
			erasequest 17374;
			ep17_2_bath = 14;
			getitem 1000103,16;
			questinfo_refresh();
			close3;
		default:
			break;
	}
	if(ep17_2_bath > 13){
		mes "[Mermaid]";
		mes "I can't do anything for you even if you come to me now.";
		close;
	}
	end;
	
OnTouch:
	if(ep17_2_bath == 10){
		showscript ""+strcharinfo(0)+" : Is this....? What's that?";
		classchange(4_CENERE,"Monster#172ba01",bc_self);
		ep17_2_bath = 11;
		end;
	}
	if(ep17_2_bath > 11){
		classchange(4_EP17_MERMAID,"Monster#172ba01",bc_self); 
		end;
	}
	end;
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17372) == 1 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17373) == 1 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(17374) == 1 " );
	end;
}

//Bath Infos
ba_bath,240,127,3	script	Star Spring#bathifo	4_BOARD3,{
	mes "Star Spring - Lukewarm Bath";
	mes "We can't touch the stars in the night sky. But you can feel the temperature of beauty just by looking at it. The twinkling of a broken, twinkling star on the surface of the water will inspire many things.";
	close;	
}

ba_bath,259,191,3	script	Foot Bath#bathifo	4_BOARD3,{
	mes "Foot Bath";
	mes "It doesn't have to be grand. At least soak your feet.";
	close;	
}

ba_bath,31,276,5	script	cold spring#bathifo	4_BOARD3,{
	mes "^0000cdCold spring - Cold bath^000000";
	mes "^0000cdSoak yourself in this cold bath if you want to be cold and ice-cold. The coldness in the bath will bring together a disorganized spirit.^000000";
	close;	
}

ba_bath,254,270,3	script	Nameless Spring#bathifo	4_BOARD3,{
	mes "^006600Nameless Spring^000000";
	mes "^006600When you want to shake everything off and return to the nature's arms, but when things don't work out, please find me.^000000";
	close;	
}

//Power Plant Quest
ba_maison,79,278,4	script	Eorpa#eorpa	4_EP17_BASIC_B,{
	if(ep17_2_main < 10){
		mes "[Eorpa]";
		mes "Travellers who are not registered as guests are considered enemies.";
		next;
		mes "- Prior quests exists. -";
		close;
	}
	switch(ep17_2_eorpa){
		case 0:
			switch(isbegin_quest(3389)){
				case 0:
					mes "[Eorpa]";
					mes "Hello. I am...";
					mes "am managing the second power plant... eeekkkk";
					next;
					mes "[Eorpa]";
					mes "My name is Eorpa...";
					next;
					mes "[Eorpa]";
					mes "This is Barmunt... Wel... come... eeekkk";
					next;
					select("It seems like you're not in a good condition?");
					mes "[Eorpa]";
					mes "The line in front of me... eeekkk... could you check these chips... eeekkkk...";
					next;
					mes "[Eorpa]";
					mes "At the second power plant... I've just collected... eekkkk... it's a chip that interferes with communication waves...";
					next;
					mes " - There are a lot of delicious potato chips in front of Eorpa. - ";
					next;
					select("This is surely potato chips...");
					mes "[Eorpa]";
					mes "This... bio-interference chip has been shaking my network. Eeekkk... To manage this biochip... eeekk... can I ask a favor?";
					next;
					select("How should I take care of this?");
					mes "[Eorpa]";
					mes "Who lives in it... eeekkk... I know that we can process the corresponding biocompatible chip... eeekkk...";
					next;
					mes "[Eorpa]";
					mes "To facilitate communication... eeekkk... Please process the chip... eeekkk...";
					next;
					mes " - It's clear that you want me to eat the chips! - ";
					next;
					mes " - Would you like to eat the potato chips piled up in front of Eorpa? - ";
					next;
					switch(select("Eat it up.:Stop eating.")){
						case 1:
						case 2:
							break;
					}
					mes "["+strcharinfo(0)+"]";
					mes "Yum yum yum yum... crunch crunch crunch...";
					next;
					mes " - I've finished all the potato chips in front of Eorpa!! - ";
					next;
					mes "[Eorpa]";
					mes "Eeekkk... thank you. The removal of the biowave jamming chip has been confirmed.";
					mes "The network is in good condition. Communication check completed.";
					next;
					mes "[Eorpa]";
					mes "I will restart the system. Please talk to me in a moment.";
					setquest 3389;
					close;
				case 1:
					switch(isbegin_quest(3390)){
						case 0:
							cutin "ep172_beta.bmp", 2;
							mes "[Eorpa]";
							mes "Hello. Thank you for handling the biowave jamming chips. Now we can communicate properly. I'm Eorpa and I am managing the second power plant.";
							next;
							mes "[Eorpa]";
							mes "Let me tell you about the jamming chips that you just handled. This chip is installed by an illusion called ^4d4dffMana Addict Sanare^000000 in the second power plant to interfere with the communication network.";
							next;
							mes "[Eorpa]";
							mes "It's a chip that only works critically on automatic dolls, and these days, it's a big problem in managing the second power plant.";
							next;
							mes "[Eorpa]";
							mes "I've been going into the second power plant myself and retrieving the chips, but there has been no way to deal with them, and I've been in trouble because of a network failure.";
							next;
							mes "[Eorpa]";
							mes "And thanks to you "+strcharinfo(0)+" in handling the chips, the problem has been solved. Thank you.";
							next;
							mes "[Eorpa]";
							mes "Sorry for asking you while I thank you, but it's a little urgent, so could you do Eorpa's favor?";
							next;
							select("What kind of favor is it?");
							mes "[Eorpa]";
							mes "The illusion called ^4d4dffMana Addict Sanare^000000 is installing the radio jamming chip that I told you about in the power plant. If we keep going like this, we'll end up with a malfunction.";
							next;
							mes "[Eorpa]";
							mes "Could Mr. Adventurer show up at the second power plant and collect ^4d4dff10 potato chips^000000?";
							next;
							if(select("I accept:I refuse") == 2) close3;
							mes "[Eorpa]";
							mes "The surest way is to dispose and collect the ^4d4dffMana Addict Sanare^000000 before spreading the potato chips.";
							next;
							mes "[Eorpa]";
							mes "So now, please do the favor. Please collect ^4d4dff10 potato chips.^000000";
							setquest 3390;
							close3;
						case 1:
							if(countitem(1000225) < 10){
								cutin "ep172_beta.bmp", 2;
								mes "[Eorpa]";
								mes "You just need to collect 10 potato chips and bring them to me.";
								close3;
							}
							cutin "ep172_beta.bmp", 2;
							mes "[Eorpa]";
							mes "I checked the collection of 10 potato chips. Please process the biochip.";
							next;
							mes "- I ate 10 pieces of potato chips. - ";
							next;
							mes "[Eorpa]";
							mes "The processing of potato chips has been confirmed. Thank you.";
							ep17_2_eorpa = 1;
							delitem 1000225,10;
							getitem 1000103,1;
							erasequest 3389;
							erasequest 3390;
							setquest 3391;
							close3;
					}
			}
		case 1:
			switch(checkquest(3391,PLAYTIME)){
				case -1:
					switch(isbegin_quest(3392)){
						case 0:
							cutin "ep172_beta.bmp", 2;
							mes "[Eorpa]";
							mes "The illusion called ^4d4dffMana Addict Sanare^000000 is installing the radio jamming chip that I told you about in the power plant. If we keep going like this, we'll end up with a malfunction.";
							next;
							mes "[Eorpa]";
							mes "Could Mr. Adventurer show up at the second power plant and collect ^4d4dff10 potato chips^000000?";
							next;
							if(select("I accept:I refuse") == 2) close3;
							mes "[Eorpa]";
							mes "The surest way is to dispose and collect the ^4d4dffMana Addict Sanare^000000 before spreading the potato chips.";
							next;
							mes "[Eorpa]";
							mes "So now, please do the favor. Please collect ^4d4dff10 potato chips.^000000";
							setquest 3392;
							close3;
						case 1:
							if(countitem(1000225) < 10){
								cutin "ep172_beta.bmp", 2;
								mes "[Eorpa]";
								mes "You just need to collect 10 potato chips and bring them to me.";
								close3;
							}
							cutin "ep172_beta.bmp", 2;
							mes "[Eorpa]";
							mes "I checked the collection of 10 potato chips. Please process the biochip.";
							next;
							mes "- I ate 10 pieces of potato chips. - ";
							delitem 1000225,10;
							next;
							mes "[Eorpa]";
							mes "The processing of potato chips has been confirmed. Thank you.";
							erasequest 3392;
							setquest 3391;
							getitem 1000103,1;
							close3;
					}
				case 0:
				case 1:
					cutin "ep172_beta.bmp", 2;
					mes "[Eorpa]";
					mes "Hello "+strcharinfo(0)+",";
					mes "Thank you for helping me get the 10 potato chips.";
					next;
					mes "[Eorpa]";
					mes "Please come back after dawn and I'll have a request for you to do.";
					close3;
				case 2:
					cutin "ep172_beta.bmp", 2;
					mes "[Eorpa]";
					mes "Hello "+strcharinfo(0)+",";
					mes "It's been a while. I hope you have spare time. I have some request for you.";
					erasequest 3391;
					close3;
			}
	}
	if(ep_illusion < 46){
		cutin "ep172_beta.bmp", 2;
		mes "[Eorpa]";
		mes "Job....";
		mes "Straight....";
		mes "....";
		next;
		mes "- It doesn't look very good, so let's leave it alone. -";
		close3;
	}
	
OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_main > 8 && ep17_2_eorpa == 0 && isbegin_quest(3389) == 0 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " isbegin_quest(3390) == 1 && countitem(1000225) > 9 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_eorpa > 0 && isbegin_quest(3392) == 1 && countitem(1000225) > 9 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_eorpa > 0 && (checkquest(3391,PLAYTIME) == 2 || checkquest(3391,PLAYTIME) == -1) && isbegin_quest(3392) == 0 " );
	end;
}

//Water Garden (ep17_2_garden)
ba_pw02,42,267,5	script	Rensij#jh_ba	4_EP17_BASIC_B,{
	if(ep17_2_main < 10){
		mes "[Rensij]";
		mes "Travellers who are not registered as guests are considered enemies.";
		next;
		mes "- Prior quests exists. -";
		close3;
	}
	switch(ep17_2_garden){
		case 0:
			cloakoffnpc "Elyumina#jh_ba1", getcharid(0);
			cloakoffnpc "Rookie#jh_ba1", getcharid(0);
			cutin "ep171_elyumina01.bmp", 2;
			emotion ET_SURPRISE, getnpcid(0, "Elyumina#jh_ba1");
			mes "[Elyumina]";
			mes "I guess I've been thinking wrong. Isn't the guy called Varmundt amazing?";
			mes "I should've come sooner for these beautiful automatic dolls.";
			npctalk "Elyumina: I would not have been caught in the first place.","Elyumina#jh_ba1",bc_self;
			next;
			mes "[Elyumina]";
			mes "This connection is beautiful, with network-based centralized core control that allows the object to freely control the sub-objects that are deployed throughout the mansion.";
			next;
			emotion ET_BIGTHROB, getnpcid(0, "Elyumina#jh_ba1");
			cutin "ep171_elyumina04.bmp", 2;
			mes "[Elyumina]";
			mes "Well still, every sub-objects is being operated in an individual way.";
			mes "This is fun! I'm curious about how it works.";
			next;
			cloakoffnpc "Lazy#jh_ba1", getcharid(0);
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "You look happy, even though I don't know what made you happy.";
			next;
			mes "[Rookie]";
			mes "By the way, be careful. There is a toxic sewage nearby running under the thin iron plate.";
			next;
			cutin "16lei_02.bmp", 2;
			mes "[Lazy]";
			mes "I guess you can't hear me because you're so absorbed in the new machine and the automatic doll. You look like a kid with a new toy, Mr. Criminal Scientist.";
			next;
			emotion ET_DELIGHT, getnpcid(0, "Elyumina#jh_ba1");
			cutin "ep171_elyumina01.bmp", 2;
			mes "[Elyumina]";
			mes "Does the automatic doll run this place? Can I talk to her for a moment?";
			mes "Don't worry, I'm not a suspicious person.";
			next;
			cutin "16lei_02.bmp", 2;
			mes "[Lazy]";
			mes "You are more approachable to an automatic doll than a person.";
			mes "What? Wait. That automatic doll looks kinda weird. Mr. Criminal Scientist, be carefu...";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Rensij]";
			mes "Confirmed! An intruder has been recognized. Start with elimination.";
			next;
			sleep2 1000;
			emotion ET_HUK, getnpcid(0, "Elyumina#jh_ba1");
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Wait, just wait. I'm properly authorized… Ahhhhh!";
			specialeffect EF_ICECRASH,AREA,"Elyumina#jh_ba1"; //135
			cloakonnpc "Elyumina#jh_ba1", getcharid(0);
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Whoa! It's dangerous!";
			next;
			cloakoffnpc "Elyumina#jh_ba1", getcharid(0);
			cutin "ep171_elyumina02.bmp", 2;
			emotion ET_KEK, getnpcid(0, "Elyumina#jh_ba1");
			mes "[Elyumina]";
			mes "Ahhh! Ehem ehem ehem!";
			mes "Ahhh! Wha--- what is this?? I almost died! I can't believe you did this in a lovely way, I'm all wet!";
			next;
			mes "[Elyumina]";
			mes "Do you think you can just be forgiven by being pretty? It's not that easy! What is this disturbing smell?";
			next;
			cutin "16loo_01.bmp", 2;
			npctalk "Lazy: That's kinda weird, but are you sure you're okay?","Lazy#jh_ba1",bc_self;
			mes "[Rookie]";
			mes "That could've been a disaster!";
			mes "He's with us and he is not an intruder. Why did you do this when you could always communicate with Alpha?";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Rensij]";
			mes "Network check, automatic error correction. Reconfirm packets...";
			mes "Oh, I checked....";
			mes "but more than 62% of the behavior patterns that resemble intruders were considered intruders.";
			next;
			cutin "16lei_02.bmp", 2;
			mes "[Lazy]";
			mes "How about the 38%?";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Don't joke like that, Mr. Lazy!";
			mes "You know that Mina is no longer an illusion now.";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Wait… I feel kinda weird… my head hurts. I'm starting to feel dizzy and nauseous.";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Oh no! The sewage around here is coming from the lab, so it's almost like a poison.";
			mes "I can't believe you fell into the water that would be bad for you.";
			next;
			select("Shouldn't you see a doctor?");
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I think that's a good idea, Mr. Adventurer. Could you tell him to go to <NAVI>[the mansion]<INFO>ba_maison,169,270,0,101,0</INFO></NAVI> and prepare the medical facility?";
			mes "Lazy and I will accompany Elyumina";
			next;
			if(select("Leave it to me!:Refuse.") == 2){
				mes "[Rookie]";
				mes "No worries adventurer.";
				mes "You've done a lot.";
				cloakonnpc "Elyumina#jh_ba1", getcharid(0);
				cloakonnpc "Lazy#jh_ba1", getcharid(0);
				cloakonnpc "Rookie#jh_ba1", getcharid(0);
				close3;
			}
			navigateto("ba_maison",169,270,NAV_ALL);
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Thank you, Mr. Adventurer! I'll be right with you.";
			mes "Oh my gosh! I think Mina's face is turning blue? Mr. Adventurer, tell him to get ready quickly!";
			setquest 16427;
			ep17_2_garden = 1;
			sleep2 1000;
			cloakonnpc "Elyumina#jh_ba1", getcharid(0);
			cloakonnpc "Lazy#jh_ba1", getcharid(0);
			cloakonnpc "Rookie#jh_ba1", getcharid(0);
			close3;
		case 1:
			cloakoffnpc "Elyumina#jh_ba1", getcharid(0);
			cloakoffnpc "Lazy#jh_ba1", getcharid(0);
			cloakoffnpc "Rookie#jh_ba1", getcharid(0);
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I think that's a good idea, Mr. Adventurer. Could you tell him to go to <NAVI>[the mansion]<INFO>ba_maison,169,270,0,101,0</INFO></NAVI> and prepare the medical facility?";
			mes "Lazy and I will accompany Elyumina";
			close2;
			cloakonnpc "Elyumina#jh_ba1", getcharid(0);
			cloakonnpc "Lazy#jh_ba1", getcharid(0);
			cloakonnpc "Rookie#jh_ba1", getcharid(0);
			cutin "16loo_01.bmp", 255;
			end;
		default:
			cutin "ep172_beta.bmp", 2;
			mes "[Rensij]";
			mes "Hello, "+strcharinfo(0)+". Welcome to the sewage treatment plant.";
			next;
			mes "[Rensij]";
			mes "This area is where the waste flows from the laboratory. It is advised that you stay away from skin contact, or ingestion, as it can lead to death.";
			next;
			mes "[Rensij]";
			mes "If you need a poison, I could give you one...";
			close3;
	}
	end;

OnInit:
	questinfo ( QTYPE_QUEST,QMARK_YELLOW," ep17_2_main > 9 && ep17_2_garden == 0 && isbegin_quest(16427) == 0 ");
	end;
}

ba_pw02,45,267,3	duplicate(dummy_cloaked_npc)	Elyumina#jh_ba1	4_EP17_ELYUMINA
ba_pw02,48,262,1	duplicate(dummy_cloaked_npc)	Lazy#jh_ba1	4_M_LAZY
ba_pw02,50,264,3	duplicate(dummy_cloaked_npc)	Rookie#jh_ba1	4_M_ROOKIE

ba_maison,169,270,5	script	Need#jh_ba	4_EP17_BASIC_B,{
	switch(ep17_2_garden){
		case 1:
			cutin "ep172_beta.bmp", 2;
			emotion ET_KEK, getnpcid(0, "Need#jh_ba");
			mes "[Need]";
			mes "Wow~ There's a guest! Hello!";
			mes "I have been waiting for you to come all this time!";
			next;
			mes "[Need]";
			mes "What do you want to do first? Eat? Rest? Wash?";
			mes "Just tell me and I'll prepare anything for you!";
			next;
			select("Medical facilities are needed.");
			cutin "ep172_beta.bmp", 2;
			sleep2 1000;
			emotion ET_KEK, getnpcid(0, "Need#jh_ba");
			mes "[Need]";
			mes "Oh my gosh! Are you hurt sir? Where? How? How much does it hurt?";
			mes "I'll prepare the medical device and the resting area right now!";
			next;
			select("No. It's not that...");
			cloakoffnpc "Elyumina#jh_ba2", getcharid(0);
			cloakoffnpc "Lazy#jh_ba2", getcharid(0);
			cloakoffnpc "Rookie#jh_ba2", getcharid(0);
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "You look so pale. You can't walk properly. You should change your wet clothes also.";
			mes "Mr. Adventurer will have it ready for immediate medical attention. Cheer up!";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Ugghh... I feel so weird. Ahhh. I can see a machine flowing and a river of screws over there...";
			next;
			cutin "16lei_03.bmp", 2;
			mes "[Lazy]";
			mes "What are you looking at? I don't think this is normal. Are you okay, Mr. Criminal Scientist?";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Need]";
			mes "No? He's an intruder. Intruder!";
			mes "Don't worry, I won't harm you. I'll call security for help!";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Ah… I'm feeling better now. Intruder or whatever, all I have to do is cross that river. Hahahaha";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Wait, wait! She is our companion.";
			mes "She needs a diagnosis and treatment. Please hurry up!";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Need]";
			mes "You don't need a diagnosis, I've been told what happened.";
			mes "You've been exposed to the contaminated wastewater that is specifically coming from the sewage treatment plant, haven't you?";
			next;
			npctalk "Elyumina: No, I didn't do it because I wanted to be exposed in that. I'm telling the truth.","Elyumina#jh_ba2",bc_self;
			mes "[Need]";
			mes "Then why would you have access to that dangerous disposal drugs from the lab...";
			mes "Explain your side, your life is at sake!";
			next;
			mes "[Need]";
			mes "Hmm... That's bad.";
			mes "I can see that you are almost addicted to the poison.";
			next;
			cutin "16loo_01.bmp", 2;
			npctalk "Lazy: Hmm, you sound like this is enjoyable. It's not fun at all, isn't it?","Lazy#jh_ba2",bc_self;
			emotion ET_OTL, getnpcid(0, "Rookie#jh_ba2");
			mes "[Rookie]";
			mes "It's not the time to say that!";
			mes "Is there any way we can solve it?";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Need]";
			mes "Well, sir, but she's not a guest.";
			mes "She's an intruder and we can't give intruders the same benefits with guests.";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Okay, okay, I guess just forget about it.";
			mes "I'm just going to die. Good bye, my beloved machines. I'm going first.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Don't say that! Is there anything we can do?";
			mes "Just because she was an illusion once doesn't mean she's an illusion forever. Although she still have to pay for her sins, she has to live first.";
			next;
			npctalk "Lazy: Yeah, she somehow still looks like an illusion, but she is little different from an illusion, a little bit.","Lazy#jh_ba2",bc_self;
			npctalk "Elyumina: A little? Can you stop including me in the same category as those idiots?","Elyumina#jh_ba2",bc_self;
			mes "[Need]";
			mes "You guys won't be able to say anything if you only knew how much the intruders ruined our precious work.";
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "I don't have a choice but to use it this way.";
			mes "Hey, ^0000CDas a mercenary who came here as a guest of Mr. Varmundt, I'm begging you!!!^000000";
			mes "I want to save these people. Tell me how!!!";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "...why are you this determined? What did I tell you? Well I am the great Elliumina, but you guys are...";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Need]";
			mes "W-Well... if you say it to that point...";
			mes "you can make an antidote out of Silva Papila's leaves which you can get from the water garden. The owner planted it for that purpose.";
			next;
			mes "[Need]";
			mes "But I don't know if the gardeners will let you in.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "‘Cause a person's life is at risk! That's enough. You said it's the <NAVI>[water garden]<INFO>ba_maison,239,47,0,101,0</INFO></NAVI> right? Let's go and let's get it by ourselves!";
			erasequest 16427;
			setquest 16428;
			ep17_2_garden = 2;
			cutin "16loo_01.bmp", 255;
			close2;
			questinfo_refresh();
			cloakonnpc "Elyumina#jh_ba2", getcharid(0);
			cloakonnpc "Lazy#jh_ba2", getcharid(0);
			cloakonnpc "Rookie#jh_ba2", getcharid(0);
			end;
		case 2:
			cutin "ep172_beta.bmp", 2;
			mes "[Need]";
			mes "You can make an antidote out of Silva Papila's leaves which you can get from the water garden. The owner planted it for that purpose.";
			mes "But I don't know if the gardeners will let you in.";
			navigateto("ba_maison",169,270,NAV_ALL);
			close3;
		default:
			break;

	}
	cutin "ep172_beta.bmp", 2;
	mes "[Need]";
	mes "You can eat whatever food you feed to hamsters in the garden.";
	mes "However, you shouldn't hit it.";
	next;
	mes "[Need]";
	mes "Oh, a sweeping robot? Of course there are some managers who call it that way...";
	mes "I am called a hamster. I read it in a book. If you diligently pick up something and put it in the bowl, it was like a hamster. Besides, hamsters are more cute than cleaning robots, right?";
	close3;
	
OnInit:
	questinfo ( QTYPE_QUEST,QMARK_YELLOW," isbegin_quest(16427) == 1 ");
	end;
}

ba_maison,174,266,1	duplicate(dummy_cloaked_npc)	Elyumina#jh_ba2	4_EP17_ELYUMINA
ba_maison,176,270,3	duplicate(dummy_cloaked_npc)	Lazy#jh_ba2	4_M_LAZY
ba_maison,177,268,3	duplicate(dummy_cloaked_npc)	Rookie#jh_ba2	4_M_ROOKIE

ba_maison,239,47,3	script	Seiyu#jh_ba	4_EP17_SCISSORE,{
	switch(ep17_2_garden){
		case 2:
			cloakoffnpc "Lazy#jh_ba3", getcharid(0);
			cloakoffnpc "Rookie#jh_ba3", getcharid(0);
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "……………….";
			next;
			cutin "16lei_02.bmp", 2;
			mes "[Lazy]";
			mes "No wonder your gaze is cold.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "Welcome, guest…….";
			mes "What can I help you?";
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "Can I enter into the water garden? I need to get ^0000CDSilva Papila's leaves^000000 from there. I would like to ask for your permission.";
			mes "I would like to ask for your permission.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "Ah~ you really came! Someone also asked me that!";
			mes "I don't wanna help that intruder!";
			next;
			cutin "16lei_03.bmp", 2;
			mes "[Lazy]";
			mes "I've been curious about this for a while, but since she is our company, how can you distinguish the intruders from the guests?";
			next;
			mes "[Lazy]";
			mes "Even this criminal scientist's face doesn't say that she is an intruder or not.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "We can't distinguish, we just collect data. Everything you say and do is the data that we collect.";
			next;
			mes "[Seiyu]";
			mes "And we just compare it to produce the closest result. Then we get to conclude the intruders must be eliminated. This is our protocol from Alpha.";
			next;
			mes "[Seiyu]";
			mes "I'd like to ask. Why are you trying to save her?";
			mes "She's even a threat to you.";
			next;
			mes "[Seiyu]";
			mes "Is it because she's still useful? Is that what people do?";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Ah, about that...";
			next;
			switch(select("Elyumina is our companion.:To give back as much as we have been helped.:I don't want to kill an enemy or a companion.")){
				case 1:
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "Why? I'm learning what a companion is.";
					mes "According to that definition, she is not a companion.";
					next;
					cutin "ep171_elyumina03.bmp", 2;
					mes "[Elyumina]";
					mes "Human beings are stupid. That's why I'm doing something different than the beautiful thinking of the machine... it's kind of miserable.. that's my story.";
					next;
					cutin "ep171_elyumina04.bmp", 2;
					mes "[Elyumina]";
					mes "Anyway, the machine with such curiosity, it's so attractive. I want to know more about your way of thinking.";
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "I exclude you.";
					mes "Human's judgement too, is difficult for me. But thank you for your input.";
					next;
					mes "[Seiyu]";
					mes "...good. Then please do me a favor.";
					mes "We'll let you enter the water garden, so please help us with our work instead.";
					next;
					mes "[Seiyu]";
					mes "Due to the intruders' interruption, some tasks in the water garden have been paralyzed.";
					mes "If you promise to help me with this, I'll open the water garden for you.";
					next;
					break;
				case 2:
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "Is that so? So since she's useful to you, by saving her it means she has to be helpful in the future also, right?";
					next;
					cutin "ep171_elyumina04.bmp", 2;
					mes "[Elyumina]";
					mes "Hahahaha… It's like the automatic doll, right? Because you're helpful to people, to be helpful you are moving.";
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "Don't compare us with you.";
					mes "But as a person's criteria of judgement, I think I can understand it a little.";
					next;
					mes "[Seiyu]";
					mes "...ok. Then please do me a favor.";
					mes "I'll let you enter the water garden but please help us with our work instead.";
					next;
					mes "[Seiyu]";
					mes "Due to the intruders' interruption, some tasks in the water garden have been paralyzed.";
					mes "If you promise to help me with this, I'll open the water garden for you.";
					next;
					break;
				case 3:
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "I didn't expect you to say that.";
					mes "Based on data so far, human beings are species thath urt each other if necessary.";
					next;
					cutin "ep171_elyumina03.bmp", 2;
					mes "[Elyumina]";
					mes "I didn't want to kill anyone. But they're weak and stupid, and they keep dying on their own.";
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "The opinion of the intruder is worthless.";
					next;
					mes "[Seiyu]";
					mes "...human beings are really tricky.";
					mes "I don't get the point of your criteria, but I unde.";
					next;
					mes "[Seiyu]";
					mes "...ok. Then please do me a favor.";
					mes "I'll let you enter the water garden but please help us with our work instead.";
					next;
					mes "[Seiyu]";
					mes "Due to the intruders' interruption, some tasks in the water garden have been paralyzed.";
					mes "If you promise to help me with this, I'll open the water garden for you.";
					next;
					break;
			}
			switch(select("Give help.:Don't help.")){
				case 1:
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "This is a deal, just a deal.";
					mes "I'm still aware of my duty to eliminate intruders.";
					next;
					cutin "ep171_elyumina04.bmp", 2;
					mes "[Elyumina]";
					mes "At this point, I'm starting to get competitive. I'll make you fall in love with me.";
					next;
					cutin "16lei_02.bmp", 2;
					mes "[Lazy]";
					mes "You sound like a heroine of a romance novel. Your partner is very confusing.";
					next;
					cutin "16loo_03.bmp", 2;
					mes "[Rookie]";
					mes "All right! Well, whether it's a revenge or a romance novel, just make an antidote and talk about it after you get better.";
					mes "Can we start moving now? They say it's dangerous inside.";
					next;
					cutin "ep171_elyumina03.bmp", 2;
					mes "[Elyumina]";
					mes "Sorry guys. It's hard for me even just by walking.";
					next;
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "Well if that's the case, I guess I have to stay here to watch over her.";
					mes "Mr. Adventurer, can you go inside and get Silva Papila's leaves?";
					next;
					cutin "16lei_01.bmp", 2;
					mes "[Lazy]";
					mes "I'm a non-combat agent, so I personally want to stay outside. My power is to protect myself, so I keep myself to the minimum pain. I am..";
					next;
					cutin "16loo_03.bmp", 255;
					if(select("I'll be back.:I'm a non-combat agent too..") == 2){
						cutin "16lei_01.bmp", 2;
						mes "[Lazy]";
						mes "Huh? Adventurer.... Look back on the battles you have done so far.";
						mes "And put your hand on your chest and think again.";
						close3;
					}
					cutin "16loo_01.bmp", 2;
					mes "[Rookie]";
					mes "I believe in you, Mr. Adventurer. Come back safely!";
					mes "Then let's just wait here. Go and talk again to Miss Seiyu once you come back.";
					next;
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "Talk to <NAVI>[Harard]<INFO>ba_maison,238,44,0,101,0</INFO></NAVI>. You may enter the water garden.";
					mes "It could be dangerous there but you brought it on yourself, so be careful.";
					next;
					cutin "16lei_02.bmp", 2;
					mes "[Lazy]";
					mes "My heart seems to... but that automatic doll..";
					next;
					cutin "ep171_elyumina01.bmp", 2;
					mes "[Elyumina]";
					mes "Automatic dolls are okay though..";
					ep17_2_garden = 3;
					erasequest 16428;
					setquest 16429;
					cutin "ep171_elyumina01.bmp", 255;
					close2;
					cloakonnpc "Lazy#jh_ba3", getcharid(0);
					cloakonnpc "Rookie#jh_ba3", getcharid(0);
					questinfo_refresh();
					end;
				case 2:
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "Then there is no deal.";
					mes "As I said earlier, It is my duty to defend the mansion against the intruder.";				
					close3;
			}
		case 3:
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "You can go to the water garden with <NAVI>[Harard]<INFO>ba_maison,238,44,0,101,0</INFO></NAVI>'s guidance.";
			mes "It could be dangerous there but you brought it on yourself, so be careful.";
			close3;
		case 4:
			cloakoffnpc "Rookie#jh_ba3", getcharid(0);
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "You came back safely.";
			mes "It's a relief Mr. Adventurer!";
			next;
			cloakoffnpc "Lazy#jh_ba3", getcharid(0);
			cutin "16lei_01.bmp", 2;
			mes "[Lazy]";
			mes "Since we have Silva Papila's leaves, let's go ask for an antidote.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "I can make the antidote.";
			mes "In the first place, Silva Papila's leaves are antidote themselves for many different symptoms. All you have to do is change the formula to make it easier to eat.";
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "Then.. Can we have it?";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "Okay, give me Silva Papila's leaves.";
			next;
			select("Hand over the leaves.");
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "……………….";
			next;
			mes "[Seiyu]";
			mes "……………….";
			mes "……………….";
			next;
			mes "[Seiyu]";
			mes "……………….";
			mes "……………….";
			mes "……………….";
			next;
			cutin "ep171_elyumina01.bmp", 2;
			mes "[Elyumina]";
			mes "I love looking at the smart automatic dolls made by others.";
			mes "I want to make a research of it and analyze it once I get rid of this dizziness.";
			next;
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "I am not happy even if you compliment me.";
			mes "...Here's the antidote.";
			next;
			select("Take the antidote.");
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "Okay. After you're done with your work, I'd like to ask for your help.";
			mes "I trust you that you will keep your promise.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Deliver the antidote to <NAVI>[Elyumina]<INFO>ba_maison,234,51,0,101,0</INFO></NAVI>.";
			erasequest 16437;
			erasequest 16429;
			setquest 16430;
			ep17_2_garden = 5;
			questinfo_refresh();
			cloakonnpc "Lazy#jh_ba3", getcharid(0);
			cloakonnpc "Rookie#jh_ba3", getcharid(0);
			close3;
		case 5:
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "Okay. After you're done with your work, I'd like to ask for your help.";
			mes "I trust you that you will keep your promise.";
			close3;
		case 6:
			cutin "ep172_beta.bmp", 2;
			mes "[Seiyu]";
			mes "Welcome, Guest.";
			mes "Are you here to keep your promise? I also have a favor to ask you today.";
			next;
			setarray .@quest_id[0], 16431, 16433, 16435;
			setarray .@quest_menu$[0], "Hunt Silva Papila", "Hunt Gran Papila", "Gardener's Location";
			.@size = getarraysize(.@quest_id);
			for ( .@i = 0; .@i < .@size; ++.@i ) {
				switch( checkquest(.@quest_id[.@i],HUNTING) ) {
					case -1:
						switch( checkquest(.@quest_id[.@i] + 1, PLAYTIME) ) {
							case -1:
								.@color$ = "^000000";
								.@started_quest$ = "[Daily] ";
								break;
							case 0:
							case 1:
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Wait] ";
								break;
							case 2:
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Ready] ";
								break;
						}
						break;
					case 0:
					case 1:
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[In Progress] ";
						break;
					case 2:
						if(.@quest_id[.@i] == 16435){
							if(!ep17_2_garden_daily){
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[In Progress] ";
								break;									
							} else {
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Completed] ";
								break;								
							}
							break;
						}
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[Completed] ";
						break;
				}
				.@menu$ += .@color$ + .@started_quest$ + .@quest_menu$[.@i] + "^000000:";
			}
			.@select = select(.@menu$ + "Don't help.") - 1;
			if (.@select == .@size) {
				cutin "ep172_beta.bmp", 2;
				mes "[Seiyu]";
				mes "I'm disappointed with you.";
				mes "Are you breaking your promise?";
				close3;
			}
			switch( checkquest(.@quest_id[.@select],HUNTING) ) {
				case -1:
					switch( checkquest(.@quest_id[.@select] + 1, PLAYTIME) ) {
						case -1:
							break;
						case 0:
						case 1:
							cutin "ep172_beta.bmp", 2;
							mes "[Seiyu]";
							mes "Thank you for your help adventurer.";
							mes "Please come back after dawn.";
							close3;
						case 2:
							erasequest.@quest_id[.@select] + 1;
							break;
					}
					switch( .@quest_id[.@select] ) {
						case 16431:
							mes "[Seiyu]";
							mes "Even though you have met it already, there is a plant called Silva Papila in the deepest part of the water garden.";
							mes "It is a very wise and sensitive plant that controls many butterflies.";
							next;
							mes "[Seiyu]";
							mes "Since we got interrupted by the intruders we are out of spare hands, our gardeners alone can't handle this picky plant.";
							next;
							mes "[Seiyu]";
							mes "When you go to the water garden and ^0000CDSilva Papila^000000 appears, can you hunt one and keep it?";
							break;
						case 16433:
							mes "[Seiyu]";
							mes "Deep in the water garden, there is a plant called Grand Papila which is more rare than the Silva Papila.";
							mes "It is stronger, wiser, and more sensitive.";
							next;
							mes "[Seiyu]";
							mes "After the intruders appearred, the delicate plant was forced to emit scent to show itself.";
							next;
							mes "[Seiyu]";
							mes "When you go to the water garden and ^0000CDGrand Papila^000000 appears, can you hunt one and keep it?";
							break;
						case 16435:
							mes "[Seiyu]";
							mes "Recently, due to the interruption of the intruders and the plants' mutation, the gardeners are often replaced.";
							mes "There are some gardeners who lost contacts in the water garden.";
							next;
							mes "[Seiyu]";
							mes "Well, it seems like we are losing much contact inside the maze garden, I guess something is going wrong.";
							next;
							mes "[Seiyu]";
							mes "Is it the network's problem or is it because they forget to communicate? Can you go and check if they are all right?";
							break;
					}
					next;
					if ( select("Okay.", "I will rest for today.") == 2 ){
						mes "[Seiyu]";
						mes "Such a disappointing human behavior.";
						close3;
					}
					cutin "ep172_beta", 2;
					mes "[Seiyu]";
					mes "Thank you for fulfilling your promise.";
					mes "You can go to the water garden with <NAVI>[Harard]<INFO>ba_maison,238,44,0,101,0</INFO></NAVI>'s guidance.";
					setquest .@quest_id[.@select];
					questinfo_refresh();
					close3;
				case 0:
				case 1:
					switch( .@quest_id[.@select] ) {
						case 16431:
						case 16433:
						case 16435:
							mes "[Seiyu]";
							mes "You may enter the water garden. Talk to <NAVI>[Harard]<INFO>ba_maison,238,44,0,101,0</INFO></NAVI> who is next to me.";
							mes "It could be dangerous there but you brought it on yourself, so be careful.";
							close3;
					}
				case 2:
					if(.@quest_id[.@select] == 16435){
						if(!ep17_2_garden_daily){
							mes "[Seiyu]";
							mes "You may enter the water garden. Talk to <NAVI>[Harard]<INFO>ba_maison,238,44,0,101,0</INFO></NAVI> who is next to me.";
							mes "It could be dangerous there but you brought it on yourself, so be careful.";
							close3;									
						}
					}		
					cutin "ep172_beta.bmp", 2;
					mes "[Seiyu]";
					mes "Thank you for your help adventurer.";
					mes "Please come back after dawn.";	
					erasequest .@quest_id[.@select];
					setquest .@quest_id[.@select] + 1;
					.@qid = .@quest_id[.@select];
					if(.@qid == 16435 && ep17_2_garden_daily > 0) ep17_2_garden_daily = 0;
					getitem 1000103, 5;
					questinfo_refresh();
					close3;
			}
		default:
			break;
	}
	if(ep17_2_garden < 3){
		cutin "ep172_beta", 2;
		mes "[Seiyu]";
		mes "Hello, guest.";
		mes "This is a garden dock, but there are currently no boat operations.";
		close3;
	}
	end;
	
OnInit:
	questinfo ( QTYPE_QUEST,QMARK_YELLOW," isbegin_quest(16428) == 1 && ep17_2_garden == 2 ");
	questinfo ( QTYPE_QUEST,QMARK_YELLOW," checkquest(16429,HUNTING) == 2 && ep17_2_garden == 4 ");
	questinfo ( QTYPE_DAILYQUEST,QTYPE_QUEST, " ep17_2_garden >= 6 && ( checkquest(16433,HUNTING) == 2 || ep17_2_garden_daily == 1 || checkquest(16431,HUNTING) == 2 ) " );
	questinfo ( QTYPE_DAILYQUEST,QTYPE_QUEST, " ep17_2_garden >= 6 && ( checkquest(16432,PLAYTIME) == 2 || checkquest(16434,PLAYTIME) == 2 || checkquest(16436,PLAYTIME) == 2 ) && ( checkquest(16431,HUNTING) == -1 && checkquest(16433,HUNTING) == -1 && isbegin_quest(16435) == 0 ) " );	
	questinfo ( QTYPE_DAILYQUEST,QTYPE_QUEST, " ep17_2_garden >= 6 && ( checkquest(16432,PLAYTIME) == -1 || checkquest(16434,PLAYTIME) == -1 || checkquest(16436,PLAYTIME) == -1 ) && ( checkquest(16431,HUNTING) == -1 && checkquest(16433,HUNTING) == -1 && isbegin_quest(16435) == 0 ) " );
	end;
}

ba_maison,234,51,5	script	Elyumina#jh_ba3	4_EP17_ELYUMINA,{
	switch(ep17_2_garden){
		case 2:
		case 3:
			cutin "ep171_elyumina01.bmp", 2;
			mes "[Elyumina]";
			mes "……………………. ";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Damn it... not gonna die like this!";
			mes "Oh, it's wet. It doesn't dry very well.";
			close3;
			end;
		case 4:
			cloakoffnpc "Lazy#jh_ba3", getcharid(0);
			cloakoffnpc "Rookie#jh_ba3", getcharid(0);
			mes "[Elyumina]";
			mes "I'm dizzy… don't shake.";
			mes "I can't go, I can't go even if you push my back. If I go, I might just bother you.";
			next;
			cutin "16lei_02.bmp", 2;
			mes "[Lazy]";
			mes "...bothersome, you cared about that? Mr. Scientist criminal, this is a surprise.";
			next;
			cutin "ep171_elyumina02.bmp", 2;
			mes "[Elyumina]";
			mes "Shut up! Idiots don't need any consideration!";
			mes "Anyway, I'm resting here. I can't even move a step.";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "I need someone to keep an eye on Mina, so I'm staying here, Mr. Adventurer.";
			next;
			cutin "16lei_01.bmp", 2;
			mes "[Lazy]";
			mes "I'm not in charge of combat. So, Mr. Adventurer, will you take care?";
			next;
			cutin "ep171_elyumina01.bmp", 255;
			select("Is it fate to go to the water garden alone?");
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "I'm sorry, Mr. Adventurer. How about having a party with another adventurer?";
			cloakonnpc "Lazy#jh_ba3", getcharid(0);
			cloakonnpc "Rookie#jh_ba3", getcharid(0);
			close3;
		case 5:
			select("Hand over the antidote.");
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "... What is this?";
			mes "Ahh.... Is that the antidote?";
			next;
			cloakoffnpc "Lazy#jh_ba3", getcharid(0);
			cloakoffnpc "Rookie#jh_ba3", getcharid(0);
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "I'm sorry for letting you do it alone. We should've joined also.";
			npctalk "Rookie: I'm sorry for letting you do it alone. We should've joined also.","Rookie#jh_ba3",bc_self;
			next;
			cutin "ep171_elyumina01.bmp", 2;
			mes "[Elyumina]";
			mes "... you over there, thanks.";
			next;
			cutin "16lei_03.bmp", 2;
			mes "[Lazy]";
			mes "Huh? I didn't hear you well. Say it louder.";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "I am not talking to you! Mind your own business!";
			next;
			cutin "16lei_01.bmp", 2;
			mes "[Lazy]";
			mes "Okay, okay. Then why don't you go first and try it? It's so hard to see Mr. Criminal Scientist limping around.";
			next;
			cutin "ep171_elyumina03.bmp", 2;
			mes "[Elyumina]";
			mes "Ahh, you are giving me a headache...";
			mes "Anyways, thank you "+strcharinfo(0)+". Thank you for getting me the medicine.";
			next;
			mes "[Elyumina]";
			mes "And also you… is it Rocky? Lucky? Anyway, rebellion. Thanks for running around.";
			npctalk "……Rookie, It's Rookie.","Rookie#jh_ba3",bc_self;
			npctalk "How about me? You're not thankful to me?","Lazy#jh_ba3",bc_self;
			next;
			mes "[Elyumina]";
			mes "As I've said, I am not an illusion already and I don't have any sense of belonging there anyway.";
			mes "I just stayed because they funded my research.";
			next;
			cutin "ep171_elyumina01.bmp", 2;
			mes "[Elyumina]";
			mes "But it's really different when you insist on it and when others admit it.";
			next;
			mes "[Elyumina]";
			mes "Being hated by those cute and smart automatic dolls. too bad...";
			next;
			cutin "16lei_03.bmp", 2;
			mes "[Lazy]";
			mes "So that's exactly what you want to say?";
			next;
			cutin "ep171_elyumina01.bmp", 2;
			mes "[Elyumina]";
			mes "Anyway, I'm not going to get involved with those idiots again. I promise.";
			next;
			cutin "ep171_elyumina04.bmp", 2;
			mes "[Elyumina]";
			mes "And if I can do something, I'll support you in catching them.";
			next;
			cutin "16loo_03.bmp", 2;
			mes "[Rookie]";
			mes "Oh yeah! This conversation is a bit awkward…";
			mes "but thanks!";
			next;
			cutin "16loo_01.bmp", 2;
			mes "[Rookie]";
			mes "Well, you also had a hard time coming back from the water garden.";
			mes "It's not much, but I can give you some of my food coupons. Will you take it?";
			next;
			cutin "16loo_02.bmp", 2;
			mes "[Rookie]";
			mes "I'm looking forward to helping Seiyu's work in the future. I'll come and help you from time to time!";
			erasequest 16430;
			getitem 909, 1;
			ep17_2_garden = 6;
			questinfo_refresh();
			cloakonnpc "Lazy#jh_ba3", getcharid(0);
			cloakonnpc "Rookie#jh_ba3", getcharid(0);
			close3;
		default:
			break;
	}
	cutin "ep171_elyumina03.bmp", 2;
	mes "[Elyumina]";
	mes "Shhh, be quiet! You shouldn't be caught here alone!";
	next;
	cutin "ep171_elyumina02.bmp", 2;
	mes "[Elyumina]";
	mes "If you're thinking about taking a precious opportunity to chat with the mansion's automatic dolls, don't let it go!";
	close3;
	
OnInit:
	questinfo ( QTYPE_QUEST,QMARK_YELLOW," isbegin_quest(16430) == 1 && ep17_2_garden == 4 ");
	end;
}

ba_maison,233,48,5	duplicate(dummy_cloaked_npc)	Lazy#jh_ba3	4_M_LAZY
ba_maison,235,45,3	duplicate(dummy_cloaked_npc)	Rookie#jh_ba3	4_M_ROOKIE
//Harard is moved to water-garden instance file as it includes a lot.

//Cleaning Robot Daily
ba_in01,24,322,3	script	Cleaning Robot Omega#res_int1	20640,{
	switch(ep17_2_robot_daily){
		case 0:
			if(ep17_2_main > 6){
				setpcblock PCBLOCK_ALL,true;
				stopnpctimer;
				sleep2 3000;
				npctalk "Cleaning Robot: You are an authorized user. Nice to meet you.";
				sleep2 1500;
				setpcblock PCBLOCK_ALL,false;
				mes "[Cleaning Robot Omega]";
				mes "Hello, nice to meet you~ I'm cleaning robot omega.";
				next;
				select("Hello nice to meet you.");
				mes "[Cleaning Robot Omega]";
				mes "The task of the cleaning robot omega is to clean the sewage treatment plant and the first power plant~";
				next;
				mes "[Cleaning Robot Omega]";
				mes "But the cleaning robot omega is not able to clean now~ So sad~";
				next;
				mes "[Cleaning Robot Omega]";
				mes "Unauthorized users prevents us cleaning robots to do our job~";
				next;
				mes "[Cleaning Robot Omega]";
				mes "Cleaning robot omega is having a hard time~ I hope the kind guest will help me~ Please ~";
				next;
				if(select("I will help you:I won't") == 2) close;
				mes "[Cleaning Robot Omega]";
				mes "Our guest is a really kind~ Cleaning robot omega is happy~";
				setquest 5892;
				completequest 5892;
				ep17_2_robot_daily = 1;
				questinfo_refresh();
				close;
			}
			end;
		case 1:
			setpcblock PCBLOCK_ALL,true;
			stopnpctimer;
			sleep2 3000;
			npctalk "Cleaning Robot: You are an authorized user. Nice to meet you.";
			sleep2 1500;
			setpcblock PCBLOCK_ALL,false;
			mes "[Cleaning Robot Omega]";
			mes "Nice to meet you~ I am a very strong cleaning robot omega!!";
			next;
			setarray .@quest_id[0], 5893, 5897;
			setarray .@quest_menu$[0], "Sewage Treatment Plant", "First Power Plant";
			.@size = getarraysize(.@quest_id);
			for ( .@i = 0; .@i < .@size; ++.@i ) {
				switch( checkquest(.@quest_id[.@i],HUNTING) ) {
					case -1:
						switch( checkquest(.@quest_id[.@i] + 3, PLAYTIME) ) {
							case -1:
								.@color$ = "^000000";
								.@started_quest$ = "[Daily] ";
								break;
							case 0:
							case 1:
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Wait] ";
								break;
							case 2:
								.@color$ = "^8C8C8C";
								.@started_quest$ = "[Ready] ";
								break;
						}
						break;
					case 0:
					case 1:
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[In Progress] ";
						break;
					case 2:
						if( checkquest(.@quest_id[.@i] + 1,HUNTING) != 2 || checkquest(.@quest_id[.@i] + 2,HUNTING) != 2 ){
							.@color$ = "^8C8C8C";
							.@started_quest$ = "[In Progress] ";
							break;
						}
						.@color$ = "^8C8C8C";
						.@started_quest$ = "[Completed] ";
						break;
				}
				.@menu$ += .@color$ + .@started_quest$ + .@quest_menu$[.@i] + "^000000:";
			}
			.@select = select(.@menu$ + "Good job.") - 1;
			if (.@select == .@size) {
				mes "[Cleaning Robot Omega]";
				mes "Terminate communication.";
				close;
			}
			switch( checkquest(.@quest_id[.@select],HUNTING) ) {
				case -1:
					switch( checkquest(.@quest_id[.@select] + 3, PLAYTIME) ) {
						case -1:
							break;
						case 0:
						case 1:
							mes "[Cleaning Robot Omega]";
							mes "Today's work has already been completed. Please come back after dawn.";
							mes "Thank you.";
							close;
						case 2:
							erasequest.@quest_id[.@select] + 3;
							break;
					}
					mes "[Cleaning Robot Omega]";
					switch( .@quest_id[.@select] ) {
						case 5893:
							mes "Since there are many sewage venenum, cramp, and waterfall in the sewage treatment plant, cleaning is not possible.";
							next;
							mes "[Cleaning Robot Omega]";
							mes "It would be better if you can help me eradicate 44 of each of sewage venenum, cramp and waterfall?";
							break;
						case 5897:
							mes "Since there are many elite bellare, mana addict dolor, and unleashed mana in the first power plant, cleaning is not possible.";
							next;
							mes "[Cleaning Robot Omega]";
							mes "It would be better if you can help me eradicate 44 of each of sewage elite bellare, mana addict dolor, and unleashed mana?";
							break;
					}
					if ( select("Accept", "Reject") == 2 ) close;
					next;
					mes "[Cleaning Robot Omega]";
					mes "Thank you for your help.";
					setquest .@quest_id[.@select];
					setquest .@quest_id[.@select] + 1;
					setquest .@quest_id[.@select] + 2;
					close;
				case 0:
				case 1:
					mes "[Cleaning Robot Omega]";
					mes "Thank you for doing my work. Please be safe.";
					close;
				case 2:
					if( checkquest(.@quest_id[.@select] + 1,HUNTING) != 2 || checkquest(.@quest_id[.@select] + 2,HUNTING) != 2 ){
						mes "[Cleaning Robot Omega]";
						mes "There are still lurking around in the place.";
						mes "Please make sure you completed my request.";
						close;
					}
					mes "[Cleaning Robot Omega]";
					mes "Thank you very much for your help.";
					mes "Cleaning Robot Omega is happy to be able to go clean up~";
					mes "See you tomorrow. Terminating communication.";
					erasequest .@quest_id[.@select];
					erasequest .@quest_id[.@select] + 1;
					erasequest .@quest_id[.@select] + 2;
					setquest .@quest_id[.@select] + 3;
					getitem 1000103, 6;
					close;
			}
	}
	
OnRobotMove:
	.@gid = getnpcid(0);
	npcspeed 200;
	.@x = rand(16,31);
	.@y = rand(311,332);
	while(!checkcell("ba_in01",.@x,.@y,cell_chkpass)){
		.@x = rand(16,31);
		.@y = rand(311,332);
	}
	unitwalk .@gid,.@x,.@y;
	.@skip = 0;
	switch(rand(1,11)){
		case 1:
			.@emote$ = "Cleaning Robot : (-,-) Cleaning..";
			break;
			
		case 2:
			.@emote$ = "Cleaning Robot :(------,-----)?";
			break;
			
		case 3:
			.@emote$ = "Cleaning Robot : (^) OTL..";
			break;
			
		case 4:
			.@emote$ = "Cleaning Robot : **--___--**";
			break;
			
		case 5:
			.@emote$ = "Cleaning Robot : (8>**_**<8)";
			break;
			
		case 6:
			.@emote$ = "Cleaning Robot : !^__|__^!";
			break;
			
		case 7:
			.@emote$ = "Cleaning Robot : !^---|---^!";
			break;
	
		case 8:
			.@emote$ = "Cleaning Robot : ****___-___****";
			break;
			
		case 9:
			.@emote$ = "Cleaning Robot : (*'v'*)";
			break;
			
		default:
			.@skip = 1;
			break;
	}
	if(!.@skip)
		npctalk .@emote$;
	sleep rand(1500,5000);
	donpcevent strnpcinfo(0) + "::OnRobotMove";
	end;

OnInit:
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_robot_daily == 0 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_robot_daily > 0 && (checkquest(5893,HUNTING) == -1 && checkquest(5894,HUNTING) == -1 && checkquest(5895,HUNTING) == -1) && (checkquest(5896,PLAYTIME) == 2 || checkquest(5896,PLAYTIME) == -1) " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_robot_daily > 0 && (checkquest(5897,HUNTING) == -1 && checkquest(5898,HUNTING) == -1 && checkquest(5899,HUNTING) == -1) && (checkquest(5900,PLAYTIME) == 2 || checkquest(5900,PLAYTIME) == -1) " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " checkquest(5893,HUNTING) == 2 && checkquest(5894,HUNTING) == 2 && checkquest(5895,HUNTING) == 2 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " checkquest(5897,HUNTING) == 2 && checkquest(5898,HUNTING) == 2 && checkquest(5899,HUNTING) == 2 " );
	donpcevent strnpcinfo(0) + "::OnRobotMove";
	end;
}

//Farm Quest (ep17_2_farm)
ba_maison,309,203,0	script	#garden_ent_ctrl	HIDDEN_WARP_NPC,3,3,{
	end;
	
OnTouch:
	if(ep17_2_farm < 1){
		npctalk "Luina: Wait, sir. If you want to get in there, please consult with me...","Luina#greeen",bc_self;
		sleep 2000;
		npctalk "Mepw: Beep","Meow#green",bc_self;
		end;
	}
	end;
}

ba_maison,306,206,5	script	Cotton#greeen	4_EP17_BASKET,{
	if(BaseLevel < 150){
		mes "[Cotton]";
		mes "Well, you look to weak to work. I don't think you can do it right now.";
		next;
		mes "- This quest is for level 150 or higher -";
		close;
	}
	if(ep17_2_farm > 0){
		mes "[Cotton]";
		mes "Are you here to help us?";
		mes "If you are on our side, can you play with the Pitaya in the farm?";
		mes "Of course, I will give you reward for it.";
		next;
		switch(checkquest(8595,PLAYTIME)){
			case -1:
				.@color$ = "^000000";
				break;
			case 2:
				.@color$ = "^000000";
				.@status$ = " - [Ready]";
				break;
			case 0:
			case 1:
				.@color$ = "^8C8C8C";
				.@status$ = " - [Wait]";
				break;
		}
		for(.@i = 8590; .@i < 8595; .@i++){
			switch(checkquest(.@i,HUNTING)){
				case 0:
				case 1:
					.@color$ = "^8C8C8C";
					.@status$ = " - [In-Progress]";
					break;
				case 2:
					.@color$ = "^8C8C8C";
					.@status$ = " - [Completed]";
					break;
			}
		}
		switch(select(""+.@color$+"Accept request"+.@status$+"^000000:Do not accept:Ask details")){
			case 1:
				if(checkquest(8595,PLAYTIME) == 2) {
					erasequest 8595;
					break;
				}
				switch(checkquest(8595,PLAYTIME)){
					case -1:
						if(checkquest(8590,HUNTING) == -1 && checkquest(8591,HUNTING) == -1 && checkquest(8592,HUNTING) == -1 && checkquest(8593,HUNTING) == -1 && checkquest(8594,HUNTING) == -1){
							.@mob_id = F_Rand(20649,20650,20651,20652,20653);
							if(.@mob_id == 20649){
								.@color$ = "^FF0000";
								setquest 8590;
							}
							if(.@mob_id == 20650){
								.@color$ = "^999900";
								setquest 8591;
							}
							if(.@mob_id == 20651){ 
								.@color$ = "^0000FF";
								setquest 8592;
							}
							if(.@mob_id == 20652){
								.@color$ = "^800080";
								setquest 8593;
							}
							if(.@mob_id == 20653){
								.@color$ = "^00FF00";
								setquest 8594;
							}
							mes "[Cotton]";
							mes "Thank you "+strcharinfo(0)+".";
							mes "For today, kindly play with "+.@color$+"20 "+strmobinfo(1,.@mob_id)+"^000000. You can distinguish them by color. Have fun and come back once you're done.";
							close;
						}
						for(.@i = 8590; .@i < 8595; .@i++){
							switch(checkquest(.@i,HUNTING)){
								case 0:
								case 1:
									mes "[Cotton]";
									mes "Please go now and come back once you are done.";
									close;
								case 2:
									switch(.@i){
										case 8590: .@color$ = "red"; break;
										case 8591: .@color$ = "yellow"; break;
										case 8592: .@color$ = "blue"; break;
										case 8593: .@color$ = "violet"; break;
										case 8594: .@color$ = "green"; break;
									}
									mes "[Cotton]";
									mes "Ah! There's a lot of "+.@color$+" on you... Ah, you've been playing with the Pitayas.";
									mes "Thank you!";
									mes "Here's your payment for your hard work.";
									getitem 1000103,2;
									erasequest .@i;
									setquest 8595;
									mes "[Cotton]";
									mes "Please come back after dawn.";
									close;
							}
						}
					case 0:
					case 1:
						mes "[Cotton]";
						mes "You're already full of grass today... So I'll ask you again tomorrow, kind guest!";
						close;
				}
			case 2:
				mes "[Cotton]";
				mes "Sorry for asking during your busy time.";
				mes "Anyway, in the future, let me know if you have time.";
				close;
			case 3:
				mes "[ Cotton ]";
				mes "You just have to go inside the farm and play with the Pitayas. If you accept the request, I will choose one color, but you can kill only 20 a day... No, I mean just pet them.";
				mes "Don't worry. Pitayas are naturally violent when they play, usually we get bitten when playing with them.";
				next;
				mes "[ Cotton ]";
				mes "It took quite a long time to realize that equally violent play was appropriate.";
				mes "Anyway, let me know if you have time.";
				close;
		}
	}
	mes "- My eyes met an automatic doll looking around in front of the farm. -";
	next;
	mes "[Cotton]";
	mes "Well...";
	mes "...It doesn't look good to make the guest to work...";
	mes "I don't think I can do it now.";
	next;
	mes "- The automatic doll pretended to look up and down, and then turned his head. -";
	close;

OnInit:
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_farm > 0 && (checkquest(8590,HUNTING) == -1 && checkquest(8591,HUNTING) == -1 && checkquest(8592,HUNTING) == -1 && checkquest(8593,HUNTING) == -1 && checkquest(8594,HUNTING) == -1) && (checkquest(8595,PLAYTIME) == -1 || checkquest(8595,PLAYTIME) == 2) " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " checkquest(8590,HUNTING) == 2 || checkquest(8591,HUNTING) == 2 || checkquest(8592,HUNTING) == 2 || checkquest(8593,HUNTING) == 2 || checkquest(8594,HUNTING) == 2 " );
	end;	
}

ba_maison,309,206,5	script	Meow#greeen	20653,{ end; }

ba_maison,311,206,3	script	Luina#greeen	4_EP17_BASKET,{
	if(BaseLevel < 150){
		mes "[Automatic Doll]";
		mes "Well, you look to weak to work. I don't think you can do it right now.";
		next;
		mes "- This quest is for level 150 or higher -";
		close;
	}
	if(ep17_2_main < 9){
		mes "- I've met eyes with the automatic doll in front of the farming facility. -";
		next;
		mes "- The doll looked at me up and down, and turn its head. -";
		close;		
	}
	switch(ep17_2_farm){
		case 0:
			switch(isbegin_quest(8586)){
				case 0:
					mes "- My eyes met an automatic doll looking around in front of the farm. -";
					next;
					mes "[Automatic Doll]";
					mes "Heart rate, blood pressure, and body temperature is all normal.";
					mes "Breathing is normal. Eyes stability normal.";
					mes "Registration information verified...";
					next;
					mes "- The automatic doll's eyes moved up and down as if they had scan me, and they looked satisfied. -";
					next;
					mes "[Automatic Doll]";
					mes "Hello, hello "+strcharinfo(0)+"";
					mes "Did you come to see the farm?";
					npctalk "Meow","Meow#greeen",bc_self;
					next;
					switch(select("Huh?:No.")){
						case 1:
							break;
						case 2:
							mes "[ Automatic Doll ]";
							mes "This is the farming facility, where Meow and the others live.";
							mes "Just talk to me, if you're interested.";
							mes "I will explain everything to you.";
							close;
					}
					mes "[Automatic Doll]";
					mes "Meow, hold still for a minute. Very good~";
					mes "I'm in charge of managing the farm.";
					mes "I trim the trees, give them fertilizer, and feed Meow and friends.";
					npctalk "Gogrung","Meow#greeen",bc_self;
					next;
					mes "[Automatic Doll]";
					mes "Ehem.. Ingredients for the desserts that comes from the cafeteria are harvested here.";
					next;
					mes "[Automatic Doll]";
					mes "We've had some customers coming these days, so we've been getting increasing orders.";
					mes "So my colleague who was working on another job was assigned to this side but she's not very good at work.";
					mes "Everybody's listening well so it's easy to sign.";
					next;
					select("You're talkative.");
					mes "[Automatic Doll]";
					mes "Anyway, he told me to introduce myself if I want to talk to someone for a long time.";
					mes "My name is Luina.";
					next;
					mes "[Luina]";
					mes "Meow is a plant creature called Pitaya, but it's an improved ancient species that lived on an island somewhere.";
					mes " I don't know because I am not Pitaya, but it's gentle and obedient.";
					next;
					mes "- Luina stroked Meow. -";
					npctalk "Purr..","Meow#greeen",bc_self;
					next;
					mes "[Luina]";
					mes "Master said he would name small and cute things. Meow, Butterfly, Happy, and Baduk told me the story.";
					mes "Pitaya is small and cute so I named it.";
					next;
					mes "[Luina]";
					mes "Since Meow is the cutest,";
					mes "It's Meow.";
					next;
					mes "[Luina]";
					mes "So customer...";
					mes "are you here to cut off the tail?";
					next;
					select("Tail?:I don't have a tail.");
					mes "[Luina]";
					mes "Pita, didn't you come to pick up the tail?";
					mes "Oh... there's a mistake.";
					mes "Wait a minute. I'll write an explanation.";
					setquest 8586;
					close;
				case 1:
					mes "[Luina]";
					mes "If you look at Meow now, it looks like it doesn't have roots right?";
					mes "It absorbs moisture from the air into the surface and photosynthesizes so that there is no root.";
					mes "It also eats fertilizer… or food.";
					next;
					mes "[Luina]";
					mes "They say that if you plant seeds, they grow up and come out of the ground. But I've never seen them before.";
					next;
					mes "[Luina]";
					mes "For the tail, grab the Pitaya, stroke it like this then open it and let it go.";
					next;
					mes "-- Luina lifted Meow, pretended to bend its tail and put it down. --";
					next;
					npctalk "Pup...","Meow#greeen",bc_self;
					mes "[Luina]";
					mes "No, no. I didn't.";
					mes "The harvested tail is not always filling enough to eat.";
					mes "You have to take the loss into account.";
					next;
					mes "[Luina]";
					mes "After this process, the pitaya tail which was harvested is put on the table.";
					mes "You have to remove the seeds and skin, but it won't be difficult.";
					next;
					mes "[Luina]";
					mes "The harvest is a bit difficult, so my colleague ‘Silk' will guide you.";
					mes "You can just enter even if it's not a harvest. I'll just let you go in this way without needing a guide.";
					next;
					mes "[Luina]";
					mes "If you are just entering, in case you have time, you can tell Cotton who's in charge of taking care of the animals, and she'll tell you who you need to play with today.";
					mes "If you could spare us some of our work...";
					mes "I'll reward you for that, too.";
					npctalk "Cotton: Welcome, competent guests!","Cotton#greeen",bc_self;
					next;
					mes "[Luina]";
					mes "Now that you've heard the explanation, you can now enter.";
					mes "You can just enter if you want to take a look around.";
					next;
					mes "[Luina]";
					mes "We talked about Cotton first, but in fact, the more important thing is harvest...";
					mes "if you are confident in your combat skills.";
					mes "I'd appreciate it if you could help me with the harvest.";
					mes "You have to feed boss Meow.";
					next;
					select("Boss Meow?");
					mes "[Luina]";
					mes "It's a little different from my little friends, but it's hiding in a place where I can't usually see it.";
					mes "You have to spread the food here and there and make some noise so that it will show itself. You haven't seen it on the cafeteria menu.";
					next;
					mes "[Luina]";
					mes "Anyway, I am in charge of the harvest, so feel free to ask me!";
					erasequest 8586;
					next;
					mes "[Luina]";
					mes "Let's talk about the details once you need them.";
					ep17_2_farm = 1;
					questinfo_refresh();
					close;		
			}
		case 1:
			switch(checkquest(8587,PLAYTIME)){
				case -1:
					switch(isbegin_quest(8588)){
						case 0:
							mes "[Luina]";
							mes "Welcome, "+strcharinfo(0)+"!";
							mes "Are you going into the farm today also?";
							next;
							.@md_name$ = "Lost Farm of Time";
							.@party_id = getcharid(1);
							.@party_name$ = getpartyname(.@party_id);
							if (!instance_check_party(.@party_id,1)) {
								mes "[Luina]";
								mes "Make or join a party with more than 1 member and try again.";
								close;
							}
							if(is_party_leader() == false) {
								mes "- This instance is part of story of the quest. -";
								mes " ";
								mes "- Only leader can create and enter the instance. -";
								close;
							}
							.@s = select((!instance_id(IM_PARTY)?"Create "+.@md_name$+"":""),(!instance_id(IM_PARTY)?"":"Enter the dungeon."),"Cancel");
							switch(.@s){
								case 1:
									switch(instance_create(.@md_name$,IM_PARTY)){
										case -1:
											mes "^0000ff"+.@md_name$+" ^000000 - Reservation Failed!";
											mes "Unknown Error Has Occurred.";
											end;
										case -2:
											mes "[Luina]";
											mes "Well? It will be difficult on your own. Come back with a party, adventurer.";
											close;
										case -3:
											mes "[Luina]";
											mes "You already have an instance active. Please cancel it before proceeding.";
											close;
										case -4:
											mes "^0000ff"+.@md_name$+" ^000000 - Reservation Failed!";
											mes "^0000ff"+.@md_name$+" ^000000 is currently full.";
											end;
										default: 
											mes "[Luina]";
											mes "Then I'll prepare some food for you today. Please wait a moment";
											end;
									}
								case 2:
									switch(instance_enter(.@md_name$)){
										case 3:
											mes "An unknown error has occurred.";
											end;
										case 2:
										case 1:
											mes "^ff0000Character doesn't have an instance reserved.^000000";
											end;
										case 0:
											setquest 8587;
											setquest 8588;
											end;
									}
								case 3:
									close;
							}
						case 1:
							break;
					}
				case 0:
				case 1:
				case 2:
					mes "[Luina]";
					mes "They're asking you to play? That's weird. They have been listening to my words very well. ...... what? And silk? What happened?";
					next;
					select("Pretend to pet the meow");
					emotion ET_HUK, getnpcid(0, "Meow#greeen");
					npctalk "Purrrrr","Meow#greeen",bc_self;
					mes "-- The meow hid behind Luina before he could even reach it. --";
					next;
					mes "[Luina]";
					mes "Ooops...";
					next;
					mes "[Luina]";
					mes "Don't tell me... it is only listening to me?";
					next;
					select("It seems like that");
					mes "[Luina]";
					mes "Meow";
					npctalk "Grruuunnggggg","Meow#greeen",bc_self;
					next;
					mes "[Luina]";
					mes "...";
					mes "is this what the guests are saying \"suprised\"?";
					next;
					npctalk "Meow","Meow#greeen",bc_self;
					mes "- When Luina reached out his hand, the meow hit his head against it. -";
					next;
					mes "- Patting a satisfied-looking meow made Luina a complicated face. -";
					next;
					mes "[Luina]";
					mes "Hmm...";
					mes "Will the guests be able to be friends with meow someday?";
					next;
					mes "[Luina]";
					mes "Shouldn't we just continue to play together like this?";
					npctalk "Grruuunnggggg","Meow#greeen",bc_self;
					next;
					mes "[Luina]";
					mes "Yes! Please help me with the harvest work again tomorrow with silk. And then one day… you'll be able to make friends with them! This is... a token of promise!";
					ep17_2_farm = 2;
					erasequest 8588;
					getitem 1000103,20;
					next;
					mes "[Luina]";
					mes "Maybe...";
					next;
					mes "- The meow cried with a loud voice as if it was excited. -";
					npctalk "Ppyak Ppyakk","Meow#greeen",bc_self;
					close;
			}
		case 2:
			switch(checkquest(8587,PLAYTIME)){
				case -1:
					switch(isbegin_quest(8588)){
						case 0:
							mes "[Luina]";
							mes "Welcome, "+strcharinfo(0)+"!";
							mes "Are you going into the farm today?";
							next;
							.@md_name$ = "Lost Farm of Time";
							.@party_id = getcharid(1);
							.@party_name$ = getpartyname(.@party_id);
							if (!instance_check_party(.@party_id,1)) {
								mes "[Luina]";
								mes "Make or join a party with more than 1 member and try again.";
								close;
							}
							.@s = select((!instance_id(IM_PARTY)?"Create "+.@md_name$+"":""),(!instance_id(IM_PARTY)?"":"Enter the dungeon."),"Cancel");
							switch(.@s){
								case 1:
									if(is_party_leader() == false) {
										mes "[Luina]";
										mes "Where's your party leader "+strcharinfo(0)+"?";
										mes "I will only talk to the leader.";
										close;
									}
									switch(instance_create(.@md_name$,IM_PARTY)){
										case -1:
											mes "^0000ff"+.@md_name$+" ^000000 - Reservation Failed!";
											mes "Unknown Error Has Occurred.";
											end;
										case -2:
											mes "[Luina]";
											mes "Well? It will be difficult on your own. Come back with a party, adventurer.";
											close;
										case -3:
											mes "[Luina]";
											mes "You already have an instance active. Please cancel it before proceeding.";
											close;
										case -4:
											mes "^0000ff"+.@md_name$+" ^000000 - Reservation Failed!";
											mes "^0000ff"+.@md_name$+" ^000000 is currently full.";
											end;
										default: 
											mes "[Luina]";
											mes "Then I'll prepare some food for you today. Please wait a moment";
											end;
									}
								case 2:
									switch(instance_enter(.@md_name$)){
										case 3:
											mes "An unknown error has occurred.";
											end;
										case 2:
										case 1:
											mes "^ff0000Character doesn't have an instance reserved.^000000";
											end;
										case 0:
											setquest 8587;
											setquest 8588;
											end;
									}
								case 3:
									if(isbegin_quest(8588) == 1){
										.@y_tail = countitem(1000094);
										.@b_tail = countitem(1000095);
										.@g_tail = countitem(1000096);
										.@p_tail = countitem(1000097);
										.@boss_tail = countitem(1000098);
										mes "[Luina]";
										mes "Thank you for your helping us harvest today.";
										next;
										mes "[Luina]";
										mes "Please come back after dawn.";
										erasequest 8588;
										getitem 1000103,10;
										if(.@y_tail) delitem 1000094,.@y_tail;
										if(.@b_tail) delitem 1000095,.@b_tail;
										if(.@g_tail) delitem 1000096,.@g_tail;
										if(.@p_tail) delitem 1000097,.@p_tail;
										if(.@boss_tail) delitem 1000098,.@boss_tail;
										close;
									}
							}
						case 1:
							end;
					}
				case 0:
				case 1:
					if(isbegin_quest(8588) == 1){
						mes "[Luina]";
						mes "Thank you for your helping us harvest today.";
						next;
						mes "[Luina]";
						mes "Please come back after dawn.";
						erasequest 8588;
						getitem 1000103,10;
						close;
					}
					mes "[Luina]";
					mes "We have completed the necessary harvest for today.";
					mes "We will resume our harvest again by dawn. Come back by then.";
					close;
				case 2:
					mes "[Luina]";
					mes "^0000CDOur struggle with the Pitaya seems like a long time ago. Now, I have the courage again to go back into the farm.^000000";
					erasequest 8587;
					end;
			}
	}

OnInit:
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_main > 8 && isbegin_quest(8586) == 0 && ep17_2_farm == 0 " );
	questinfo( QTYPE_QUEST,QMARK_YELLOW, " ep17_2_main > 8 && isbegin_quest(8586) == 1 && ep17_2_farm == 0 " );
	questinfo( QTYPE_DAILYQUEST,QMARK_YELLOW, " ep17_2_farm > 1 && ( checkquest(8587,PLAYTIME) == -1 || checkquest(8587,PLAYTIME) == 2 ) " );
	end;
}

//Merchants
-	shop	ep172littlemanager00	-1,1000227:172
//-	bartershop	ep172littlemanager01	-1,10044,1000103:0:10,10043,1000103:0:5

ba_in01,87,386,3	script	Child Manager Beta#ep172_pet	20696,{
	mes "[Child Manager Beta]";
	mes "I have a whole bunch of little stuffs!";
	next;
	switch(select("Little Manager:Cloud Cotton:Little Headress:Cancel")){
		case 1:
			mes "[Child Manager Beta]";
			mes "If you want to play with the little manager, it would cost you 30 Barmeal Tickets.";
			next;
			if(select("Exchange.:Stop.") == 2){
				mes "[Child Manager Beta]";
				mes "Then, it's time for me to play!";
				close;
			}
			if(countitem(1000103) < 30){
				mes "[Child Manager Beta]";
				mes "Like I said, if you want to play with the little manager, you'll need 30 Barmeal Tickets!";
				close;
			}
			mes "[Child Manager Beta]";
			mes "Have fun with your new friend!";
			delitem 1000103,30;
			getitem 9123,1;
			end;
			
		case 2:
			callshop "ep172littlemanager00",1;
			break;
			
		case 3:
			//callshop "ep172littlemanager01"; //bartershop pending
			mes "[Child Manager Beta]";
			mes "What would you like to have?";
			next;
			switch(select(""+getitemname(10044)+":"+getitemname(10043)+"")){
				case 1:
					.@id = 10044;
					.@req = 10;
					break;
				case 2:
					.@id = 10043;
					.@req = 5;
					break;
			}
			mes "[Child Manager Beta]";
			if(countitem(1000103) < .@req){
				mes "You don't have enough "+getitemname(1000103)+"";
				close;
			}
			mes "Here's your "+getitemname(.@id)+". Time for me to play now.";
			delitem 1000103,.@req;
			getitem .@id,1;
			close;
			
		case 4:
			mes "[Child Manager Beta]";
			mes "Then, it's time for me to play!";
			close;
	}
	end;
}

/*ba_in01,87,380,3	script	Yecheon#ep172module_trader	4_EP17_CLEANER_W,{
	disable_items;
	if(ep17_2_main < 6){
		cutin "ep172_omega.bmp", 2;
		mes "[Yecheong]";
		mes "Guest registration is required to use Barmil tickets.";
		mes "We will distribute combat-specific companions.";
		mes " ";
		mes "- Prior quests exists. -";
		close3;
	}	
	cutin "ep172_omega",2;
	mes "[Yecheon]";
	mes "I can provide you an Automatic Module, Physical Automatic Improvement Device, and Magical Automatic Improvement Device. It will help you the improve abilites of your automatic equipments.";
	next;
	cutin "",255;
	switch(select("More information.:Get Automatic Module:Get Physical Automatic Improvement Device:Get Magical Automatic Improvement Device:Cancel")){
		case 1:
			cutin "ep172_omega",2;
			mes "[Yecheon]";
			mes "You can get an ^FF0000automatic module^000000 for ^0000CD90 Barmeal Tickets^000000. I will give you a random automatic module excluding the epic grade modules.";
			next;
			mes "[Yecheon]";
			mes "I'm also providing ^FF0000Physical Automatic Improvement Device and Magical Automatic Improvement Device^000000. You can exchange it for ^0000CD45 Barmeal Tickets^000000, or ^0000CD1500000 Zeny^000000.";
			next;
			mes "[Yecheon]";
			mes "Then, combat-specialized guest, do safely improve your abilities.";
			close3;
			
		case 2:
			.@price = 90;
			cutin "ep172_omega",2;
			mes "[Yecheon]";
			mes "I will exchange 1 random Automatic Module excluding the epic grade modules for 90 <ITEM>[Barmeal Ticket]<INFO>1000103</INFO></ITEM>.";
			next;
			cutin "",255;
			if(select("Exchange Barmeal Ticket.:Do not exchange") == 2){
				mes "[Yecheon]";
				mes "Transaction ended.";
				close3;
			}
			cutin "ep172_omega",2;
			if(countitem(1000103) < .@price){
				mes "[Yecheon]";
				mes "You don't have enough Barmeal tickets for the exchange.";
				close3;
			}
			mes "[Yecheon]";
			mes "I exchanged it for one random Automatic Module.";
			delitem 1000103,.@price;
			getitem .module[rand(getarraysize(.module))],1;
			close3;
			
		case 3:
			cutin "ep172_omega",2;
			mes "[Yecheon]";
			mes "I will exchange ^FF00001 Physical Automatic Improvement Device^000000 for 45 <ITEM>[Barmeal Ticket]<INFO>1000103</INFO></ITEM> or 1500000 Zeny.";
			next;
			cutin "",255;
			.@price = 45;
			.@zeny = 1500000;
			switch(select("Exchange for Barmeal Ticket.:Exchange for 1500000 Zeny.:Do not exchange.")){
				case 1:
					cutin "ep172_omega",2;
					if(countitem(1000103) < .@price){
						mes "[Yecheon]";
						mes "You don't have enough Barmeal tickets for the exchange.";
						close3;
					}
					mes "[Yecheon]";
					mes "I exchanged it for one random Physical Automatic Improvement Device.";
					delitem 1000103,.@price;
					getitem .p_rand[rand(getarraysize(.p_rand))],1;
					close3;
					
				case 2:
					cutin "ep172_omega",2;
					if(Zeny < .@zeny){
						mes "[Yecheon]";
						mes "You don't have enough Zeny for the exchange.";
						close3;
					}
					mes "[Yecheon]";
					mes "I exchanged it for one random Physical Automatic Improvement Device.";
					Zeny -= .@zeny;
					getitem .p_rand[rand(getarraysize(.p_rand))],1;
					close3;

				case 3:
					end;
			}
			
		case 4:
			cutin "ep172_omega",2;
			mes "[Yecheon]";
			mes "I will exchange ^FF00001 Magical Automatic Improvement Device^000000 for 45 <ITEM>[Barmeal Ticket]<INFO>1000103</INFO></ITEM> or 1500000 Zeny.";
			next;
			cutin "",255;
			.@price = 45;
			.@zeny = 1500000;
			switch(select("Exchange for Barmeal Ticket.:Exchange for 1500000 Zeny.:Do not exchange.")){
				case 1:
					cutin "ep172_omega",2;
					if(countitem(1000103) < .@price){
						mes "[Yecheon]";
						mes "You don't have enough Barmeal tickets for the exchange.";
						close3;
					}
					mes "[Yecheon]";
					mes "I exchanged it for one random Magical Automatic Improvement Device.";
					delitem 1000103,.@price;
					getitem .m_rand[rand(getarraysize(.m_rand))],1;
					close3;
					
				case 2:
					cutin "ep172_omega",2;
					if(Zeny < .@zeny){
						mes "[Yecheon]";
						mes "You don't have enough Zeny for the exchange.";
						close3;
					}
					mes "[Yecheon]";
					mes "I exchanged it for one random Magical Automatic Improvement Device.";
					Zeny -= .@zeny;
					getitem .m_rand[rand(getarraysize(.m_rand))],1;
					close3;

				case 3:
					end;
			}

		case 5:
			close;
	}
	
OnInit:
	setarray .physical,100164,50,100165,30,100166,20;
	setarray .magical,100167,50,100167,30,100167,20;
	for(.@i = 0; .@i < getarraysize(.physical); .@i += 2){
		for(.@x = 0; .@x < .physical[.@i+1]; .@x++){
			.p_rand[getarraysize(.p_rand)] = .physical[.@i];
			.m_rand[getarraysize(.m_rand)] = .magical[.@i];
		}
	}
	for(.@i = 1000105; .@i < 1000150; .@i++)
		.module[getarraysize(.module)] = .@i;
	end;
}*/

ba_in01,87,370,3	script	Lisa#ep172_merchant	20698,{
	disable_items;
	mes "[Lisa]";
	mes "Welcome welcome~";
	next;
	switch(select("Explore Devices:Automatic Engine Wing Enhancement:Automatic Armor Enhancement:Automatic Leg Enhancement:Automatic Accessories(R) Enhancement:Automatic Accessories(L) Enhancement")){
		case 1:
			mes "[Lisa]";
			mes "If you bring automatic equipment and reinforcement modules, we can enchant the appropriate module on the equipment.";
			next;
			mes "[Lisa]";
			mes "This is done according to the specification module, so the equipment will not be destroyed. However, the number of upgrades can vary depending on the module.";
			next;
			mes "[Lisa]";
			mes "Then please visit again when you need help~";
			end;
			
		case 2: .@part = EQI_GARMENT; setarray .@id,480020,480021; break;
		case 3: .@part = EQI_ARMOR; setarray .@id,450127,450128; break;
		case 4: .@part = EQI_SHOES; setarray .@id,470022,470023; break;
		case 5: .@part = EQI_ACC_R; setarray .@id,490024,490026; break;
		case 6: .@part = EQI_ACC_L; setarray .@id,490025,490027; break;		
	}
	.@equip_id = getequipid(.@part);
	.@equip_name$ = getequipname(.@part);
	.@refine = getequiprefinerycnt(.@part);
	for(.@i = 0; .@i < 4; .@i++)
		.@card[.@i] = getequipcardid(.@part,.@i);	
	for(.@i = 0; .@i < 4; .@i++)
		.@check[.@i] = getequipcardid(.@part,.@i);
	mes "[Lisa]";
	mes "If you bring automatic equipment and reinforcement modules, we can enchant the appropriate module on the equipment.";
	next;
	mes "[Lisa]";
	mes strcharinfo(0) + ".";
	mes "Please select the grade of module that you want to use.";
	next;
	.@s = select("Cancel:Normal Grade:Rare Grade:Unique Grade:Legendary Grade:Epic Grade 1:Epic Grade 2:Epic Grade 3");
	if(.@s == 1){
		mes "[Lisa]";
		mes "Stopping conversation.";
		end;		
	}
	.@menu$ = "Cancel:";
	.@s -= 2;
	explode(.@T$,.menu$[.@s],",");
	for(.@i = 0; .@i < getarraysize(.@T$); .@i++){
		.@item_id = atoi(.@T$[.@i]);
		if(!countitem(.@item_id))
			.@menu$ += "^808080Module Amount 0^000000" + ":";
		else {
			.@item_name$ = getitemname(.@item_id);
			.@item_name$ = replacestr(.@item_name$,"Auto Modification Module(","");
			.@item_name$ = replacestr(.@item_name$,")","");
			.@menu$ += .@item_name$ + ":";
		}
	}
	.@s = select(.@menu$);
	if(.@s == 1){
		mes "[Lisa]";
		mes "Stopping conversation.";
		end;	
	}
	.@s -= 2;
	.@module_id = atoi(.@T$[.@s]);
	if(!countitem(.@module_id)){
		mes "[Lisa]";
		mes "You must possess a module in your inventory that matches the efficacy to proceed with the enhancement.";
		end;
	}
	if(.@id[0] != .@equip_id && .@id[1] != .@equip_id){
		mes "[Lisa]";
		mes "Please make sure you have equipped the proper automatic equipment that you want to enhance.";
		close;
	}
	function enchant_check;
	.@error = enchant_check(.@part,.@module_id);
	switch(.@error){
		case 1:
			mes "[Lisa]";
			mes "You can not enchant this module to this automatic equipment.";
			end;
			
		case 2:
			mes "[Lisa]";
			mes "This automatic equipment has already maximized the enhancement from this module.";
			mes "Please try another module.";
			end;
			
		case 3:
			mes "[Lisa]";
			mes "This automatic equipment is already at its maximum capacity.";
			mes "Please try another automatic equipment.";
			end;
			
		default:
			break;
	}
	mes "[Lisa]";
	mes "Are you sure you want to enchance your ^FF0000" +.@equip_name$+"^000000 with ^0000CD" + getitemname(.@module_id) + "^000000? This process cannot be reversed.";
	next;
	if(select("Wait... Don't:I'm sure. Do it.") == 1){
		mes "[Lisa]";
		mes "Stopping conversation.";
		end;
	}
	for(.@i = 3; .@i > 0; .@i--){
		if(.@card[.@i] == 0){
			.@augment_slot = .@i;
			break;
		}
	}
	.@index = inarray(.auto_m,.@module_id);
	delitem .@module_id,1;
	.@card[.@augment_slot] = .auto_o[.@index];
	if(callfunc("F_IsEquipIDHack", .@part, .@equip_id) || callfunc("F_IsEquipRefineHack", .@part, .@refine) || callfunc("F_IsEquipCardHack", .@part, .@check[0], .@check[1], .@check[2], .@check[3]))
		end;
	delequip .@part;
	getitem2 .@equip_id,1,1,.@refine,0,.@card[0],.@card[1],.@card[2],.@card[3];
	mes "[Lisa]";
	mes "Woaaaah~ I can feel the power of your automatic equipment already~!";
	end;
	
	
OnInit:
	for(.@i = 310082; .@i < 310180; .@i++)
		.auto_o[getarraysize(.auto_o)] = .@i;
	for(.@i = 1000105; .@i < 1000203; .@i++){
		if(.@i == 1000150 || .@i == 1000151)
			continue;
		.auto_m[getarraysize(.auto_m)] = .@i;
	}
	.auto_m[getarraysize(.auto_m)] = 1000207;
	.auto_m[getarraysize(.auto_m)] = 1000208;
	setarray .armor_enchant,1000105,3,1000106,3,1000122,2,1000123,2,1000124,2,1000128,1,1000129,1,1000130,1,1000131,1,1000132,1,1000133,1,1000207,1,1000140,1;
	setarray .wing_enchant,1000105,3,1000106,3,1000125,2,1000126,2,1000127,2,1000135,1,1000142,1,1000208,1;
	setarray .leg_enchant,1000105,3,1000106,3,1000119,2,1000120,2,1000121,2,1000134,1,1000141,1,1000144,1,1000145,1,1000146,1,1000147,1,1000148,1,1000149,1;
	setarray .legendary_enchant,1000144,1000145,1000146,1000147,1000148,1000149;
	setarray .acce_enchant,1000107,3,1000108,3,1000109,3,1000110,3,1000111,3,1000112,3,1000113,2,1000114,2,1000115,1,1000116,1,1000117,1,1000118,1,1000136,1,1000137,1,1000138,1,1000139,1,1000143,1;
	for(.@i = 1000152; .@i < 1000203; .@i++){
		.armor_enchant[getarraysize(.armor_enchant)] = .@i;
		.armor_enchant[getarraysize(.armor_enchant)] = 2;
		.epic_enchant[getarraysize(.epic_enchant)] = .@i;
	}
	setarray .menu$,"1000105,1000106,1000107,1000108,1000109,1000110,1000111,1000112","1000113,1000114,1000115,1000116,1000117,1000118,1000119,1000120,1000121,1000122,1000123,1000124,1000125,1000126,1000127",
	"1000128,1000129,1000130,1000131,1000132,1000133,1000134,1000135,1000136,1000137,1000138,1000139,1000140,1000141,1000142,1000143,1000207,1000208","1000144,1000145,1000146,1000147,1000148,1000149",
	"1000152,1000153,1000154,1000155,1000156,1000157,1000158,1000159,1000160,1000161,1000162,1000163,1000164,1000165,1000166,1000167,1000168",
	"1000169,1000170,1000171,1000172,1000173,1000174,1000175,1000176,1000177,1000178,1000179,1000180,1000181,1000182,1000183,1000184,1000185",
	"1000186,1000187,1000188,1000189,1000190,1000191,1000192,1000193,1000194,1000195,1000196,1000197,1000198,1000199,1000200,1000201,1000202";
end;

function	enchant_check	{
	.@part = getarg(0);
	.@module_id = getarg(1);
	for(.@i = 0; .@i < 4; .@i++)
		.@card[.@i] = getequipcardid(.@part,.@i);
	if(.@card[1] > 0)
		return 3;
	switch(.@part){
		case EQI_GARMENT:
			.@array$ = "wing_enchant";
			break;
			
		case EQI_ARMOR:
			.@array$ = "armor_enchant";
			break;
			
		case EQI_SHOES:
			.@array$ = "leg_enchant";
			break;
			
		case EQI_ACC_L:
		case EQI_ACC_R:
			.@array$ = "acce_enchant";
			break;			
	}
	.@arr_id = inarray(getd("." + .@array$),.@module_id);
	if(.@arr_id == -1)
		return 1;
	//Debug purposes
	//dispbottom "Module ID : " + .@module_id;
	.@index = inarray(.auto_m,.@module_id);
	if(.@index == -1){
		mes "Unknown error has occured.";
		end;
	}
	for(.@i = 0; .@i < 4; .@i++){
		if(.@card[.@i] == .auto_o[.@index])
			.@count++;
	}
	.@c_index = .@arr_id + 1;
	.@total = getd("." + .@array$ + "["+.@c_index+"]");
	if(.@count >= .@total)
		return 2;
	if(.@part == EQI_SHOES){
		.@legendary = inarray(.legendary_enchant,.@module_id);
		if(.@legendary >= 0){
			for(.@x = 0; .@x < getarraysize(.legendary_enchant); .@x++){
				.@l_index = inarray(.auto_m,.legendary_enchant[.@x]);
				for(.@i = 0; .@i < 4; .@i++){
					if(.@card[.@i] == .auto_o[.@l_index])
						.@legend++;
				}
				if(.@legend)
					return 2;
			}
		}
	}
	if(.@part == EQI_ARMOR){
		.@epic = inarray(.epic_enchant,.@module_id);
		if(.@epic >= 0){
			for(.@x = 0; .@x < getarraysize(.epic_enchant); .@x++){
				.@e_index = inarray(.auto_m,.epic_enchant[.@x]);
				for(.@i = 0; .@i < 4; .@i++){
					if(.@card[.@i] == .auto_o[.@e_index])
						.@epic_g++;
				}
				if(.@epic_g == 2)
					return 2;
			}
		}
	}
	return 0;
}

}

-	shop	ep172cubeshop00	-1,no,100251:10000000,100252:30000000
ba_in01,87,376,3	script	Cube Lane#ep172cube	4_EP17_GUARD_B,{
	disable_items;
	mes "[Cube Lane]";
	mes "We are offering reinforcement cubes that will refine your ^0000CD+4^000000 Illusion and Automatic Equipment to ^FF0000+7^000000 in an instant!";
	mes "Varmundt is no doubt the best man in the world!";
	close2;
	callshop "ep172cubeshop00";
	end;
}

-	shop	172epicmodule	-1,no,501:-1
ba_in01,87,373,3	script	Spiera#ep172_soapstone	20698,{
	disable_items;
	callshop "172epicmodule",1;
	npcshopattach "172epicmodule";
	end;
	
OnBuyItem:
	.@total_cost = 0;
	for(.@i = 0; .@i < getarraysize(@bought_nameid); .@i++)
		for(.@j = 0; .@j < getarraysize(.item); .@j++)
			if(.item[.@j] == @bought_nameid[.@i])
				.@total_cost += (.price[.@j] * @bought_quantity[.@i]);
			if(countitem(.currency) >= .@total_cost){
				delitem .currency,.@total_cost;
				for(.@i = 0; .@i < getarraysize(@bought_nameid); .@i++)
					getitem @bought_nameid[.@i],@bought_quantity[.@i];
			} else {
				dispbottom "Your don't have enough " + getitemname(.currency);
				end;
			}
	deletearray @bought_quantity, getarraysize(@bought_quantity);
	deletearray @bought_nameid, getarraysize(@bought_nameid);
	end;

OnInit:
	for(.@i = 1000152; .@i < 1000203; .@i++)
		.shop_item[getarraysize(.shop_item)] = .@i;
	for(.@i = 0; .@i < getarraysize(.shop_item); .@i++){
		.item[.@i] = .shop_item[.@i];
		.price[.@i] = 300;
	}
	.currency = 1000104;
	npcshopdelitem "172epicmodule",501;
	for(.@i = 0; .@i < getarraysize(.item); .@i++)
	npcshopadditem "172epicmodule",.item[.@i],.price[.@i];
	end;
}

ba_in01,87,383,3	script	Yeoncheong#jh172	4_EP17_CLEANER_W,{
	cutin "ep172_omega.bmp", 2;
	mes "[Yeoncheong]";
	mes "You can use Barmeal Ticket in exchange for automatic armor.";
	mes "Combat-specialized guest, what would you like to exchange?";
	next;
	cutin "ep172_omega.bmp", 255;
	switch(select("Exchange Guide:Automatic Armor Exchange:Automatic Accessory Exchange:Cancel")){
		case 1:
			cutin "ep172_omega.bmp", 2;
			mes "[Yeoncheong]";
			mes "For ^FF0000Automatic Armor's^000000, I can exchange with +9 of the corresponding ^0000FFIllusion Armor^000000 and ^0000FF900 Barmeal Ticket^000000";
			next;
			mes "[Yeoncheong]";
			mes "For ^FF0000Automatic Accessory's^000000, I can exchange with the corresponding ^0000FFIllusion Accessory^000000 and ^0000FF1500 Barmeal Ticket^000000";
			next;
			mes "[Yeoncheong]";
			mes "Then, combat-specialized guest, I hope everything is clear.";
			close3;
		case 2:
			cutin "ep172_omega.bmp", 2;
			mes "[Yeoncheong]";
			mes "What would you like to have?";
			next;
			for(.@i = 0; .@i < getarraysize(.automatic_armor$); .@i += 3){
				.@menu$ += getitemname(atoi(.automatic_armor$[.@i])) + ":";
			}
			.@s = (select(.@menu$) - 1) * 3;
			.@item_id = atoi(.automatic_armor$[.@s]);
			mes "[Yeoncheong]";
			mes "For ^FF0000"+getitemname(.@item_id)+"^000000, do you have all the requirements?";
			mes "~ ^0000FF+9 " + getitemname(atoi(.automatic_armor$[.@s+1])) +"^000000";
			getinventorylist(getcharid(0));
			for(.@i = 0; .@i < @inventorylist_count; .@i++){
				if(@inventorylist_id[.@i] !=  atoi(.automatic_armor$[.@s+1])){ 
					continue;
				}
				if(@inventorylist_refine[.@i] >= 9){
					.@index = .@i;
					.@armor_check = 1;
					break;
				} else {
					continue;
				}	
			}
			explode(.@data$,.automatic_armor$[.@s+2],",");
			for(.@i = 0; .@i < getarraysize(.@data$); .@i += 2){
				if(countitem(atoi(.@data$[.@i])) < atoi(.@data$[.@i+1])) .@missing += 1;
				mes "~ ^0000FF"+.@data$[.@i+1]+ " " +getitemname(atoi(.@data$[.@i]))+"^000000";
			}
			next;
			if(select("Yes, I have it all.:I'll bring those materials") == 2){
				mes "[Yeoncheong]";
				mes "Comeback when you're ready.";
				close3;
			}
			if(.@armor_check < 1 || .@missing > 0){
				mes "[Yeoncheong]";
				mes "You don't have all the materials.";
				close3;
			}
			delitem2 @inventorylist_id[.@index],1,@inventorylist_identify[.@index],@inventorylist_refine[.@index],@inventorylist_attribute[.@index],@inventorylist_card1[.@index],@inventorylist_card2[.@index],@inventorylist_card3[.@index],@inventorylist_card4[.@index]; 
			for(.@i = 0; .@i < getarraysize(.@data$); .@i += 2){
				delitem atoi(.@data$[.@i]),atoi(.@data$[.@i+1]);
			}
			mes "[Yeoncheong]";
			mes "Here is your upgraded equipment.";
			getitem atoi(.automatic_armor$[.@s]),1;
			close3;
		case 3:
			cutin "ep172_omega.bmp", 2;
			mes "[Yeoncheong]";
			mes "What would you like to have?";
			next;
			for(.@i = 0; .@i < getarraysize(.automatic_acce$); .@i += 3){
				.@menu$ += getitemname(atoi(.automatic_acce$[.@i])) + ":";
			}
			.@s = (select(.@menu$) - 1) * 3;
			.@item_id = atoi(.automatic_acce$[.@s]);
			mes "[Yeoncheong]";
			mes "For ^FF0000"+getitemname(.@item_id)+"^000000, do you have all the requirements?";
			mes "~ ^0000FF" + getitemname(atoi(.automatic_acce$[.@s+1])) +"^000000";
			getinventorylist(getcharid(0));
			for(.@i = 0; .@i < @inventorylist_count; .@i++){
				if(@inventorylist_id[.@i] !=  atoi(.automatic_acce$[.@s+1])){ 
					continue;
				}
				.@index = .@i;
				.@acce_check = 1;
				break;
			}
			explode(.@data$,.automatic_acce$[.@s+2],",");
			for(.@i = 0; .@i < getarraysize(.@data$); .@i += 2){
				if(countitem(atoi(.@data$[.@i])) < atoi(.@data$[.@i+1])) .@missing += 1;
				mes "~ ^0000FF"+.@data$[.@i+1]+ " " +getitemname(atoi(.@data$[.@i]))+"^000000";
			}
			next;
			if(select("Yes, I have it all.:I'll bring those materials") == 2){
				mes "[Yeoncheong]";
				mes "Comeback when you're ready.";
				close3;
			}
			if(.@acce_check < 1 || .@missing > 0){
				mes "[Yeoncheong]";
				mes "You don't have all the materials.";
				close3;
			}
			delitem2 @inventorylist_id[.@index],1,@inventorylist_identify[.@index],@inventorylist_refine[.@index],@inventorylist_attribute[.@index],@inventorylist_card1[.@index],@inventorylist_card2[.@index],@inventorylist_card3[.@index],@inventorylist_card4[.@index]; 
			for(.@i = 0; .@i < getarraysize(.@data$); .@i += 2){
				delitem atoi(.@data$[.@i]),atoi(.@data$[.@i+1]);
			}
			mes "[Yeoncheong]";
			mes "Here is your upgraded equipment.";
			getitem atoi(.automatic_acce$[.@s]),1;
			close3;
		case 4:
			close;
	}
	
OnInit:
	setarray .automatic_armor$,
		450127,15376,"1000103,900",
		450128,15377,"1000103,900",
		470022,22196,"1000103,900",
		470023,22197,"1000103,900",
		480020,20933,"1000103,900",
		480021,20934,"1000103,900";
	setarray .automatic_acce$,
		490024,32207,"1000103,1500",
		490025,32208,"1000103,1500",
		490026,32209,"1000103,1500",
		490027,32210,"1000103,1500";
	end;
}

//Restaurant Static NPC
ba_in01,28,389,4	script	Mary#rba_in01	4_EP17_BASIC_B,{
	if(ep17_2_main < 9){
		mes "[Mary]";
		mes "Are you new here?";
		mes "Please proceed to Alpha first for your registration.";
		next;
		mes "[Mary]";
		mes "Only authorized guest are allowed to use our facilities.";
		close;
	}
	mes "[Mary]";
	mes "Hello there,";
	mes "You can use the tables here.";
	mes "Get your food on the other room~";
	mes "Enjoy!";
	close;
}

ba_in01,79,394,4	script	Tony#rba_in01	4_EP17_GUARD_B,{
	if(ep17_2_main < 9){
		mes "[Tony]";
		mes "Are you new here?";
		mes "Please proceed to Alpha first for your registration.";
		next;
		mes "[Tony]";
		mes "Only authorized guest are allowed to use our facilities.";
		close;
	}
	if(countitem(1000103) < 1){
		mes "[Tony]";
		mes "I can only assist guest who have "+getitemname(1000103)+".";
		close;
	}
	mes "[Tony]";
	mes "Enjoy your food~";
	close;
}